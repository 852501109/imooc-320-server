(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-33a35963","chunk-7469290b","chunk-a80e03d8"],{"0458":function(e,t,a){"use strict";a("0bb3")},"0bb3":function(e,t,a){var r=a("f1dd");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("dc3b20d8",r,!0,{sourceMap:!1,shadowMode:!1})},"4bbe":function(e,t,a){"use strict";a.r(t),a("6762"),a("2fdb"),a("a481"),a("8e6e"),a("ac6a"),a("456d"),a("c5f6"),a("7514");var r=a("ade3"),n=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var o={props:{show:{type:Boolean,default:!1},currentSelectDatabase:{type:Object,default:function(){}},currentLayerValue:{type:String,default:""}},data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],datas:[],templateSelection:"",tableData:[],selectedRow:null,multipleSelection:[],defaultProps:{label:"name",children:"children"},treeExpandData:[],searchText:"",param:{code:"",type:"",tagId:null,tableNameOrComment:"",page:1,rows:10,total:0}}},components:{},computed:{},mounted:function(){this.init(),this.$nextTick((function(){document.querySelector(".pane-comp")&&(document.querySelector(".pane-comp").style.width="177px")}))},methods:i(i(i({},Object(n.b)("fusionTask",["GET_TREE"])),Object(n.b)(["_AJAX"])),{},{init:function(){var e=this;this.$nextTick((function(){var t=document.querySelector(".custom-container");t&&(t.style.height=t.clientHeight+"px",e.getTree().then((function(){e.selectCurrent()})))}))},selectCurrent:function(){this.param.page=1,this.param.rows=10,this.param.code=this.currentSelectDatabase.code,this.param.type=this.currentSelectDatabase.type,this.param.tagId=null,this.param.tableNameOrComment="",this.getTable()},getTree:function(){var e=this;return new Promise((function(t,a){e.param.tableNameOrComment="",e.GET_TREE().then((function(a){e.datas=a||[],e.treeExpandData.push("1"),t(a)})).catch((function(e){a(e)}))}))},onSearch:function(){this.getTable()},getTable:function(){var e=this,t={code:this.param.code,type:this.param.type+"",page:this.param.page,rows:this.param.rows,tableNameOrComment:this.param.tableNameOrComment};this.param.tagId&&(t.tagId=this.param.tagId),this._AJAX({url:"task.stepHeader.getTableByDBTag",method:"get",data:t}).then((function(t){e.tableData=t.rows,e.param.total=t.total}))},flattenArray:function(e){for(var t=[],a=0;a<e.length;a++)Array.isArray(e[a])?t=t.concat(this.flattenArray(e[a])):t.push(e[a]);return t},onSubmit:function(){var e=this,t=Array.isArray(this.templateSelection)?this.templateSelection:[this.tableData.find((function(t){return t.id===e.templateSelection}))];if((t=t.filter((function(e){return void 0!==e}))).some((function(e){return 0===e.tableIscreate}))&&this.storey.includes(this.currentSelectDatabase.code))return this.$AudaqueToast.warn({template:"选中的含有未创建表，请前往：模型分层-".concat(this.currentSelectDatabase.label,"中创建"),methods:{okEvent:function(){}}}),!1;this.$emit("submit",t)},isSelectable:function(e){return!0},handleClose:function(){this.$emit("close")},handleRowClick:function(e){this.selectedRow===e?this.selectedRow=null:this.selectedRow=e},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.getTable()},handleCurrentChange:function(e){this.param.page=e,this.getTable()},handleCheckboxChange:function(e){e.checked||(this.selectedRow=null)},rowChange:function(e){this.templateSelection=e.id},handleSelectionChange:function(e){this.templateSelection=e},handleNodeClick:function(e){this.param.code=this.currentSelectDatabase.code,this.param.type=this.currentSelectDatabase.type,this.param.tagId=Number(e.id),this.param.page=1,this.param.rows=10,this.getTable()}})},s=(a("b363"),a("2877")),c=Object(s.a)(o,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"库表选择",visible:e.show,width:"80%","before-close":e.handleClose,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[t("div",{staticClass:"custom-container",staticStyle:{"min-height":"60vh"}},[t("audaque-resize-split-page",[t("template",{slot:"leftPane"},[t("div",{staticStyle:{"padding-left":"24px","white-space":"nowrap",overflow:"hidden"}},[e._v("\n                    当前库："),t("span",{staticStyle:{cursor:"pointer",color:"#409eff"},on:{click:e.selectCurrent}},[e._v(e._s(e.currentSelectDatabase.label)+"--")])]),t("el-tree",{staticClass:"tree-dashed",attrs:{data:e.datas,props:e.defaultProps,"default-expanded-keys":e.treeExpandData,"node-key":"id"},on:{"node-click":e.handleNodeClick}})],1),t("template",{slot:"rightPane"},[t("div",{staticClass:"row",staticStyle:{"margin-bottom":"10px"}},[t("div",{staticStyle:{width:"50%"}},[t("el-input",{attrs:{placeholder:"通过表名，表中文名模糊查询"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.param.tableNameOrComment,callback:function(t){e.$set(e.param,"tableNameOrComment",t)},expression:"param.tableNameOrComment"}})],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("筛选")])],1)]),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"highlight-current-row":""},on:{"row-click":e.rowChange,"selection-change":e.handleSelectionChange}},["au_dwd"===e.currentLayerValue||"au_dws"===e.currentLayerValue?t("el-table-column",{attrs:{type:"selection",width:"55"}}):t("el-table-column",{attrs:{align:"center",width:"55",label:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-radio",{staticClass:"radio",attrs:{label:a.row.id},model:{value:e.templateSelection,callback:function(t){e.templateSelection=t},expression:"templateSelection"}},[e._v(" ")])]}}])}),t("el-table-column",{attrs:{width:"80",prop:"schemaName",label:"数据库名"}}),t("el-table-column",{attrs:{prop:"tableName",label:"表名"}}),t("el-table-column",{attrs:{prop:"tableComment",label:"表中文描述"}}),t("el-table-column",{attrs:{width:"80",prop:"dataNum",label:"数据量"}}),t("el-table-column",{attrs:{width:"100",prop:"tagFullName",label:"元数据标签"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.tagFullName?t("span",{domProps:{innerHTML:e._s(a.row.tagFullName.replace(/;/g,"<br>").replace(/,/g,"→").replace(/;$/,""))}}):e._e()]}}])}),e.storey.includes(e.currentSelectDatabase.code)?t("el-table-column",{attrs:{prop:"tableIscreate",label:"表是否已创建",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(1===t.row.tableIscreate?"已创建":"未创建")+"\n                        ")]}}],null,!1,1411126668)}):e._e()],1),t("adq-pagination",{attrs:{"current-page":e.param.page,total:e.param.total,"page-size":e.param.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)],1),t("div",{staticClass:"dialog-footer row",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{on:{click:e.handleClose}},[e._v("取消")])],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确认")])],1)])])}),[],!1,null,"00bffde8",null);t.default=c.exports},5917:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".get-edit-item[data-v-74b78e97]{padding-top:20px;margin:0 50px}.get-edit-item li[data-v-74b78e97]{margin-top:20px;display:-webkit-box;display:-ms-flexbox;display:flex}.get-edit-item li .get-edit-type[data-v-74b78e97]{height:40px;line-height:40px}.get-edit-item li .get-edit-title[data-v-74b78e97]{width:80px;color:#3a405b;height:40px;line-height:40px}.get-edit-item li .el-tree[data-v-74b78e97]{width:100%;border:1px solid #dcdfe6;padding:24px}.search[data-v-74b78e97]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.search>div[data-v-74b78e97]:first-child{width:200px}.search>div[data-v-74b78e97]:nth-child(2){width:300px;margin-left:8px;margin-right:5px}.rule-type[data-v-74b78e97]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.rule-type span[data-v-74b78e97]{display:inline-block}[data-v-74b78e97] .el-form{width:93%}[data-v-74b78e97] .el-table__body-wrapper,[data-v-74b78e97] .el-table__header-wrapper{border-left:1px solid #eee;border-right:1px solid #eee}[data-v-74b78e97] .el-table__header-wrapper{border-top:1px solid #eee}",""])},6759:function(e,t,a){"use strict";a.r(t),a("7514"),a("7f7f"),a("8e6e"),a("456d"),a("ac6a"),a("6762"),a("2fdb");var r=a("ade3"),n=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var o={name:"RuleList",data:function(){return{selectedData:[],ruleNameDim:"",endList:[],isSelect:!1,ruleTypeOptionsGroup:[{name:"规则类型",children:[]}],defaultProps:{children:"children",label:"name"},isSearch:!1,getHeight:!1,total:1,param:{includeRole:!0,page:1,rows:10,id:"",ruleName:"",ruleType:"1",ruleCategory:"",expression:"",ruleDesc:"",dataState:"",createUser:"",createRange:"",updateUser:"",updateRange:""},search_dataRange:""}},props:["chooseRules","cancel","selectedValue"],computed:i({},Object(n.d)("generateRule",["generateRuleList","ruleTypeOptions","ruleCategoryOptions"])),methods:i(i({},Object(n.b)("generateRule",["GENERATERULELIST","DELETEGENERATERULE","GETRULETYPEOPTIONS_LIST","GETRULECATEGORYLIST"])),{},{updateSameList:function(){var e=this;this.generateRuleList.rows.filter((function(t){return e.endList.map((function(e){return e.id})).includes(t.id)})).forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t)}))},initData:function(){var e=this,t=JSON.parse(JSON.stringify(this.param));t.createRange&&t.createRange[0]&&(t.createStartTime=t.createRange[0]),t.createRange&&t.createRange[1]&&(t.createEndTime=t.createRange[1]),delete t.createRange,t.updateRange&&t.updateRange[0]&&(t.updateStartTime=t.updateRange[0]),t.updateRange&&t.updateRange[1]&&(t.updateEndTime=t.updateRange[1]),delete t.updateRange,this.isSelect=!0,this.GENERATERULELIST(t).then((function(){e.updateSameList(),e.isSelect=!1}))},handleNodeClick:function(e){this.param.ruleType=e.code,this.QUERYLIST_PARAMS(0)},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.initData()},handleCurrentChange:function(e){this.param.page=e,this.initData()},QUERYLIST_PARAMS:function(e){var t=this;this.param.page=1,e>0&&this.publics.resetFun(this.param,(function(){t.param.rows=10,t.search_dataRange=null})),this.initData()},delRow:function(e){var t=this;this.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){t.$store.commit("SHOW_LOADING",!0),t.DELETEGENERATERULE({id:e}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){t.initData()}}})}))}}})},goEdit:function(e){this.$router.push("/generateRule/generateRuleEdit?optType=edit&id=".concat(e,"&ruleType=").concat(this.param.ruleType))},rowChange:function(e){this.$refs.multipleTable.toggleRowSelection(e)},handleSelectionChange:function(e){var t=this;if(!this.isSelect){var a=this.generateRuleList.rows.filter((function(e){return t.endList.map((function(e){return e.id})).includes(e.id)})).filter((function(t){return!e.map((function(e){return e.id})).includes(t.id)}));this.endList=this.endList.filter((function(e){return!a.map((function(e){return e.id})).includes(e.id)})),e.forEach((function(e){t.endList.map((function(e){return e.id})).includes(e.id)||t.endList.push(e)}))}},subButton:function(){var e=this;this.endList=this.endList.map((function(t){return{id:t.id,ruleName:t.ruleName,ruleType:t.ruleType,ruleTypeName:e.ruleTypeOptionsGroup[0].children.find((function(e){return e.code==t.ruleType}))?e.ruleTypeOptionsGroup[0].children.find((function(e){return e.code==t.ruleType})).name:t.ruleType}})),this.chooseRules(this.endList)},dimSearch:function(){var e=this,t=JSON.parse(JSON.stringify(this.param));t.ruleName=this.ruleNameDim,delete t.createRange,delete t.updateRange,this.isSelect=!0,this.GENERATERULELIST(t).then((function(){e.updateSameList(),e.isSelect=!1}))},cancelBtn:function(){this.cancel()}}),created:function(){var e=this;this.GETRULETYPEOPTIONS_LIST().then((function(t){e.ruleTypeOptionsGroup[0].children=t})),this.GETRULECATEGORYLIST(),this.initData(),this.endList=this.selectedValue||[]}},s=(a("0458"),a("2877")),c=Object(s.a)(o,(function(){var e=this,t=e._self._c;return t("audaque-resize-split-page",[t("template",{slot:"title"},[t("audaque-table-title",{attrs:{title:""}},[t("el-input",{attrs:{placeholder:"通过规则名模糊查询",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dimSearch.apply(null,arguments)}},model:{value:e.ruleNameDim,callback:function(t){e.ruleNameDim=t},expression:"ruleNameDim"}}),t("em",{staticClass:"iconfont iconshaixuan audaque-rect-icon",on:{click:e.dimSearch}})],1)],1),t("template",{slot:"leftPane"},[e.ruleTypeOptionsGroup[0].children.length>0?t("el-tree",{attrs:{data:e.ruleTypeOptionsGroup,"current-node-key":e.param.ruleType,"node-key":"code","default-expand-all":!0,props:e.defaultProps},on:{"node-click":e.handleNodeClick}}):e._e()],1),t("template",{slot:"rightPane"},[t("el-table",{ref:"multipleTable",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.generateRuleList.rows,selection:e.selectedData,border:""},on:{"row-click":e.rowChange,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},align:"center",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleName",label:"规则名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleType",label:"规则类型"},scopedSlots:e._u([{key:"default",fn:function(t){return e.ruleTypeOptionsGroup[0].children.length>0?[e._v("\n                    "+e._s(e.ruleTypeOptionsGroup[0].children.find((function(e){return e.code==t.row.ruleType})).name)+"\n                ")]:void 0}}],null,!0)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"expression",label:"规则表达式"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleDesc",label:"规则描述"}}),t("template",{slot:"empty"},[t("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.LOGLIST(e.param)}}})],1)],2),t("adq-pagination",{attrs:{"current-page":e.param.page,total:e.generateRuleList.total,"page-size":e.param.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-top":"20px"}},[t("el-button",{on:{click:e.cancelBtn}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.subButton}},[e._v("确认")])],1)],1)],2)}),[],!1,null,"60aa0f46",null);t.default=c.exports},"9b15":function(e,t,a){"use strict";a.r(t),a("7f7f"),a("8e6e"),a("456d"),a("8615");var r=a("2909"),n=(a("7514"),a("ac6a"),a("ade3")),l=a("2f62"),i=a("4bbe");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var c={components:{ruleList:a("6759").default,tableSelectionPage:i.default},data:function(){return{databaseList:[{label:"",options:[]},{label:"数仓",options:[]}],value:"",showTableSelectionPage:!1,currentSelectDatabase:"",tableShow:!1,selectedValue:[],showRuleDialog:!1,rowId:this.$route.query.id,currentLayerValue:"",filter:"view"!=this.$route.query.filter,param:{id:"",taskCode:"",taskName:"",taskResult:"",taskCreateTime:"",taskLatestStartTime:"",taskCat:"",taskType:"2",cron:"",status:0,excuteType:"",remark:"",createUser:"",createTime:"",updateUser:"",updateTime:"",sourceDatabase:"",sourceTableName:"",tableId:null,gridData:[]},selectedRuleData:[],cronPopover:!1,cron:"",currentTargetColumnId:null,currentIndex:null,rules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],taskType:[{required:!0,message:"请选择任务类型",trigger:"select"}],cron:[{required:!0,message:"请输入cron表达式",trigger:"change"}],status:[{required:!0,message:"请输入任务状态",trigger:"blur"}],remark:[{required:!1,message:"请输入任务描述",trigger:"blur"}]}}},computed:s(s({},Object(l.d)("fusionTask",["databaseConf"])),Object(l.d)("qualityAuditTask",["taskTypeOptions","excuteTypeOptions"])),methods:s(s(s(s(s({},Object(l.b)("qualityAuditTask",["GETTASKTYPEOPTIONS_LIST"])),Object(l.b)("fusionTask",["GET_DATA_BASE_LIST"])),Object(l.b)("qualityAuditTask",["GOEDITQUALITYAUDITTASK","MODIFYQUALITYAUDITTASK","ADDQUALITYAUDITTASK"])),Object(l.b)("metadataTableInfo",["METADATATABLEINFOCOLUMNDETAIL"])),{},{changeCron:function(e){"3"==this.param.taskType?(this.$message.warning("手动执行不需要cron的表达式"),this.param.cron=""):this.param.cron=e},focusCron:function(){this.$nextTick((function(){document.getElementById("tab-1").click()}))},addRule:function(e,t){this.selectedValue=[],this.currentTargetColumnId=e.id,this.currentIndex=t,this.showRuleDialog=!0},modifyRule:function(e,t){this.currentTargetColumnId=e.id,this.currentIndex=t,this.selectedValue=e.selectedRuleData.map((function(e){return{id:e.ruleNameList[0].id,ruleName:e.ruleNameList[0].ruleName,ruleType:e.ruleNameList[0].ruleType}})),this.showRuleDialog=!0},deleteRule:function(e,t){this.param.gridData[t].selectedRuleData="",this.param.gridData[t].ruleIds=""},cancel:function(){this.showRuleDialog=!1},chooseRules:function(e){var t=this;t.showRuleDialog=!1;var a=[];e.forEach((function(e){var t={ruleTypeName:e.ruleTypeName,ruleNameList:[{id:e.id,ruleName:e.ruleName,ruleType:e.ruleType}]};a.push(t)})),t.selectedRuleData=a,t.param.gridData[t.currentIndex].selectedRuleData=[].concat(a);var r,n=[];e.map((function(e){n.push(e.id)})),r=n.join(",");var l=t.param.gridData.find((function(e){return e.id===t.currentTargetColumnId}));l&&(l.ruleIds=r)},initMap:function(e){var t=this;this.param.gridData=[],e.length>0&&(this.param.sourceTableName=e[0].tableName,this.param.tableId=e[0].id,this.METADATATABLEINFOCOLUMNDETAIL({tableId:e[0].id}).then((function(e){e&&e.length>0&&e.forEach((function(e){0==e.additionColumn&&(e.selectedRuleData=[],t.param.gridData.push(e))})),t.tableShow=!0}))),this.showTableSelectionPage=!1},sourceChange:function(){this.param.sourceTableName="",this.param.gridData=[]},selectTable:function(){var e=[].concat(Object(r.a)(this.databaseList[0].options),Object(r.a)(this.databaseList[1].options)),t=this.param.sourceDatabase;this.currentSelectDatabase=e.find((function(e){return e.code===t})),this.showTableSelectionPage=!0},getIsCont:function(){"3"==this.param.taskType&&(this.param.cron="")},subBtn:function(){var e=this,t=this,a=[];return this.param.gridData.length>0?(this.param.gridData.forEach((function(e){null!=e.selectedRuleData&&e.selectedRuleData.length>0&&e.selectedRuleData.forEach((function(e){a.push(e)}))})),a.length<1?this.$message({message:"规则为空，不允许提交任务！",type:"warning"}):void this.$refs.qualityAuditTaskForm.validate((function(a){if(!a)return!1;if(e.$store.commit("SHOW_LOADING",!0),e.rowId){var r=e.param;r.id=e.rowId,e.MODIFYQUALITYAUDITTASK(r).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){t.$router.go(-1)}}})}))}else{var n=e.param;e.ADDQUALITYAUDITTASK(n).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"添加成功",methods:{okEvent:function(){t.$router.go(-1)}}})}))}}))):this.$message({message:"规则为空，不允许提交任务！",type:"warning"})}}),mounted:function(){},created:function(){var e=this;this.rowId&&(this.GETTASKTYPEOPTIONS_LIST(),this.GOEDITQUALITYAUDITTASK({id:this.rowId}).then((function(t){e.param.id=t.id,e.param.taskCode=t.taskCode,e.param.taskName=t.taskName,e.param.taskResult=t.taskResult,e.param.taskCreateTime=t.taskCreateTime,e.param.taskLatestStartTime=t.taskLatestStartTime,e.param.taskCat=t.taskCat,e.param.taskType=t.taskType+"",e.param.cron=t.cron,e.param.status=t.status,e.param.excuteType=t.excuteType,e.param.remark=t.remark,e.param.createUser=t.createUser,e.param.createTime=t.createTime,e.param.updateUser=t.updateUser,e.param.updateTime=t.updateTime,e.param.tableId=t.tableId,e.param.sourceDatabase=t.sourceDatabase,e.param.sourceTableName=t.sourceTableName;var a=t.resultMap.echoVo,r=t.resultMap.tableIdColumnMap;e.targetColumnOptions=Object.values(r)[1],e.param.asyncConfig=a.syncType,e.param.growField=a.increaseField;var n=a.stepDetailList[0].rowList;e.param.gridData=n.map((function(e){return{id:e.sourceColumnId,columnId:e.sourceColumnId,columnName:e.sourceColumnName,columnComment:e.targetColumnName,ruleIds:e.ruleIds,selectedRuleData:e.ruleData}})),e.tableShow=!0,setTimeout((function(){e.$refs.tableData.doLayout()}),500)}))),this.databaseList[1].options=[],this.GET_DATA_BASE_LIST().then((function(){e.databaseConf.modelDBList.forEach((function(t,a){e.databaseList[1].options.push({label:t.name,value:a+1,type:t.type,code:t.code})}))}))}},u=(a("c885"),a("2877")),p=Object(u.a)(c,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{attrs:{title:e.filter?e.rowId?"修改质量稽核报告任务":"新建质量稽核报告任务":"质量稽核报告任务查看","opt-type":e.$route.query.filter},on:{"submit-click":e.subBtn}},[[t("el-form",{ref:"qualityAuditTaskForm",attrs:{model:e.param,"label-width":"120px",rules:e.rules,disabled:!e.filter}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"任务名称",prop:"taskName",rules:e.rules.taskName}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入任务名称",maxlength:"200","show-word-limit":""},model:{value:e.param.taskName,callback:function(t){e.$set(e.param,"taskName","string"==typeof t?t.trim():t)},expression:"param.taskName"}})],1),t("el-form-item",{attrs:{label:"任务类型",prop:"taskType",rules:e.rules.taskType}},[t("el-radio-group",{attrs:{disabled:!e.filter},on:{change:e.getIsCont},model:{value:e.param.taskType,callback:function(t){e.$set(e.param,"taskType","string"==typeof t?t.trim():t)},expression:"param.taskType"}},e._l(e.taskTypeOptions,(function(a,r){return 1!=a.code?t("el-radio",{key:r,attrs:{label:a.code}},[e._v(e._s(a.name)+"\n                            ")]):e._e()})),1)],1),2==e.param.taskType?t("el-form-item",{attrs:{label:"调度计划",prop:"cron",rules:e.rules.cron}},[t("el-input",{attrs:{readonly:"",placeholder:"请输入cron表达式",maxlength:"200","show-word-limit":""},on:{focus:function(t){e.cronPopover=!0}},model:{value:e.param.cron,callback:function(t){e.$set(e.param,"cron","string"==typeof t?t.trim():t)},expression:"param.cron"}})],1):e._e(),t("el-form-item",{attrs:{label:"任务描述",prop:"remark",rules:e.rules.remark}},[t("el-input",{attrs:{type:"textarea",autosize:"",disabled:!e.filter,placeholder:"请输入任务描述",maxlength:"200","show-word-limit":""},model:{value:e.param.remark,callback:function(t){e.$set(e.param,"remark","string"==typeof t?t.trim():t)},expression:"param.remark"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"数据库",prop:"sourceDatabase",rules:e.rules.sourceDatabase}},[t("div",{staticClass:"search"},[t("div",[t("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:e.sourceChange},model:{value:e.param.sourceDatabase,callback:function(t){e.$set(e.param,"sourceDatabase",t)},expression:"param.sourceDatabase"}},e._l(e.databaseList,(function(a){return t("el-option-group",{key:a.label,attrs:{label:a.label}},e._l(a.options,(function(e){return t("el-option",{key:e.code,attrs:{label:e.label,value:e.code}})})),1)})),1)],1),t("div",[t("el-input",{attrs:{disabled:"",placeholder:"请选择表名","show-word-limit":""},model:{value:e.param.sourceTableName,callback:function(t){e.$set(e.param,"sourceTableName","string"==typeof t?t.trim():t)},expression:"param.sourceTableName"}})],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.selectTable}},[e._v("选择")])],1)])])],1)],1),t("el-row",[t("el-col",[t("el-form-item",[e.tableShow?t("div",[t("el-table",{ref:"tableData",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:e.param.gridData,border:""}},[t("el-table-column",{attrs:{label:"字段名",align:"center",prop:"columnName"}}),t("el-table-column",{attrs:{label:"字段说明",align:"center",prop:"columnComment"}}),t("el-table-column",{attrs:{label:"稽查规则",prop:"ruleIds",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.selectedRuleData&&a.row.selectedRuleData.length>0?t("div",e._l(a.row.selectedRuleData,(function(a){return t("div",{key:a.id,staticClass:"rule-type"},[t("div",[e._v(e._s(a.ruleTypeName)+"：")]),e._l(a.ruleNameList,(function(a,r){return t("div",{key:r,staticClass:"rule-type-tag"},[t("el-tag",{attrs:{type:"success"}},[e._v(e._s(a.ruleName))])],1)}))],2)})),0):t("div",[e._v("-")])]}}],null,!1,608322721)}),t("el-table-column",{attrs:{prop:"operator",label:"稽查规则操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"operate"},[!a.row.ruleIds&&e.filter?t("span",[t("a",{attrs:{title:"添加"},on:{click:function(t){return e.addRule(a.row,a.$index)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"})])]):e._e(),e._v("\n                                             \n                                            "),a.row.ruleIds&&e.filter?t("span",[t("a",{attrs:{title:"修改"},on:{click:function(t){return e.modifyRule(a.row,a.$index)}}},[t("i",{staticClass:"el-icon-edit"})])]):e._e(),e._v("\n                                             \n                                            "),e.filter?t("span",[t("a",{attrs:{title:"删除"},on:{click:function(t){return e.deleteRule(a.row,a.$index)}}},[t("i",{staticClass:"el-icon-delete"})])]):e._e()])]}}],null,!1,459160089)})],1)],1):e._e()])],1)],1)],1)],e.cronPopover?t("new-cron",{attrs:{cronPopover:e.cronPopover,defaultVal:e.param.cron},on:{close:function(t){e.cronPopover=!1},change:e.changeCron}}):e._e(),e.showTableSelectionPage?t("table-selection-page",{attrs:{show:e.showTableSelectionPage,currentSelectDatabase:e.currentSelectDatabase,currentLayerValue:e.param.sourceDatabase},on:{submit:e.initMap,close:function(t){e.showTableSelectionPage=!1}}}):e._e(),e.showRuleDialog?t("el-dialog",{attrs:{title:"治理稽核规则配置",visible:e.showRuleDialog},on:{close:function(t){e.showRuleDialog=!1}}},[t("ruleList",{staticStyle:{height:"70vh"},attrs:{cancel:e.cancel,chooseRules:e.chooseRules,selectedValue:e.selectedValue}})],1):e._e()],2)}),[],!1,null,"74b78e97",null);t.default=p.exports},a4ff:function(e,t,a){var r=a("c208");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("2e75acb7",r,!0,{sourceMap:!1,shadowMode:!1})},b363:function(e,t,a){"use strict";a("a4ff")},c208:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".row[data-v-00bffde8]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row>div[data-v-00bffde8]:first-child{margin-right:10px}[data-v-00bffde8] .el-dialog__body{max-height:100%!important}[data-v-00bffde8] .pane-comp,[data-v-00bffde8] .tree-dashed{overflow:auto}",""])},c41f:function(e,t,a){var r=a("5917");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("0513232b",r,!0,{sourceMap:!1,shadowMode:!1})},c885:function(e,t,a){"use strict";a("c41f")},f1dd:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".search-date[data-v-60aa0f46]{width:100%!important}",""])}}]);