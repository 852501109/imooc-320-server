(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-70bebbb6","chunk-4751f152","chunk-c1d9f0fa"],{"42ec":function(e,t,a){"use strict";a.r(t),a("8e6e"),a("456d"),a("c5f6"),a("6762"),a("2fdb"),a("ac6a"),a("7f7f");var i=a("ade3"),o=a("2f62");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var n={props:{isShowDepartModal:{type:Boolean,default:!1},selectedValue:{type:Array,default:function(){return[]}}},data:function(){return{ruleTypeOptionsGroup:[],endList:[],allNodes:[],isSelect:!1,searchDepartName:"",treeLoading:!1,defaultProps:{children:"children",label:"name"},isSearch:!1,getHeight:!1,total:1,param:{page:1,rows:10,deptId:""},search_dataRange:""}},computed:l(l({},Object(o.d)("unReportAuthorization",["userList"])),Object(o.d)("apiServiceAccredit",["apiServiceAccreditDetail"])),mounted:function(){this.init()},methods:l(l(l({},Object(o.b)("unReportAuthorization",["GETTREELIST","GETUSERLIST"])),Object(o.b)(["_AJAX"])),{},{cancelBtn:function(){this.$emit("cancel")},handleRowClick:function(e,t){t.checked=!t.checked},handleDisable:function(e){return this.apiServiceAccreditDetail.createUser!=e.id},init:function(){this.$nextTick((function(){var e=document.querySelector(".custom-container");e&&(e.style.height=e.clientHeight+"px")}))},subButton:function(){var e=this.$refs.tree.getCheckedNodes().map((function(e){return{id:e.id,name:e.name}}));this.$emit("submit",e)},deepFlat:function(e,t){var a=this;if(Array.isArray(e))e.forEach((function(e){var t=e.id==a.apiServiceAccreditDetail.deptId;e.disabled=t,a.deepFlat(e,t)}));else if(e.children&&e.children.length>0){var i=e.id==this.apiServiceAccreditDetail.deptId||t;e.disabled=i,e.children.forEach((function(e){a.deepFlat(e,i)}))}else{var o=e.id==this.apiServiceAccreditDetail.deptId||t;e.disabled=o}},traverseNode:function(e){var t=this;Array.isArray(e)?e.forEach((function(e){t.traverseNode(e)})):(this.allNodes.push(e),e.children&&e.children.length>0&&e.children.forEach((function(e){t.traverseNode(e)})))},updateSameList:function(){var e=this;setTimeout((function(){e.allNodes=[],e.traverseNode(e.ruleTypeOptionsGroup);var t=e.allNodes.filter((function(t){return e.endList.map((function(e){return Number(e.id)})).includes(Number(t.id))}));e.$refs.tree.setCheckedKeys([]),e.$refs.tree.setCheckedKeys(t.map((function(e){return e.id})).concat([e.apiServiceAccreditDetail.deptId])),e.isSelect=!1}))},onSearch:function(){var e=this;this.treeLoading=!0,this.isSelect=!0,this.GETTREELIST({deptName:this.searchDepartName}).then((function(t){e.ruleTypeOptionsGroup=t||[],e.treeLoading=!1,e.$nextTick((function(){e.updateSameList()}))}))},handleNodeChange:function(){var e=this;this.isSelect||(this.allNodes=[],this.traverseNode(this.ruleTypeOptionsGroup),this.$nextTick((function(){var t=e.$refs.tree.getCheckedNodes(),a=e.allNodes.filter((function(t){return e.endList.map((function(e){return Number(e.id)})).includes(Number(t.id))})).filter((function(e){return!t.map((function(e){return Number(e.id)})).includes(Number(e.id))}));e.endList=e.endList.filter((function(e){return!a.map((function(e){return Number(e.id)})).includes(Number(e.id))})),t.forEach((function(t){e.endList.map((function(e){return Number(e.id)})).includes(Number(t.id))||e.endList.push(t)}))})))},QUERYLIST_PARAMS:function(e){var t=this;this.param.page=1,e>0&&this.publics.resetFun(this.param,(function(){t.param.rows=10}))}}),created:function(){var e=this;this.endList=this.selectedValue||[],this.treeLoading=!0,this.GETTREELIST({deptName:""}).then((function(t){e.ruleTypeOptionsGroup=t||[],e.treeLoading=!1;var a=[];e.selectedValue.forEach((function(e){a.push(e.deptId)})),e.$nextTick((function(){e.$refs.tree.setCheckedKeys(a),e.isSelect=!1}))}))}},s=(a("f59a"),a("2877")),c=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"授权部门",visible:e.isShowDepartModal,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.isShowDepartModal=t},close:e.cancelBtn}},[t("div",{staticClass:"custom-container",staticStyle:{"min-height":"60vh"}},[e.ruleTypeOptionsGroup.length>0?t("el-tree",{ref:"tree",attrs:{data:e.ruleTypeOptionsGroup,"current-node-key":e.param.ruleType,"show-checkbox":"","node-key":"id","default-expand-all":!0,props:e.defaultProps},on:{check:e.handleNodeChange,"node-click":e.handleRowClick}}):t("div",{staticClass:"empty"},[e._v("暂无数据")])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{on:{click:e.cancelBtn}},[e._v("取消")])],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.subButton}},[e._v("确认")])],1)])])}),[],!1,null,"7ebf0608",null);t.default=c.exports},"66b0":function(e,t,a){"use strict";a("74d4")},"74d4":function(e,t,a){var i=a("eda1");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),(0,a("499e").default)("732fbc28",i,!0,{sourceMap:!1,shadowMode:!1})},"974a":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".row[data-v-7ebf0608]{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.row>div[data-v-7ebf0608]{width:48%}.row[data-v-7ebf0608] .el-date-editor.el-input,.row[data-v-7ebf0608] .el-date-editor.el-input__inner{width:100%!important}.dialog-footer[data-v-7ebf0608]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.dialog-footer>div[data-v-7ebf0608]:first-child{margin-right:10px}.flex[data-v-7ebf0608]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.flex>div[data-v-7ebf0608]{margin-bottom:5px}.search-date[data-v-7ebf0608]{width:100%!important}.search[data-v-7ebf0608]{padding:0 10px}.el-icon-thumb[data-v-7ebf0608],.el-icon-view[data-v-7ebf0608]{font-size:16px;cursor:pointer;color:#409eff}.empty[data-v-7ebf0608]{color:#333;width:100%;text-align:center;font-size:14px;padding:20px 0}[data-v-7ebf0608] .el-dialog__body{max-height:100%!important}[data-v-7ebf0608] .pane-comp,[data-v-7ebf0608] .tree-dashed{overflow:auto}",""])},af4e8:function(e,t,a){"use strict";a.r(t),a("7f7f"),a("8e6e"),a("456d"),a("ac6a"),a("c5f6"),a("a481");var i=a("ade3"),o=a("2f62"),r=a("42ec");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={components:{departModal:a("c73d").default,treeModal:r.default},data:function(){return{value:"",rowId:this.$route.query.id,filter:"view"!=this.$route.query.filter,showControlDialog:!1,editFlag:!1,controlDetail:{id:null,deptName:"",deptNameList:[],deptId:"",userName:"",userNameList:[],userId:"",deptSystem:"",validateBegin:"",validateEnd:"",accessIp:"0.0.0.0",accessType:"",accessCount:"",dateRange:[],index:null},deptList:[],treeData:[],userList:[],param:{includeRole:!0,page:1,rows:10,serviceNameCn:"",serviceNameEn:"",accreditType:"",id:"",accreditId:"",accreditList:[],apiAccreditDetailVoList:[],apiControlDetailVoList:[],apiControlDetailDeptList:[],apiControlDetailUserList:[]},addDeptOrUserShow:!1,isShowUserModal:!1,isShowDepartModal:!1,showUserControlDialog:!1,rules:{accreditType:[{required:!0,message:"请输入授权方式(1:按部门授权,2:按人员授权)",trigger:"blur"}]},controlRule:{deptId:[{required:!1,message:"请选择授权部门",trigger:"change"}],userId:[{required:!1,message:"请选择授权人员",trigger:"change"}],accessIp:[{required:!0,message:"请输入访问ip",trigger:"blur"}],accessType:[{required:!0,message:"请选择访问频率",trigger:"change"}],accessCount:[{required:!1,message:"请输入访问次数",trigger:"blur"}],dateRange:[{required:!1,message:"请选择访问有效期",trigger:"change"}]}}},computed:n({},Object(o.d)("apiServiceAccredit",["apiServiceAccreditDetail","accessType"])),methods:n(n(n(n({},Object(o.b)("apiServiceAccredit",["GOEDITAPISERVICEACCREDIT","GETACCESSTYPELIST","GETDETAIL","MODIFYAPISERVICEACCREDIT","ADDAPISERVICEACCREDIT","GETUSERLIST"])),Object(o.b)("resourcecatalog",["GETDEPTLIST"])),Object(o.b)("metadataResource",["METADATARESOURCEGETTREEBYDEPT"])),{},{init:function(){var e=this;this.rowId&&this.GOEDITAPISERVICEACCREDIT({id:this.rowId}).then((function(){e.param.serviceNameEn=e.apiServiceAccreditDetail.serviceNameEn,e.param.serviceNameCn=e.apiServiceAccreditDetail.serviceNameCn,e.param.accreditType=e.apiServiceAccreditDetail.accreditType,e.param.id=e.apiServiceAccreditDetail.id,e.param.accreditId=e.apiServiceAccreditDetail.accreditId,e.param.apiControlDetailDeptList=e.apiServiceAccreditDetail.apiControlDetailDeptList,e.param.apiControlDetailUserList=e.apiServiceAccreditDetail.apiControlDetailUserList,e.param.apiControlDetailDeptList||(e.param.apiControlDetailDeptList=[]),e.param.apiControlDetailUserList||(e.param.apiControlDetailUserList=[])}))},cancel:function(){this.isShowUserModal=!1},visitTimesLimit:function(){this.controlDetail.accessCount=this.controlDetail.accessCount.replace(/^(0+)|[^\d]+/g,""),Number(this.controlDetail.accessCount)>2147483647&&(this.$message.error("访问次数不得大于2147483647"),this.controlDetail.accessCount="")},cancelDepart:function(){this.isShowDepartModal=!1},submit:function(e){var t=this;this.controlDetail.userNameList=[],e&&this.userList.forEach((function(a){e.forEach((function(e){a.id==e.id&&t.controlDetail.userNameList.push({userId:a.id,userName:a.name})}))})),this.isShowUserModal=!1},submitDepart:function(e){var t=this;this.controlDetail.deptNameList=[],e.forEach((function(e){t.deptList.forEach((function(a){a.id==e.id&&t.controlDetail.deptNameList.push({deptId:a.id,deptName:a.name})}))})),this.isShowDepartModal=!1},selectAccreditType:function(e){var t=this;null!==this.param.accreditList&&(this.param.apiAccreditDetailVoList.some((function(t){return t.type!=e}))?this.param.apiAccreditDetailVoList=[]:this.param.apiAccreditDetailVoList=this.param.accreditList.map((function(e){return{id:e.id,name:e.name,type:t.param.accreditType}})))},userChange:function(e){var t=this;this.controlDetail.userNameList=[],this.userList.forEach((function(a){e.forEach((function(e){a.id==e&&t.controlDetail.userNameList.push({userId:e,userName:a.name})}))}))},cancelControl:function(){this.showControlDialog=!1,this.showUserControlDialog=!1,this.controlDetailInit()},controlDetailInit:function(){this.controlDetail={id:null,deptName:"",deptId:"",deptNameList:[],deptSystem:"",userName:"",userNameList:[],userId:"",validateBegin:"",validateEnd:"",accessIp:"0.0.0.0",accessType:"",accessCount:"",dateRange:[],index:null}},saveUserControl:function(){var e=this;if(null==this.controlDetail.index){var t=0;if(this.param.apiControlDetailUserList.forEach((function(a){e.controlDetail.userNameList.forEach((function(i){a.userId==i.userId&&e.controlDetail.accessIp==a.accessIp&&t++}))})),t>0)return this.$message.error("存在相同的已授权部门和ip！")}this.$refs.apiControlUserDetailForm.validate((function(t){if(t){if(0==e.controlDetail.userNameList.length)return e.$message.error("请选择授权用户！");if(""==e.controlDetail.accessCount)return e.$message.error("请输入访问次数");if(e.controlDetail.userNameList.length>0)e.controlDetail.userNameList.forEach((function(t){var a=e.deepClone(e.controlDetail);a.validateBegin=e.controlDetail.dateRange[0],a.validateEnd=e.controlDetail.dateRange[1],a.userName=t.userName,a.userId=t.userId,null!=e.controlDetail.index?e.param.apiControlDetailUserList.forEach((function(t,i){e.controlDetail.index==i&&e.$set(e.param.apiControlDetailUserList,i,a)})):e.param.apiControlDetailUserList.push(a)}));else{var a=e.deepClone(e.controlDetail);a.validateBegin=e.controlDetail.dateRange[0],a.validateEnd=e.controlDetail.dateRange[1],null!=e.controlDetail.index?e.param.apiControlDetailUserList.forEach((function(t,i){e.controlDetail.index==i&&e.$set(e.param.apiControlDetailUserList,i,a)})):e.param.apiControlDetailUserList.push(a)}e.$nextTick((function(){e.$refs.controlUserTable.doLayout(),e.showUserControlDialog=!1,e.controlDetailInit()}))}}))},saveControl:function(){var e=this;if(null==this.controlDetail.index){var t=0;if(this.param.apiControlDetailDeptList.forEach((function(a){e.controlDetail.deptNameList.forEach((function(i){a.deptId==i.deptId&&e.controlDetail.accessIp==a.accessIp&&t++}))})),t>0)return this.$message.error("存在相同的已授权部门和ip！")}this.$refs.apiControlDetailForm.validate((function(t){if(t){if(0==e.controlDetail.deptNameList.length)return e.$message.error("请选择授权部门！");if(""==e.controlDetail.accessCount)return e.$message.error("请输入访问次数");if(e.controlDetail.deptNameList.length>0)e.controlDetail.deptNameList.forEach((function(t){var a=e.deepClone(e.controlDetail);a.validateBegin=e.controlDetail.dateRange[0],a.validateEnd=e.controlDetail.dateRange[1],a.deptName=t.deptName,a.deptId=t.deptId,null!=e.controlDetail.index?e.param.apiControlDetailDeptList.forEach((function(t,i){e.controlDetail.index==i&&e.$set(e.param.apiControlDetailDeptList,i,a)})):e.param.apiControlDetailDeptList.push(a)}));else{var a=e.deepClone(e.controlDetail);a.validateBegin=e.controlDetail.dateRange[0],a.validateEnd=e.controlDetail.dateRange[1],null!=e.controlDetail.index?e.param.apiControlDetailDeptList.forEach((function(t,i){e.controlDetail.index==i&&e.$set(e.param.apiControlDetailDeptList,i,a)})):e.param.apiControlDetailDeptList.push(a)}e.$nextTick((function(){e.$refs.controlTable.doLayout(),e.showControlDialog=!1,e.controlDetailInit()}))}}))},addRow:function(){this.showControlDialog=!0},addUserRow:function(){this.showUserControlDialog=!0},editRow:function(e,t){this.controlDetail.id=e.id,e.validateBegin&&e.validateEnd&&(this.controlDetail.dateRange.push(e.validateBegin),this.controlDetail.dateRange.push(e.validateEnd)),this.controlDetail.accessCount=e.accessCount,e.deptId?this.controlDetail.deptId=e.deptId:this.controlDetail.deptId=e.deptUserId,this.controlDetail.deptUserId=e.deptUserId,this.controlDetail.deptName=e.deptName,this.controlDetail.deptNameList=[{deptId:this.controlDetail.deptId,deptName:e.deptName}],this.controlDetail.accessIp=e.accessIp,this.controlDetail.accessType=e.accessType+"",this.controlDetail.deptSystem=e.deptSystem,this.controlDetail.index=t,this.showControlDialog=!0},editUserRow:function(e,t){this.controlDetail.id=e.id,e.validateBegin&&e.validateEnd&&(this.controlDetail.dateRange.push(e.validateBegin),this.controlDetail.dateRange.push(e.validateEnd)),this.controlDetail.accessCount=e.accessCount,e.userId?this.controlDetail.userId=e.userId:this.controlDetail.userId=e.deptUserId,this.controlDetail.deptUserId=e.deptUserId,this.controlDetail.userName=e.userName,this.controlDetail.userNameList=[{userId:this.controlDetail.userId,userName:e.userName}],this.controlDetail.accessIp=e.accessIp,this.controlDetail.accessType=e.accessType+"",this.controlDetail.deptSystem=e.deptSystem,this.controlDetail.index=t,this.showUserControlDialog=!0},delRow:function(e,t){this.param.apiControlDetailDeptList.splice(t,1)},delUserRow:function(e,t){this.param.apiControlDetailUserList.splice(t,1)},authDept:function(){this.isShowDepartModal=!0},authUser:function(){this.isShowUserModal=!0},deepClone:function(e){return JSON.parse(JSON.stringify(e))},subBtn:function(){var e=this,t=this,a=this.deepClone(this.param);this.$refs.apiServiceAccreditForm.validate((function(i){if(!i)return!1;e.$store.commit("SHOW_LOADING",!0),e.rowId?(a.id=e.rowId,e.MODIFYAPISERVICEACCREDIT(a).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){t.$router.go(-1)}}})}))):e.ADDAPISERVICEACCREDIT(a).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"添加成功",methods:{okEvent:function(){t.$router.go(-1)}}})}))}))}}),mounted:function(){},created:function(){var e=this;this.GETACCESSTYPELIST(),this.GETDEPTLIST().then((function(t){e.deptList=t})),this.METADATARESOURCEGETTREEBYDEPT().then((function(t){e.treeData=t})),this.GETUSERLIST().then((function(t){e.userList=t})),this.init()}},c=(a("c10f"),a("2877")),d=Object(c.a)(s,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{attrs:{title:e.filter?(e.rowId,"授权页面"):"查看授权","opt-type":e.$route.query.filter},on:{"submit-click":e.subBtn}},[[t("el-form",{ref:"apiServiceAccreditForm",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules,disabled:!e.filter}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"服务中文名",prop:"serviceNameCn",rules:e.rules.serviceNameCn}},[t("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.param.serviceNameCn,callback:function(t){e.$set(e.param,"serviceNameCn","string"==typeof t?t.trim():t)},expression:"param.serviceNameCn"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"服务英文名",prop:"serviceNameEn",rules:e.rules.serviceNameEn}},[t("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.param.serviceNameEn,callback:function(t){e.$set(e.param,"serviceNameEn","string"==typeof t?t.trim():t)},expression:"param.serviceNameEn"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"按部门"}},[t("div",{staticStyle:{color:"red"}},[e._v("（默认0.0.0.0不限制IP）")]),t("div",[t("el-tooltip",{staticClass:"item",attrs:{size:"mini",effect:"dark",content:"新增",placement:"top-start"}},[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addRow}})],1),t("el-table",{ref:"controlTable",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.param.apiControlDetailDeptList,border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},align:"center",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"deptName",label:"所属部门"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"deptSystem",label:"所属系统"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"validateBegin",label:"访问有效期起"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"validateEnd",label:"访问有效期止"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"accessIp",label:"访问IP"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"accessType",label:"访问频率"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                        "+e._s((1==t.row.accessType?"每天":"每小时")+t.row.accessCount+"次")+"\n                                    ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"createTime",label:"创建时间"}}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"operate"},[t("span",[e.filter?t("a",{attrs:{title:"修改"},on:{click:function(t){return e.editRow(a.row,a.$index)}}},[t("i",{staticClass:"iconfont iconFill"})]):e._e()]),e._v("\n                                             \n                                            "),t("span",[e.filter?t("a",{attrs:{title:"删除"},on:{click:function(t){return e.delRow(a.row.id,a.$index)}}},[t("i",{staticClass:"el-icon-remove"})]):e._e()])])]}}])}),t("template",{slot:"empty"},[t("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.LOGLIST(e.param)}}})],1)],2)],1)])],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"按人员"}},[t("div",{staticStyle:{color:"red"}},[e._v("（默认0.0.0.0不限制IP）")]),t("div",[t("el-tooltip",{staticClass:"item",attrs:{size:"mini",effect:"dark",content:"新增",placement:"top-start"}},[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addUserRow}})],1),t("el-table",{ref:"controlUserTable",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.param.apiControlDetailUserList,border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},align:"center",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"userName",label:"授权人员"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"deptSystem",label:"所属系统"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"validateBegin",label:"访问有效期起"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"validateEnd",label:"访问有效期止"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"accessIp",label:"访问IP"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"accessType",label:"访问频率"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                        "+e._s((1==t.row.accessType?"每天":"每小时")+t.row.accessCount+"次")+"\n                                    ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"createTime",label:"创建时间"}}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"operate"},[t("span",[e.filter?t("a",{attrs:{title:"修改"},on:{click:function(t){return e.editUserRow(a.row,a.$index)}}},[t("i",{staticClass:"iconfont iconFill"})]):e._e()]),e._v("\n                                             \n                                            "),t("span",[e.filter?t("a",{attrs:{title:"删除"},on:{click:function(t){return e.delUserRow(a.row.id,a.$index)}}},[t("i",{staticClass:"el-icon-remove"})]):e._e()])])]}}])}),t("template",{slot:"empty"},[t("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.LOGLIST(e.param)}}})],1)],2)],1)])],1)],1)],1)],[t("el-dialog",{attrs:{visible:e.showControlDialog,width:"50%"},on:{close:e.cancelControl,"update:visible":function(t){e.showControlDialog=t}}},[t("el-form",{ref:"apiControlDetailForm",staticClass:"form-item",attrs:{model:e.controlDetail,"label-width":"100px",rules:e.controlRule}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"所属部门",prop:"deptId",rules:e.controlRule.deptId}},[t("div",{staticClass:"flex"},[e._l(e.controlDetail.deptNameList,(function(a,i){return t("div",{key:i},[t("el-button",{attrs:{type:"warning",size:"mini"}},[e._v(e._s(a.deptName)+" ")]),e._v(" \n                                ")],1)})),t("div",[null==e.controlDetail.index?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.authDept}},[e._v("选择\n                                    ")]):e._e()],1)],2)]),t("el-form-item",{attrs:{label:"所属系统",prop:"deptSystem",rules:e.controlRule.deptSystem}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入所属系统",maxlength:"200","show-word-limit":""},model:{value:e.controlDetail.deptSystem,callback:function(t){e.$set(e.controlDetail,"deptSystem","string"==typeof t?t.trim():t)},expression:"controlDetail.deptSystem"}})],1),t("el-form-item",{attrs:{label:"访问有效期",prop:"dateRange",rules:e.controlRule.dateRange}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",clearable:""},model:{value:e.controlDetail.dateRange,callback:function(t){e.$set(e.controlDetail,"dateRange",t)},expression:"controlDetail.dateRange"}})],1)]),t("el-form-item",{attrs:{label:"访问IP",prop:"accessIp",rules:e.controlRule.accessIp}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入访问IP",maxlength:"200","show-word-limit":""},model:{value:e.controlDetail.accessIp,callback:function(t){e.$set(e.controlDetail,"accessIp","string"==typeof t?t.trim():t)},expression:"controlDetail.accessIp"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"访问频率",prop:"accessType",rules:e.controlRule.accessType}},[t("el-select",{attrs:{placeholder:"请选择访问频率",maxlength:"50",clearable:""},model:{value:e.controlDetail.accessType,callback:function(t){e.$set(e.controlDetail,"accessType","string"==typeof t?t.trim():t)},expression:"controlDetail.accessType"}},e._l(e.accessType,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),e._v("\n                     \n                    "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"访问",prop:"accessCount","label-width":"40px",rules:e.controlRule.accessCount}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入访问次数",maxlength:"10","show-word-limit":""},on:{input:e.visitTimesLimit},model:{value:e.controlDetail.accessCount,callback:function(t){e.$set(e.controlDetail,"accessCount","string"==typeof t?t.trim():t)},expression:"controlDetail.accessCount"}})],1)],1),e._v("\n                     \n                    "),t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{label:"次",prop:"","label-width":"20px"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelControl}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveControl}},[e._v("保 存")])],1)],1)],[t("el-dialog",{attrs:{visible:e.showUserControlDialog,width:"50%"},on:{close:e.cancelControl,"update:visible":function(t){e.showUserControlDialog=t}}},[t("el-form",{ref:"apiControlUserDetailForm",staticClass:"form-item",attrs:{model:e.controlDetail,"label-width":"100px",rules:e.controlRule}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"授权人员",prop:"userId",rules:e.controlRule.userId}},[t("div",{staticClass:"flex"},[e._l(e.controlDetail.userNameList,(function(a,i){return t("div",{key:i},[t("el-button",{attrs:{type:"warning",size:"mini"}},[e._v(e._s(a.userName)+" ")]),e._v(" \n                                ")],1)})),t("div",[null==e.controlDetail.index?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.authUser}},[e._v("选择\n                                    ")]):e._e()],1)],2)]),t("el-form-item",{attrs:{label:"所属系统",prop:"deptSystem",rules:e.controlRule.deptSystem}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入所属系统",maxlength:"200","show-word-limit":""},model:{value:e.controlDetail.deptSystem,callback:function(t){e.$set(e.controlDetail,"deptSystem","string"==typeof t?t.trim():t)},expression:"controlDetail.deptSystem"}})],1),t("el-form-item",{attrs:{label:"访问有效期",prop:"dateRange",rules:e.controlRule.dateRange}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",clearable:""},model:{value:e.controlDetail.dateRange,callback:function(t){e.$set(e.controlDetail,"dateRange",t)},expression:"controlDetail.dateRange"}})],1)]),t("el-form-item",{attrs:{label:"访问IP",prop:"accessIp",rules:e.controlRule.accessIp}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入访问IP",maxlength:"200","show-word-limit":""},model:{value:e.controlDetail.accessIp,callback:function(t){e.$set(e.controlDetail,"accessIp","string"==typeof t?t.trim():t)},expression:"controlDetail.accessIp"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"访问频率",prop:"accessType",rules:e.controlRule.accessType}},[t("el-select",{attrs:{placeholder:"请选择访问频率",maxlength:"50",clearable:""},model:{value:e.controlDetail.accessType,callback:function(t){e.$set(e.controlDetail,"accessType","string"==typeof t?t.trim():t)},expression:"controlDetail.accessType"}},e._l(e.accessType,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"访问",prop:"accessCount","label-width":"50px",rules:e.controlRule.accessCount}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入访问次数",maxlength:"10","show-word-limit":""},on:{input:e.visitTimesLimit},model:{value:e.controlDetail.accessCount,callback:function(t){e.$set(e.controlDetail,"accessCount","string"==typeof t?t.trim():t)},expression:"controlDetail.accessCount"}})],1)],1),e._v("\n                     \n                    "),t("el-col",{attrs:{span:2}},[t("el-form-item",{attrs:{label:"次",prop:"","label-width":"20px"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelControl}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveUserControl}},[e._v("保 存")])],1)],1)],e.isShowUserModal?t("departModal",{attrs:{isShowUserModal:e.isShowUserModal,selectedValue:e.controlDetail.userNameList},on:{cancel:e.cancel,submit:e.submit}}):e._e(),e.isShowDepartModal?t("treeModal",{attrs:{selectedValue:e.controlDetail.deptNameList,isShowDepartModal:e.isShowDepartModal},on:{cancel:e.cancelDepart,submit:e.submitDepart}}):e._e()],2)}),[],!1,null,"6985b09e",null);t.default=d.exports},c10f:function(e,t,a){"use strict";a("fc39")},c73d:function(e,t,a){"use strict";a.r(t),a("8e6e"),a("456d"),a("ac6a");var i=a("ade3"),o=a("2f62");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var n={props:{isShowUserModal:{type:Boolean,default:!1},selectedValue:{type:Array,default:function(){return[]}}},data:function(){return{ruleTypeOptionsGroup:[],endList:[],isSelect:!1,searchDepartName:"",treeLoading:!1,defaultProps:{children:"children",label:"name"},isSearch:!1,getHeight:!1,total:1,param:{page:1,rows:10,deptId:""},search_dataRange:""}},computed:l(l({},Object(o.d)("unReportAuthorization",["userList"])),Object(o.d)("apiServiceAccredit",["apiServiceAccreditDetail"])),mounted:function(){this.init()},methods:l(l(l({},Object(o.b)("unReportAuthorization",["GETOTHERTREELIST","GETUSERLIST"])),Object(o.b)(["_AJAX"])),{},{cancelBtn:function(){this.$emit("cancel")},handleDisable:function(e){return this.apiServiceAccreditDetail.createUser!=e.id},init:function(){this.$nextTick((function(){var e=document.querySelector(".custom-container");e&&(e.style.height=e.clientHeight+"px")}))},subButton:function(){var e=this.endList.map((function(e){return{id:e.id||e.userId,name:e.userName}}));this.$emit("submit",e)},rowRange:function(e){this.isSelect||this.$refs.multipleTable.toggleRowSelection(e)},handleSelectionChange:function(e){this.isSelect||(this.endList=e)},initData:function(){var e=this,t=this.param;this.isSelect=!0,this.GETUSERLIST(t).then((function(){e.endList.forEach((function(t){e.userList.rows.forEach((function(a){t.userId==a.id&&e.$refs.multipleTable.toggleRowSelection(a)}))})),e.$nextTick((function(){e.isSelect=!1}))}))},onSearch:function(){var e=this;this.treeLoading=!0,this.GETOTHERTREELIST({deptName:this.searchDepartName}).then((function(t){e.ruleTypeOptionsGroup=t||[],e.treeLoading=!1})),this.searchDepartName||(this.param.page=1,this.param.deptId="",this.initData())},handleNodeClick:function(e){this.param.deptId=e.id,this.QUERYLIST_PARAMS(0)},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.initData()},handleCurrentChange:function(e){this.$store.commit("reportAuthorization/CHANGEUSER_LIST",{}),this.param.page=e,this.initData()},QUERYLIST_PARAMS:function(e){var t=this;this.param.page=1,e>0&&this.publics.resetFun(this.param,(function(){t.param.rows=10})),this.initData()},goEdit:function(e){this.$router.push("/taskStepDetail/taskStepDetailEdit?filter=edit&id="+e)}}),created:function(){var e=this;this.endList=this.selectedValue||[],this.GETOTHERTREELIST({deptName:""}).then((function(t){e.ruleTypeOptionsGroup=t||[],e.initData()}))}},s=(a("66b0"),a("2877")),c=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"授权用户",visible:e.isShowUserModal,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.isShowUserModal=t},close:e.cancelBtn}},[t("div",{staticClass:"custom-container",staticStyle:{"min-height":"60vh"}},[t("audaque-resize-split-page",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],attrs:{"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.5)"}},[t("template",{slot:"leftPane"},[t("div",{staticClass:"search"},[t("el-input",{attrs:{placeholder:"请输入部门搜索名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchDepartName,callback:function(t){e.searchDepartName=t},expression:"searchDepartName"}})],1),e.ruleTypeOptionsGroup.length>0?t("el-tree",{attrs:{data:e.ruleTypeOptionsGroup,"current-node-key":e.param.ruleType,"node-key":"id","default-expand-all":!0,props:e.defaultProps},on:{"node-click":e.handleNodeClick}}):t("div",{staticClass:"empty"},[e._v("暂无数据")])],1),t("template",{slot:"rightPane"},[t("el-table",{ref:"multipleTable",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.userList.rows,border:""},on:{"row-click":e.rowRange,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},align:"center",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"deptName",label:"部门名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"account",label:"用户账号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"userName",label:"用户名"}}),t("template",{slot:"empty"},[t("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.LOGLIST(e.param)}}})],1)],2),t("adq-pagination",{attrs:{"current-page":e.param.page,total:e.userList.total,"page-size":e.param.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{on:{click:e.cancelBtn}},[e._v("取消")])],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.subButton}},[e._v("确认")])],1)])])}),[],!1,null,"8bf6e7e6",null);t.default=c.exports},ce11:function(e,t,a){var i=a("974a");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),(0,a("499e").default)("8fed0696",i,!0,{sourceMap:!1,shadowMode:!1})},d766:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".flex[data-v-6985b09e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.flex>div[data-v-6985b09e]{margin-bottom:5px}.get-edit-item[data-v-6985b09e]{padding-top:20px;margin:0 50px}.get-edit-item li[data-v-6985b09e]{margin-top:20px;display:-webkit-box;display:-ms-flexbox;display:flex}.get-edit-item li .get-edit-type[data-v-6985b09e]{height:40px;line-height:40px}.get-edit-item li .get-edit-title[data-v-6985b09e]{width:80px;color:#3a405b;height:40px;line-height:40px}.get-edit-item li .el-tree[data-v-6985b09e]{width:100%;border:1px solid #dcdfe6;padding:24px}",""])},eda1:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".row[data-v-8bf6e7e6]{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.row>div[data-v-8bf6e7e6]{width:48%}.row[data-v-8bf6e7e6] .el-date-editor.el-input,.row[data-v-8bf6e7e6] .el-date-editor.el-input__inner{width:100%!important}.dialog-footer[data-v-8bf6e7e6]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.dialog-footer>div[data-v-8bf6e7e6]:first-child{margin-right:10px}.flex[data-v-8bf6e7e6]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.flex>div[data-v-8bf6e7e6]{margin-bottom:5px}.search-date[data-v-8bf6e7e6]{width:100%!important}.search[data-v-8bf6e7e6]{padding:0 10px}.el-icon-thumb[data-v-8bf6e7e6],.el-icon-view[data-v-8bf6e7e6]{font-size:16px;cursor:pointer;color:#409eff}.empty[data-v-8bf6e7e6]{color:#333;width:100%;text-align:center;font-size:14px;padding:20px 0}[data-v-8bf6e7e6] .el-dialog__body{max-height:100%!important}[data-v-8bf6e7e6] .pane-comp,[data-v-8bf6e7e6] .tree-dashed{overflow:auto}",""])},f59a:function(e,t,a){"use strict";a("ce11")},fc39:function(e,t,a){var i=a("d766");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),(0,a("499e").default)("b1cf3bfa",i,!0,{sourceMap:!1,shadowMode:!1})}}]);