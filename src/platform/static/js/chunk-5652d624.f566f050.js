(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5652d624"],{"05e5":function(t,e,o){"use strict";o.r(e),o("7f7f"),o("386d"),o("8e6e"),o("ac6a"),o("456d");var a=o("ade3"),i=o("d574"),s=o("2f62"),n=o("365c"),r=o("83ee");function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach((function(e){Object(a.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}o("4279");var u={data:function(){return{isSearch:!1,param:{name:null,categoryName:null,status:null,page:1,rows:10},tableList:{rows:[],total:0},idVisibleDialog:!1,procDefId:null,action:n.default["activiti.models.import"],token:sessionStorage.getItem("token"),categoryOptions:[]}},mixins:[i.default],created:function(){this.loadTypes(),this.loadData()},components:{processConfigPublic:r.default},methods:c(c({},Object(s.b)(["_AJAX"])),{},{loadData:function(){var t=this;this.parameterEchoMixin(),this.adqSearchListMixin={param:this.param},this._AJAX({url:"activiti.models.list",method:"GET",data:this.param}).then((function(e){0==e.code&&(t.tableList=e.result)}))},loadTypes:function(){var t=this;this._AJAX({url:"sys.category.list",method:"GET",data:{page:1,rows:9999}}).then((function(e){t.categoryOptions=e.result.rows}))},handleSizeChange:function(t){this.param.rows=t,this.param.page=1,this.loadData()},handleCurrentChange:function(t){this.param.page=t,this.loadData()},search:function(t){var e=this;this.param.page=1,0==t&&this.publics.resetFun(this.param,(function(){e.param.rows=10,e.applicationTime=null})),this.loadData()},infoEdit:function(t,e){this.$router.push({path:"/process/workflow/processConfigEdit",query:{optType:t,id:e?e.id:null}})},release:function(t){var e=this,o=this;this._AJAX({url:"activiti.process.audit",method:"POST",data:{procDefId:t.procDefId}}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){o.loadData()}}})})).catch((function(){}))},designFlow:function(t){this.$router.push({path:"/process/index",query:{modelId:t?t.modelId:null,name:t?t.name:null,modelKey:t?t.modelKey:null}})},revoke:function(t){var e=this,o=this;this._AJAX({url:"activiti.biz.proc.cancel",method:"POST",data:{procInstId:t.procInstId,bizCode:t.businessKey}}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){o.loadData()}}})}))},loadImg:function(t){var e=this;this.$AudaqueToast.dialog({title:"流程",width:"1000px",data:{pic:null},mounted:function(){var o=this;e._AJAX({url:"activiti.models.img",method:"GET",responseType:"blob",data:{procDefId:t.procDefId}}).then((function(t){var e=new Blob([t]),a=window.URL.createObjectURL(e);o.pic=a}))},template:'\n                        <div style="text-align:center;">\n                            <img :src="pic" style="min-height:250px"/>\n                        </div>\n\n                    '})},versioManageMent:function(t){this.$router.push({path:"/process/workflow/versionManagement",query:{procDefKey:t?t.procDefKey:null,categoryId:t.categoryId}})},isActivate:function(t){var e=this,o=this,a=1===t.status?0:1;this.$store.commit("SHOW_LOADING",!0),this._AJAX({url:"activiti.process.status",method:"POST",data:{status:a,procDefId:t.procDefId}}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){o.loadData()}}})})).catch((function(){}))},del:function(t){var e=this,o=t.modelId?t.modelId:t.id;this.$AudaqueToast.warn({template:"确定删除？",methods:{okEvent:function(){var t=this,a=n.default["activiti.models.delete"]+"/"+o;e.$store.commit("SHOW_LOADING",!0),e._AJAX({url:a,method:"GET",data:{}}).then((function(o){t.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){e.loadData()}}})}))}}})},versionDeploy:function(t){var e=this,o=this,a=n.default["activiti.models.deploy"]+"/"+t.id;this.$store.commit("SHOW_LOADING",!0),this._AJAX({url:a,method:"POST",data:{}}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"部署成功",methods:{okEvent:function(){o.loadData()}}})}))},submitForm:function(){this.$refs.processConfig.submitForm()},isCloseDialog:function(){this.idVisibleDialog=!1,this.loadData()},uploadSuccess:function(t,e,o){if(0===t.code){var a=this;this.$AudaqueToast.tip({template:"导入成功",methods:{okEvent:function(){a.loadData()}}}),this.$refs.uploadFile.clearFiles()}else this.$AudaqueToast.error({template:t.msg,methods:{okEvent:function(){}}})},uploadError:function(t,e,o){this.$AudaqueToast.error({template:"导入失败",methods:{okEvent:function(){}}})}})},p=(o("817a"),o("2877")),d=Object(p.a)(u,(function(){var t=this,e=t._self._c;return e("audaque-table-list-page",[e("template",{slot:"title"},[e("audaque-table-title",{attrs:{title:"流程模型"}},[t.permitList.modelNew?e("i",{staticClass:"iconfont iconxinzeng2 audaque-rect-icon",on:{click:function(e){return t.infoEdit("add")}}},[t._v("\n                新增")]):t._e(),e("i",{staticClass:"iconfont iconshaixuan audaque-rect-icon",on:{click:function(e){t.isSearch=!t.isSearch}}},[t._v("筛选 ")])])],1),e("template",{slot:"search"},[e("audaque-table-search",{directives:[{name:"show",rawName:"v-show",value:t.isSearch,expression:"isSearch"}],on:{close:function(e){t.isSearch=!1},search:function(e){return t.search(1)},reset:function(e){return t.search(0)}}},[e("audaque-table-search-item",{attrs:{title:"流程名称"}},[e("el-input",{staticClass:"autoSize f14",attrs:{clearable:""},model:{value:t.param.name,callback:function(e){t.$set(t.param,"name","string"==typeof e?e.trim():e)},expression:"param.name"}})],1),e("audaque-table-search-item",{attrs:{title:"业务名称"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.param.categoryId,callback:function(e){t.$set(t.param,"categoryId",e)},expression:"param.categoryId"}},t._l(t.categoryOptions,(function(t){return e("el-option",{key:"option-"+t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("audaque-table-search-item",{attrs:{title:"状态"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.param.status,callback:function(e){t.$set(t.param,"status",e)},expression:"param.status"}},[e("el-option",{attrs:{label:"未发布",value:0}}),e("el-option",{attrs:{label:"已发布",value:1}})],1)],1)],1)],1),[e("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:t.tableList.rows,border:""}},[e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.param.page,t.param.rows)},width:"50"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"流程名称"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"modelKey",label:"流程key"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"categoryName",label:"业务名称"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"version",label:"当前启用版本"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(null!=e.row.version?0===e.row.version?"无":"v."+e.row.version:"-")+"\n                ")]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"diagramName",label:"图片名称"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("span",{staticStyle:{cursor:"pointer",color:"#5394eb"},on:{click:function(e){return t.loadImg(o.row)}}},[t._v(t._s(o.row.diagramName))])]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"createTime",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.publics.formatTime(e.row.createTime,"Y-M-D h:m:s"))+"\n                ")]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"updateTime",label:"更新时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.publics.formatTime(e.row.updateTime,"Y-M-D h:m:s"))+"\n                ")]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(null!=e.row.status||3!=e.row.status?0===e.row.status?"未发布":"已发布":"-")+"\n                ")]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"description",label:"备注"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"220px"},scopedSlots:t._u([{key:"default",fn:function(o){return[t.permitList.modelNew&&1!=o.row.status||"-"===o.row.status?e("span",{staticClass:"iconfont iconFill",attrs:{title:"编辑"},on:{click:function(e){return t.infoEdit("edit",o.row)}}}):t._e(),t.permitList.modelNew?e("span",{staticClass:"iconfont iconchakan11",attrs:{title:"查看"},on:{click:function(e){return t.infoEdit("view",o.row)}}}):t._e(),t.permitList.modelDesign?e("span",{staticClass:"iconfont iconliuchengsheji operate",attrs:{title:"设计流程"},on:{click:function(e){return t.designFlow(o.row)}}}):t._e(),t.permitList.modelDeploy&&o.row.modelId?e("span",{staticClass:"iconfont iconbushu operate",attrs:{title:"版本部署"},on:{click:function(e){return t.versionDeploy(o.row)}}}):t._e(),t.permitList.processList?e("span",{staticClass:"iconfont iconbanbenguanli operate",attrs:{title:"版本管理"},on:{click:function(e){return t.versioManageMent(o.row)}}}):t._e(),t.permitList.processStatus&&(o.row.procDefId||3!=o.row.categoryId)?e("span",{class:["iconfont operate",0===o.row.status?"iconpublish":"iconquxiaofabu"],attrs:{title:0===o.row.status?"发布":"取消发布"},on:{click:function(e){return t.isActivate(o.row)}}}):t._e(),t.permitList.modelImport?[e("el-upload",{ref:"uploadFile",staticClass:"upload-file",staticStyle:{display:"inline-block"},attrs:{action:t.action,data:{categoryId:o.row.categoryId},"on-success":t.uploadSuccess,"on-error":t.uploadError,headers:t.publics.ajaxHeaders()}},[e("span",{staticClass:"iconfont icondaoru1 operate",attrs:{title:"导入流程"}})])]:t._e(),t.permitList.modelDel&&1!=o.row.status||"-"===o.row.status?e("span",{staticClass:"iconfont iconShape1 operate",attrs:{title:"删除"},on:{click:function(e){return t.del(o.row)}}}):t._e()]}}])}),e("template",{slot:"empty"},[e("audaque-table-empty",{attrs:{tableFetchStatus:t.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(e){return t.loadData()}}})],1)],2),e("adq-pagination",{attrs:{"current-page":t.param.page,"page-size":t.param.rows,total:t.tableList.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],e("el-dialog",{staticClass:"data-permission",attrs:{title:"新增",visible:t.idVisibleDialog,width:"500","close-on-click-modal":!1},on:{"update:visible":function(e){t.idVisibleDialog=e}}},[t.idVisibleDialog?e("process-config-public",{ref:"processConfig",attrs:{"opt-type":"add","proc-def-id":t.procDefId},on:{"is-close-dialog":t.isCloseDialog}}):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.idVisibleDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")])],1)],1)],2)}),[],!1,null,"3d5a5896",null);e.default=d.exports},4644:function(t,e,o){var a=o("683b");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals),(0,o("499e").default)("4974530c",a,!0,{sourceMap:!1,shadowMode:!1})},"683b":function(t,e,o){(t.exports=o("2350")(!1)).push([t.i,"[data-v-3d5a5896] .upload-file .el-upload-list{display:none}",""])},"817a":function(t,e,o){"use strict";o("4644")}}]);