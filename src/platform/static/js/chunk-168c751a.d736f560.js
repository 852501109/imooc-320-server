(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-168c751a"],{"6ca7":function(e,t,a){"use strict";a.r(t),a("8e6e"),a("ac6a"),a("456d"),a("a481"),a("28a5"),a("96cf");var n=a("1da1"),l=a("ade3"),o=a("d574"),i=a("2f62"),s=a("365c");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u,p={data:function(){return{isSearch:!1,param:{name:null,title:null,applyer:null,suspended:null,assignee:null,page:1,rows:10},applicationTime:null,tableList:{rows:[],total:0},businessList:[{value:"财务",label:"财务"},{value:"考勤",label:"考勤"}],statusList:[{value:"状态1",label:"状态1"},{value:"状态2",label:"状态2"}],titles:["运行中","已结束"],activityName:0,suspendedObj:{null:"-",1:"运行中",2:"暂停"}}},mixins:[o.default],created:function(){this.loadData()},methods:c(c({},Object(i.b)(["_AJAX"])),{},{loadData:function(){var e=this;this.parameterEchoMixin(),this.adqSearchListMixin={param:this.param,applicationTime:this.applicationTime,activityName:this.activityName};var t=Object.assign({},this.param);t.createTimeBegin=this.applicationTime?this.applicationTime[0]:null,t.createTimeEnd=this.applicationTime?this.applicationTime[1]:null,this._AJAX({url:0===this.activityName?"activiti.process.instance.run":"activiti.process.instance.finished",method:"GET",data:t}).then((function(t){0==t.code&&(e.tableList=t.result)})).catch((function(){}))},changeTableList:function(e){this.param.page=1,this.param.rows=10,this.activityName=e,this.loadData()},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.loadData()},handleCurrentChange:function(e){this.param.page=e,this.loadData()},search:function(e){var t=this;this.param.page=1,0==e&&this.publics.resetFun(this.param,(function(){t.param.rows=10,t.applicationTime=null})),this.loadData()},revoke:function(e){var t=this,a=this;this._AJAX({url:"activiti.biz.proc.cancel",method:"POST",data:{procInstId:e.procInstId,bizCode:e.businessKey,result:6}}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){a.loadData()}}})})).catch((function(){t.loadData()}))},changeStatus:function(e){var t=this,a=this,n=2===e.suspended?1:0;this._AJAX({url:"activiti.process.instance.status",method:"POST",data:{procInsId:e.procInstId,status:n}}).then((function(e){0==e.code&&a.$AudaqueToast.tip({template:0===n?"挂起成功":"解挂成功",methods:{okEvent:function(){a.loadData()}}})})).catch((function(){t.loadData()}))},jump:(u=Object(n.a)(regeneratorRuntime.mark((function e(t){var a,n,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,n=[],e.next=4,a._AJAX({url:"activiti.task.back.nodes",method:"GET",data:{procInstId:t.procInstId,taskId:t.taskId}}).then((function(e){e.result&&e.result.length>0&&(n=e.result)})).catch((function(){l.loadData()}));case 4:0===n.length?a.$AudaqueToast.warn({template:"无可跳转节点",methods:{okEvent:function(){}}}):this.$AudaqueToast.dialog({title:"跳转",width:"800px",data:{ruleForm:{id:a.taskId,comment:"",selectedRows:[]},tableData:n},template:'\n                        <el-form ref="rejectform" :model="ruleForm" label-width="120px" class="reject-form">\n                            <el-form-item\n                                label="目标活动环节"\n                                prop="selectedRows"\n                                :rules="[{ required: true, message: \'请选择驳回节点\', trigger: \'change\' }]"\n                            >\n                                <el-table\n\n                                    ref="rejecttable"\n                                    :data="tableData"\n                                    style="width: 100%"\n                                    border\n                                    @selection-change="handleSelectionChange"\n                                >\n                                    <el-table-column\n                                        type="selection"\n                                        width="55">\n                                    </el-table-column>\n                                    <el-table-column\n                                        type="index"\n                                        label="序号"\n                                    >\n                                    </el-table-column>\n                                    <el-table-column\n                                        prop="name"\n                                        label="环节名称"\n                                    >\n                                    </el-table-column>\n                                    <el-table-column\n                                        prop="address"\n                                        label="处理人">\n                                    </el-table-column>\n                                    <el-table-column\n                                        prop="endTime"\n                                        label="处理时间"\n                                    >\n                                        <template #default="scope">\n                                            <span>{{scope.row.endTime|audaqueDatetime}}</span>\n                                        </template>\n                                    </el-table-column>\n                                </el-table>\n                            </el-form-item>\n                            <el-form-item\n                                label="说明"\n                                prop="comment"\n                                :rules="[{ required: true, message: \'请输入内容\', trigger: \'blur\' }]"\n                            >\n                                <el-input type="textarea" v-model="ruleForm.comment"/>\n                            </el-form-item>\n                        </el-form>\n\n                    ',mounted:function(){},methods:{handleSelectionChange:function(e){e.length>1&&(this.$refs.rejecttable.clearSelection(),this.$refs.rejecttable.toggleRowSelection(e.pop())),this.ruleForm.selectedRows=e},okEvent:function(){var e=this,n=!1;return this.$refs.rejectform.validate((function(l){if(!l)return n=!0,!1;var o=e.ruleForm,i={id:o.id,comment:o.comment},s=e.ruleForm.selectedRows[0];i.procInstId=s.procInstId,i.procDefId=s.procDefId,i.backTaskSid=s.key,i.id=t.taskId,a._AJAX({url:"activiti.task.back.task",method:"POST",data:i}).then((function(e){a.$AudaqueToast.tip({template:"驳回成功",methods:{okEvent:function(){a.loadData()}}})}))})),n}}});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)}),del:function(e){var t=this;this.$AudaqueToast.warn({template:"确定删除？",methods:{okEvent:function(){var a=this;t._AJAX({url:"activiti.process.instance.historic/del",method:"GET",data:{procInstIdS:e.id}}).then((function(e){a.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){t.loadData()}}})}))}}})},preview:function(e){var t=this;this.$AudaqueToast.dialog({title:"查看",className:"",width:"1000px",data:{imageDataSrc:"",imageDataSuccess:!0,imageDataError:"",hideCancel_a_d_q:!0,okBtnName:"确定",tableList:{rows:[],total:0},result:{null:"-",0:"未提交",1:"处理中",2:"通过",3:"驳回",4:"撤销",5:"不通过",6:"中止"},form:{page:1,rows:10,procInstId:null}},mounted:function(){this.imageDataSrc=e.procInstId?s.default["activiti.models.img"]+"?procInstId="+e.procInstId+"&t="+Date.now():s.default["activiti.models.img"]+"?procDefId="+e.procDefId+"&t="+Date.now(),this.tableList.rows=[],this.loadTableData()},template:'\n                             <div style="text-align:center">\n                                <img style="min-height:250px" class="content-image" :src="imageDataSrc" v-show="imageDataSuccess"/>\n                                <span v-show="!imageDataSuccess">{{ imageDataError }}</span>\n                                <div>\n                                    <el-table\n                                    tooltip-effect=\'light\'\n                                    class="el-table-common__list"\n                                    highlight-current-row\n                                    stripe\n                                    :data="tableList.rows"\n                                    row-key="id"\n                                    :tree-props="{ children: \'audits\', hasChildren: \'hasChildren\' }"\n                                    border>\n                                         <el-table-column\n                                            show-overflow-tooltip\n                                            type="index"\n                                            label="序号"\n                                            width="50">\n                                        </el-table-column>\n                                        <el-table-column\n                                                show-overflow-tooltip\n                                                prop="name"\n                                                label="环节"\n                                        ></el-table-column>\n                                        <el-table-column\n                                                show-overflow-tooltip\n                                                prop="startTime"\n                                                label="开始时间"\n                                        ></el-table-column>\n                                        <el-table-column\n                                                show-overflow-tooltip\n                                                prop="endTime"\n                                                label="完成时间"\n                                        ></el-table-column>\n                                        <el-table-column\n                                            show-overflow-tooltip\n                                            prop="nodeDeadLine"\n                                            label="节点期限"\n                                    >\n                                        <template slot-scope="scope">{{ publics.formatTime(scope.row.nodeDeadLine,\'Y-M-D h:m:s\') }}</template>\n                                    </el-table-column>\n                                        <el-table-column\n                                                show-overflow-tooltip\n                                                prop="duration"\n                                                label="用时(秒)"\n                                        >\n                                        <template #default="scope">\n                                            {{scope.row.duration ? scope.row.duration / 1000 : \'-\'}}\n                                        </template>\n                                        </el-table-column>\n                                        <el-table-column\n                                                show-overflow-tooltip\n                                                prop="assignee"\n                                                label="审核人"\n                                        >\n                                            <template #default="scope">\n                                                <span v-html="markRed(scope.row.assignee)"></span>\n                                            </template>\n                                        </el-table-column>\n                                        <el-table-column\n                                                show-overflow-tooltip\n                                                prop="comment"\n                                                label="审核意见"\n                                        ></el-table-column>\n\x3c!--                                        <el-table-column--\x3e\n\x3c!--                                            show-overflow-tooltip--\x3e\n\x3c!--                                            prop="comment"--\x3e\n\x3c!--                                            label="审核"--\x3e\n\x3c!--                                        >--\x3e\n\x3c!--                                            <template #default="scope">--\x3e\n\x3c!--                                                <span>{{result[scope.row.result]}}</span>--\x3e\n\x3c!--                                            </template>--\x3e\n\x3c!--                                        </el-table-column>--\x3e\n                                    </el-table>\n                                     <adq-pagination\n                                        @size-change="sizeChange"\n                                        @current-change="currentChange"\n                                        :total="tableList.total"\n                                        :page-size="form.rows"\n                                    ></adq-pagination>\n                                </div>\n                            </div>\n\n                            ',methods:{okEvent:function(){},markRed:function(e){if(!e)return"-";for(var t=e.split(","),a=0;a<t.length;a++){var n=t[a];if(/_\*$/.test(n)){var l=n.replace("_*","");t[a]='<span style="color:red;">'+l+"</span>"}}return t.join(",")},loadTableData:function(){var a=this,n=e.procInstId?e.procInstId:e.id,l=this.form;l.procInstId=n,t._AJAX({url:"activiti.task.historic",method:"GET",data:l}).then((function(e){a.tableList=e.result}))},sizeChange:function(e){this.form.rows=e,this.loadTableData()},currentChange:function(e){this.form.page=e,this.loadTableData()}}})}})},m=(a("804a"),a("2877")),d=Object(m.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("audaque-table-list-page",[a("template",{slot:"title"},[a("audaque-table-title",{attrs:{titles:e.titles,index:e.activityName},on:{change:e.changeTableList}},[a("i",{staticClass:"iconfont iconshaixuan audaque-rect-icon",on:{click:function(t){e.isSearch=!e.isSearch}}},[e._v("筛选查询 ")])])],1),a("template",{slot:"search"},[a("audaque-table-search",{directives:[{name:"show",rawName:"v-show",value:e.isSearch,expression:"isSearch"}],on:{close:function(t){e.isSearch=!1},search:function(t){return e.search(1)},reset:function(t){return e.search(0)}}},[a("audaque-table-search-item",{attrs:{title:"流程名称"}},[a("el-input",{staticClass:"autoSize f14",model:{value:e.param.name,callback:function(t){e.$set(e.param,"name",t)},expression:"param.name"}})],1),a("audaque-table-search-item",{attrs:{title:"申请标题"}},[a("el-input",{staticClass:"autoSize f14",attrs:{clearable:""},model:{value:e.param.title,callback:function(t){e.$set(e.param,"title",t)},expression:"param.title"}})],1),0===e.activityName?a("audaque-table-search-item",{attrs:{title:"状态"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.param.suspended,callback:function(t){e.$set(e.param,"suspended",t)},expression:"param.suspended"}},[a("el-option",{attrs:{label:"运行中",value:1}}),a("el-option",{attrs:{label:"暂停",value:2}})],1)],1):e._e(),a("audaque-table-search-item",{attrs:{title:"发起人"}},[a("el-input",{staticClass:"autoSize f14",attrs:{clearable:""},model:{value:e.param.applyer,callback:function(t){e.$set(e.param,"applyer",t)},expression:"param.applyer"}})],1),0===e.activityName?a("audaque-table-search-item",{attrs:{title:"处理人"}},[a("el-input",{staticClass:"autoSize f14",attrs:{clearable:""},model:{value:e.param.assignee,callback:function(t){e.$set(e.param,"assignee",t)},expression:"param.assignee"}})],1):e._e(),a("audaque-table-search-item",{staticClass:"search-time-line",attrs:{title:"发起时间"}},[a("el-date-picker",{staticClass:"search-date",attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.applicationTime,callback:function(t){e.applicationTime=t},expression:"applicationTime"}})],1)],1)],1),[a("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.tableList.rows,border:""}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},width:"50"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"businessKey",label:"流程流水号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"流程名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"title",label:"申请标题"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"applyer",label:"发起人"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"startTime",label:"发起时间"}}),0===e.activityName?a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"currTaskName",label:"当前节点"}}):e._e(),0===e.activityName?a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"suspended",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.suspendedObj[t.row.suspended])+"\n                ")]}}],null,!1,3752098492)}):e._e(),0===e.activityName?a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"assigneeName",label:"处理人"}}):e._e(),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"iconfont iconchakan11 operate",attrs:{title:"查看"},on:{click:function(a){return e.preview(t.row)}}}),0===e.activityName?a("span",{staticClass:"iconfont icontingzhi operate",attrs:{title:"结束"},on:{click:function(a){return e.revoke(t.row)}}}):e._e(),0===e.activityName?a("span",{class:["iconfont  operate",2===t.row.suspended?"iconjihuo":"iconminus"],attrs:{title:2===t.row.suspended?"解挂":"挂起"},on:{click:function(a){return e.changeStatus(t.row)}}}):e._e(),0===e.activityName?a("span",{staticClass:"iconfont iconiconzhengli_tiaozhuan operate",attrs:{title:"跳转"},on:{click:function(a){return e.jump(t.row)}}}):e._e(),1===e.activityName?a("span",{staticClass:"iconfont iconShape1 operate",attrs:{title:"删除"},on:{click:function(a){return e.del(t.row)}}}):e._e()]}}])}),a("template",{slot:"empty"},[a("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.loadData()}}})],1)],2),a("adq-pagination",{attrs:{"current-page":e.param.page,"page-size":e.param.rows,total:e.tableList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})]],2)}),[],!1,null,"04f1ae3e",null);t.default=d.exports},"804a":function(e,t,a){"use strict";a("df29")},"87d5":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,'[data-v-04f1ae3e] .audaque-table-title__title-active{position:relative;margin-right:35px}[data-v-04f1ae3e] .audaque-table-title__title-active:before{content:"";width:100%;height:2px;background:#5394eb;position:absolute;bottom:-12px}',""])},df29:function(e,t,a){var n=a("87d5");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals),(0,a("499e").default)("18028221",n,!0,{sourceMap:!1,shadowMode:!1})}}]);