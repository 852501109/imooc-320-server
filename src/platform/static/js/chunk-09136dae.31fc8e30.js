(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-09136dae","chunk-6368203c"],{2116:function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,"[data-v-097afd5b] .el-table td,[data-v-097afd5b] .el-table th,[data-v-097afd5b] .el-table th.el-table__cell>.cell{text-align:center!important}[data-v-097afd5b] .el-form{width:90%;margin:0 auto}.tips[data-v-097afd5b]{padding-top:5px;display:inline-block;color:#e6a23c}.checkboxrow[data-v-097afd5b]{width:80%;margin:0 0 10px 0}.rule-type[data-v-097afd5b]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.rule-type span[data-v-097afd5b]{display:inline-block}.operate[data-v-097afd5b]{cursor:pointer;color:#53a7f8;font-size:12px}.require[data-v-097afd5b]{color:#f56c6c;font-size:16px;margin:0 3px}.sql_btn_group[data-v-097afd5b]{margin-bottom:10px}",""])},2662:function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,"[data-v-1f45bdba] .CodeMirror{color:#000;direction:ltr;height:500px!important;line-height:22px;border:1px solid #e7e7e7}.CodeMirror-hints[data-v-1f45bdba]{z-index:9999!important}",""])},"4bca":function(t,e,a){var o=a("2116");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals),(0,a("499e").default)("357b832e",o,!0,{sourceMap:!1,shadowMode:!1})},9516:function(t,e,a){"use strict";a("4bca")},b04a:function(t,e,a){"use strict";a("e68a")},b866:function(t,e,a){var o=a("d131");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals),(0,a("499e").default)("3875f97e",o,!0,{sourceMap:!1,shadowMode:!1})},ce93:function(t,e,a){"use strict";a.r(e),a("7f7f"),a("8e6e"),a("456d"),a("c5f6"),a("5df3"),a("4f7f"),a("ac6a"),a("20d6"),a("7514");var o=a("ade3"),i=a("2f62"),s=a("a026"),n=a("f029"),r=a("db05"),l=a.n(r),u=a("e762");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(o.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={props:["selectParam"],watch:{selectParam:{handler:function(t){var e=this;this.GETSOURCECOLUMNLIST({sourceTableId:t.sourceRows[0].alreadySelectSourceTable[0].id,targetTableId:t.alreadySelectTargetTable[0].id}).then((function(){var t=e.sourceTableValue;e.customData=e.sourceColumnList[t]}))},deep:!0}},data:function(){return{middleValue:"",customData:[],isDot:!1,taskStep:{id:"",taskId:this.$route.query.taskId,autoCreateTab:0,isAutoCreate:!1,taskStepDetail:{id:null,stepId:null,sourceTableId:null,targetTableId:null,sqlContent:"",whereCondition:"",taskRuleRelList:[]}},dialogVisible:!1,updateData:{ruleId:""},index:null,columnSortList:[],columnSortedList:[],checkData:[],selectItem:"",ysyyTableData:{targetColumnId:null,baseTableId:null,sourceColumnId:null},taskId:this.$route.query.taskId,stepId:this.$route.query.stepId,basicInfoForm:{sqlMain:""},activeName:"first",autoMapValue:!1,taskFusionInfoList:[],param:{page:1,rows:10,whereCondition:"",tableData:[],asyncConfig:1,growField:""},rules:{sourceDatabase:[{required:!0,message:"请选择",trigger:"change"}],ruleId:[{required:!0,message:"请选择",trigger:"change"}]},alreadySelectTargetTable:[]}},components:{SqlEditor:n.default},computed:d(d({},Object(i.d)("dataFusionTask",["fusionStrategyOptions","sourceColumnList","tableDataYSYY","tableColumnData","stepAndDetail"])),{},{sourceTableValue:function(){return this.selectParam.sourceRows[0].alreadySelectSourceTable[0].id},isNotDelRuleId:function(){return function(t){var e=this.taskStep.taskStepDetail.taskRuleRelList.find((function(e){return e.sourceColumnId==t}));return void 0===e||"del"!==e.optType}}}),mounted:function(){},created:function(){this.GETFUSIONSTRATEGY_LIST()},methods:d(d(d({},Object(i.b)("dataFusionTask",["GETFUSIONSTRATEGY_LIST","GETSOURCECOLUMNLIST","GETYSYYTABLEDATA","GETCOLUMNSORTDATA","UPDATESORT","INSERTSORT","DELSORT","ADDSTEP","UPDATESTEP","QUERYSTEPANDDETAIL"])),Object(i.b)(["_AJAX"])),{},{handleClose:function(t){var e=this.taskStep.taskStepDetail.taskRuleRelList.findIndex((function(e){return e.sourceColumnId==t}));this.taskStep.taskStepDetail.taskRuleRelList[e].optType="del",this.basicInfoForm.sqlMain="",this.isDot=!0},switchChange:function(t){this.columnSortedList&&this.columnSortedList.length&&this.columnSortedList.forEach((function(e){t.columnId==e.columnId&&(e.sortType=t.sortType)}))},updateMiddleValue:function(t){t&&"del"===t.optType?this.middleValue="":this.middleValue=this.updateData.ruleId||""},update:function(t,e){var a=this;if(null==t.targetColumnCode||null==t.targetColumnCode||""==t.targetColumnCode)return s.default.prototype.$message.warning("请选择字段在进行配置");var o=this.taskStep.taskStepDetail.taskRuleRelList.find((function(e){return e.sourceColumnId==t.id}));this.ysyyTableData={baseTableId:this.sourceTableValue,sourceColumnId:t.id,taskId:this.taskId,sourceColumnName:t.columnName,targetColumnId:t.targetColumnCode},this.selectItem="",this.checkData=[],this.index=e,this.updateData=JSON.parse(JSON.stringify(t)),"null"==t.ruleId?this.$set(this.updateData,"ruleId",""):this.$set(this.updateData,"ruleId",t.ruleId),this.updateMiddleValue(o);var i=this.updateData.ruleId;this.GETYSYYTABLEDATA(this.ysyyTableData).then((function(){1==i&&"del"!==o.optType&&(a.selectItem=o.sourceEntityId),2==i&&a.tableDataYSYY.forEach((function(t){if(o&&o.taskFusionInfoList){var e=o.taskFusionInfoList.find((function(e){return e.sourceEntityId===t.tableId}));"del"!==o.optType&&(t.limit=e.sortNum,t.sortType=e.sortType),setTimeout((function(){a.$refs.YSYYData.toggleRowSelection(t,!0)}),1e3)}}))})).then((function(){a.GETCOLUMNSORTDATA({sourceTableId:a.sourceTableValue,sourceColumnId:t.id,taskId:a.taskId,targetColumnId:t.targetColumnCode}).then((function(){a.columnSortList=a.tableColumnData,a.columnSortedList=a.tableColumnData,a.checkData=[],a.columnSortList&&a.columnSortList.length&&o&&o.taskFusionInfoList&&a.columnSortList.forEach((function(t){t.sortType="desc";var e=o.taskFusionInfoList.find((function(e){return e.columnName===t.columnName}));e&&"del"!==o.optType&&(t.sortType=e.sortType,a.checkData.push(t))})),a.dialogVisible=!0,setTimeout((function(){a.rowDrop()}),1e3)}))}))},rowDrop:function(){var t=this;this.$dragging.$on("dragged",(function(e){var a=e.value;t.columnSortedList=a.list.map((function(t,e){return{id:t.id,sortNum:t.sortNum||e,columnId:t.columnId,columnName:t.columnName,columnComment:t.columnComment,taskRuleRelId:t.taskRuleRelId,sourceEntityId:t.sourceEntityId,sortType:t.sortType}}))})),this.$dragging.$on("dragend",(function(){}))},change:function(){this.basicInfoForm.sqlMain="",this.isDot=!0},matchColumnDim:function(t,e){return t.replaceAll("_","").replaceAll("-","").toLowerCase()===e.replaceAll("_","").replaceAll("-","").toLowerCase()},Automaticmapping:function(t){var e=this;t?this.customData.forEach((function(t){var a=e.sourceColumnList[e.selectParam.alreadySelectTargetTable[0].id].find((function(a){return e.matchColumnDim(t.columnName,a.columnName)}));t.targetColumnCode=a?a.id:""})):this.customData.forEach((function(t){t.targetColumnCode=""}))},rowChange:function(t){this.selectItem=t.tableId},handleClick:function(){},cancelSelect:function(){},showType:function(t){this.updateData.ruleId=t},generateSql:function(){var t=this,e=this.customData.filter((function(t){return""!=t.targetColumnCode&&null!=t.targetColumnCode})).map((function(t){return t.targetColumnCode}));if(new Set(e).size!==e.length)this.$message.error("目标表的表字段不允许重复");else{this.taskStep.isAutoCreate=this.selectParam.isAutoCreate,this.taskStep.taskStepDetail.stepId=this.stepId,this.taskStep.taskStepDetail.sourceTableId=this.sourceTableValue,this.taskStep.taskStepDetail.targetTableId=this.selectParam.alreadySelectTargetTable[0].id,this.taskStep.taskStepDetail.whereCondition=Object(u.b)(this.param.whereCondition),this.customData.forEach((function(e){if(""!=e.targetColumnCode){var a={};a.sourceColumnId=e.id,a.targetColumnId=e.targetColumnCode,a.taskId=t.taskId,a.catCode="FUSION_STRATEGY",t.taskStep.taskStepDetail.taskRuleRelList.length>0?null==t.taskStep.taskStepDetail.taskRuleRelList.find((function(t){return t.sourceColumnId==e.id}))&&t.taskStep.taskStepDetail.taskRuleRelList.push(a):t.taskStep.taskStepDetail.taskRuleRelList.push(a)}}));var a=JSON.parse(JSON.stringify(this.taskStep));a.taskStepDetail.taskRuleRelList.filter((function(t){return"del"===t.optType})).forEach((function(t){t.ruleId=null})),this._AJAX({url:"dwm.generateSql",method:"POST",data:a}).then((function(e){var a=e[0].sql;t.$set(t.basicInfoForm,"sqlMain",a),t.$set(t.taskStep.taskStepDetail,"sqlContent",Object(u.b)(a)),setTimeout((function(){t.$refs.sqleditor.setVal()}),500),t.isDot=!1,t.$message.success("生成SQL成功！")})).catch((function(t){}))}},changeTextarea:function(t){this.$set(this.basicInfoForm,"sqlMain",t)},formaterSql:function(t){var e=this.$refs.sqleditor;e.editor.setValue(l.a.format(e.editor.getValue()))},cancel:function(){this.dialogVisible=!1,this.updateData={ruleId:""}},fusionTypeName:function(t){return{1:"一数一源",2:"来源优先级",3:"数据新鲜度",4:"最大值",5:"最小值",6:"最高频"}[t]},submitData:function(){var t=this,e=this.updateData.ruleId;if(1==this.updateData.ruleId&&""===this.selectItem)return s.default.prototype.$message.warning("请选择一条数据！");var a={sourceColumnId:this.customData[this.index].id,targetColumnId:this.customData[this.index].targetColumnCode,sourceColumnName:this.customData[this.index].columnName,taskId:this.taskId,ruleId:e,optType:"",catCode:"FUSION_STRATEGY"};1==e?(a.sourceEntityId=this.selectItem,this.taskStep.taskStepDetail.taskRuleRelList=this.taskStep.taskStepDetail.taskRuleRelList.filter((function(e){return e.sourceColumnId!=t.ysyyTableData.sourceColumnId})),this.taskStep.taskStepDetail.taskRuleRelList.push(a)):2==e?(a.taskFusionInfoList=[],this.tableDataYSYY.forEach((function(t){var e={};e.sourceEntityId=t.tableId,e.sortNum=t.limit,a.taskFusionInfoList.push(e)})),this.taskStep.taskStepDetail.taskRuleRelList=this.taskStep.taskStepDetail.taskRuleRelList.filter((function(e){return e.sourceColumnId!=t.ysyyTableData.sourceColumnId})),this.taskStep.taskStepDetail.taskRuleRelList.push(a)):3==e?(this.taskStep.taskStepDetail.taskRuleRelList=this.taskStep.taskStepDetail.taskRuleRelList.filter((function(t){return t.sourceColumnId!==a.sourceColumnId})),a.taskFusionInfoList=[],this.checkData.forEach((function(t){var e={id:t.id,sortNum:t.sortNum,columnId:t.columnId,columnName:t.columnName,columnComment:t.columnComment,taskRuleRelId:t.taskRuleRelId,sourceEntityId:t.columnId,sortType:t.sortType};a.taskFusionInfoList.push(e)})),this.taskStep.taskStepDetail.taskRuleRelList.push(a)):(this.taskStep.taskStepDetail.taskRuleRelList=this.taskStep.taskStepDetail.taskRuleRelList.filter((function(e){return e.sourceColumnId!=t.ysyyTableData.sourceColumnId})),this.taskStep.taskStepDetail.taskRuleRelList.push(a)),delete this.customData[this.index].ruleId,delete this.customData[this.index].ruleName,this.$set(this.customData[this.index],"ruleName",this.fusionTypeName(e)),this.$set(this.customData[this.index],"ruleId",e),this.dialogVisible=!1,this.updateData={ruleId:""},this.basicInfoForm.sqlMain="",this.isDot=!0},handleStep:function(t){var e=this;this.QUERYSTEPANDDETAIL({taskId:this.taskId,id:t}).then((function(){e.param.whereCondition=e.stepAndDetail.taskStepDetail.whereCondition,e.taskStep.taskStepDetail.id=e.stepAndDetail.taskStepDetail.id,e.basicInfoForm.sqlMain=e.stepAndDetail.taskStepDetail.sqlContent,e.stepAndDetail.taskStepDetail.taskRuleRelList.forEach((function(t){var a=t.ruleId,o={sourceColumnId:t.sourceColumnId,targetColumnId:t.targetColumnId,sourceColumnName:t.sourceColumnName,taskId:t.taskId,ruleId:a,catCode:"FUSION_STRATEGY",optType:""};if(1==a)o.sourceEntityId=t.ysyyTableData[0].sourceEntityId,e.taskStep.taskStepDetail.taskRuleRelList.push(o);else if(2==a)o.taskFusionInfoList=[],t.ysyyTableData.forEach((function(t){var e={};e.sourceEntityId=t.tableId,e.sortNum=t.sortNum,o.taskFusionInfoList.push(e)})),e.taskStep.taskStepDetail.taskRuleRelList.push(o);else if(3==a){o.taskFusionInfoList=[];var i=t.fusionSorts.filter((function(t){return 1==t.checked}));if(!i)return;i.forEach((function(t){var e={id:t.id,sortNum:t.sortNum,columnId:t.columnId,columnName:t.columnName,columnComment:t.columnComment,taskRuleRelId:t.taskRuleRelId,sourceEntityId:t.columnId,sortType:t.sortType};o.taskFusionInfoList.push(e)})),e.taskStep.taskStepDetail.taskRuleRelList.push(o)}else e.taskStep.taskStepDetail.taskRuleRelList.push(o)})),e.GETSOURCECOLUMNLIST({sourceTableId:e.stepAndDetail.taskStepDetail.sourceTableId,targetTableId:e.stepAndDetail.taskStepDetail.targetTableId}).then((function(){var t=e.sourceTableValue;e.customData=e.sourceColumnList[t],e.customData.forEach((function(t,a){var o=e.deepClone(e.stepAndDetail.taskStepDetail.taskRuleRelList.find((function(e){return e.sourceColumnId===t.id})));o&&(t.targetColumnCode=o.targetColumnId,t.ruleId=o.ruleId,null!=o.targetColumnId&&e.$set(e.customData[a],"targetColumnCode",Number(o.targetColumnId)),e.$set(e.customData[a],"ruleId",o.ruleId+""))}))}))}))},deepClone:function(t){if(t)return JSON.parse(JSON.stringify(t))},submit:function(t){var e=this,a=this;return""==a.basicInfoForm.sqlMain?a.$message.error("sql不能为空"):(this.$store.commit("fusionTask/changeLoading",!0),new Promise((function(o,i){a.$refs.stepThemeLayerForm.validate((function(s){s&&(a.taskStep.isAutoCreate=a.selectParam.isAutoCreate,a.taskStep.taskStepDetail.sourceTableId=a.sourceTableValue,a.taskStep.taskStepDetail.sqlContent=Object(u.b)(a.basicInfoForm.sqlMain),a.taskStep.taskStepDetail.whereCondition=a.param.whereCondition,a.taskStep.taskStepDetail.targetTableId=a.selectParam.alreadySelectTargetTable[0].id,t?(a.taskStep.id=t,a.taskStep.taskStepDetail.stepId=t,a.UPDATESTEP(a.taskStep).then((function(){e.$store.commit("fusionTask/changeLoading",!1),o(s)})).catch((function(){e.$store.commit("fusionTask/changeLoading",!1),i(s)}))):a.ADDSTEP(a.taskStep).then((function(){e.$store.commit("fusionTask/changeLoading",!1),o(s)})).catch((function(){e.$store.commit("fusionTask/changeLoading",!1),i(s)})))}))})))},next:function(t){var e=this;return""==e.basicInfoForm.sqlMain?e.$message.error("sql不能为空"):new Promise((function(a,o){e.$refs.stepThemeLayerForm.validate((function(i){i&&(e.$store.commit("fusionTask/changeLoading",!0),e.taskStep.isAutoCreate=e.selectParam.isAutoCreate,e.taskStep.taskStepDetail.sourceTableId=e.sourceTableValue,e.taskStep.taskStepDetail.targetTableId=e.selectParam.alreadySelectTargetTable[0].id,e.taskStep.taskStepDetail.sqlContent=Object(u.b)(e.basicInfoForm.sqlMain),e.taskStep.taskStepDetail.whereCondition=e.param.whereCondition,t?(e.taskStep.id=t,e.taskStep.taskStepDetail.stepId=t,e.UPDATESTEP(e.taskStep).then((function(){a(i)})).catch((function(){o(i)}))):e.ADDSTEP(e.taskStep).then((function(){a(i)})).catch((function(){o(i)})))}))}))}})},p=(a("9516"),a("2877")),f=Object(p.a)(m,(function(){var t=this,e=t._self._c;return e("div",[e("el-form",{ref:"stepThemeLayerForm",staticClass:"form-item",attrs:{model:t.param,"label-width":"120px",rules:t.rules,"label-position":"left",disabled:"view"===t.$route.query.filter}},[e("div",[e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"字段映射",name:"first"}},[e("div",[e("div",{staticClass:"checkboxrow"},[e("el-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(e){return t.Automaticmapping(!0)}}},[t._v("字段自动映射")])],1),e("el-table",{ref:"tableData",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:t.customData,border:""}},[e("el-table-column",{attrs:{label:t.selectParam.sourceRows[0].alreadySelectSourceTable[0].tableName,align:"center",prop:"columnName"}}),e("el-table-column",{attrs:{label:t.selectParam.alreadySelectTargetTable[0].tableName,prop:"targetColumnCode"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-select",{attrs:{filterable:"",clearable:"",size:"mini"},on:{change:function(e){return t.change(a.row,a.$index)}},model:{value:a.row.targetColumnCode,callback:function(e){t.$set(a.row,"targetColumnCode",e)},expression:"scope.row.targetColumnCode"}},t._l(t.sourceColumnList[t.selectParam.alreadySelectTargetTable[0].id],(function(t){return e("el-option",{key:t.id,attrs:{label:t.columnName,value:t.id}})})),1)]}}])}),e("el-table-column",{attrs:{label:"融合策略",prop:"ruleName",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return"null"!=a.row.ruleId?[a.row.ruleId&&t.isNotDelRuleId(a.row.id)?e("el-tag",{attrs:{closable:""},on:{close:function(e){return t.handleClose(a.row.id)}}},[t._v("\n                                        "+t._s(1==a.row.ruleId?"一数一源":2==a.row.ruleId?"来源优先级":3==a.row.ruleId?"数据新鲜度":4==a.row.ruleId?"最大值":5==a.row.ruleId?"最小值":6==a.row.ruleId?"最高频":"-")+"\n                                    ")]):t._e()]:void 0}}],null,!0)}),e("el-table-column",{attrs:{label:"融合策略配置",prop:"inspect",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return["au_dwd"==t.selectParam.sourceRows[0].sourceDatabase&&1!==a.row.additionColumn?e("span",[e("a",{attrs:{title:"配置"},on:{click:function(e){return t.update(a.row,a.$index)}}},[e("i",{staticClass:"el-icon-circle-check"}),t._v("配置")])]):t._e()]}}])})],1),e("br"),e("el-form-item",{attrs:{prop:"whereCondition",rules:{required:!1,message:"请输入",trigger:"change"}},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",[t._v("where条件")]),e("el-tooltip",{staticClass:"item",staticStyle:{"padding-left":"10px"},attrs:{effect:"dark",placement:"right"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                                        注：增量时可以设置，where条件不需填写where关键字\n                                    ")]),e("i",{staticClass:"content-view iconfont iconbangzhu operate"})])]},proxy:!0}])},[e("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.param.whereCondition,callback:function(e){t.$set(t.param,"whereCondition",e)},expression:"param.whereCondition"}})],1)],1)]),e("el-tab-pane",{attrs:{label:"sql",name:"second"}},[e("template",{slot:"label"},[e("el-badge",{attrs:{"is-dot":t.isDot}},[t._v("\n                            SQL\n                            "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                                    注：红点标记表示字段映射或配置发生改变，需要切换到sql页面重新生成sql\n                                ")]),e("i",{staticClass:"content-view iconfont iconbangzhu operate"})])],1)],1),"second"===t.activeName?e("div",[e("div",{staticClass:"sql_btn_group"},[e("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:t.generateSql}},[t._v("生成SQL")]),e("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){return t.formaterSql(t.basicInfoForm.sqlMain)}}},[t._v("格式化SQL")])],1),e("SqlEditor",{ref:"sqleditor",attrs:{value:t.basicInfoForm.sqlMain},on:{changeTextarea:function(e){return t.changeTextarea(e)}}})],1):t._e()],2)],1)],1)]),t.dialogVisible?e("el-dialog",{attrs:{title:"合并规则配置",visible:t.dialogVisible,width:"50%"},on:{close:t.cancel,"update:visible":function(e){t.dialogVisible=e}}},[[e("el-form",{ref:"updateForm",staticClass:"form-item",attrs:{model:t.updateData,"label-width":"120px",rules:t.rules}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"融合策略",prop:"ruleId",rules:t.rules.ruleId}},[e("el-select",{attrs:{filterable:"",size:"mini"},on:{change:t.showType},model:{value:t.middleValue,callback:function(e){t.middleValue=e},expression:"middleValue"}},t._l(t.fusionStrategyOptions,(function(t){return e("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})),1)],1),e("el-table",{directives:[{name:"show",rawName:"v-show",value:1==t.middleValue,expression:"middleValue == 1"}],ref:"YSYYData",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:t.tableDataYSYY,"row-key":function(t){return t.tableId},border:""},on:{"row-click":t.rowChange}},[e("el-table-column",{attrs:{align:"center",width:"55",label:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-radio",{staticClass:"radio",attrs:{label:a.row.tableId},model:{value:t.selectItem,callback:function(e){t.selectItem=e},expression:"selectItem"}},[t._v(" ")])]}}],null,!1,1525676395)}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.param.page,t.param.rows)},align:"center",width:"80"}}),t._e(),e("el-table-column",{attrs:{label:"部门",width:"80","show-overflow-tooltip":"",align:"center",prop:"deptName"}}),e("el-table-column",{attrs:{label:"系统",width:"80","show-overflow-tooltip":"",align:"center",prop:"systemName"}}),e("el-table-column",{attrs:{label:"表名","show-overflow-tooltip":"",align:"center",prop:"tableName"}})],1),e("el-table",{directives:[{name:"show",rawName:"v-show",value:2==t.middleValue,expression:"middleValue == 2"}],ref:"YSYYData1",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:t.tableDataYSYY,border:""}},[e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.param.page,t.param.rows)},align:"center",width:"80"}}),e("el-table-column",{attrs:{width:"140",align:"center",prop:"limit"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v("优先级")]),e("el-tooltip",{staticClass:"item",staticStyle:{"padding-left":"3px"},attrs:{effect:"dark",placement:"right"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                                            注：优先级数值越小代表优先级越高\n                                        ")]),e("i",{staticClass:"content-view iconfont iconbangzhu operate"})])]},proxy:!0},{key:"default",fn:function(a){return[e("el-input-number",{attrs:{size:"mini","controls-position":"right",min:1,max:1e3},model:{value:a.row.limit,callback:function(e){t.$set(a.row,"limit",e)},expression:"scope.row.limit"}})]}}],null,!1,187014258)}),e("el-table-column",{attrs:{label:"部门",width:"80","show-overflow-tooltip":"",align:"center",prop:"deptName"}}),e("el-table-column",{attrs:{label:"系统",width:"80","show-overflow-tooltip":"",align:"center",prop:"systemName"}}),e("el-table-column",{attrs:{label:"表名","show-overflow-tooltip":"",align:"center",prop:"tableName"}}),t._v("\n                            >\n                        ")],1),e("div",{directives:[{name:"show",rawName:"v-show",value:3==t.middleValue,expression:"middleValue == 3"}]},[t.columnSortList?e("div",t._l(t.columnSortList,(function(a){return e("div",{directives:[{name:"dragging",rawName:"v-dragging",value:{item:a,list:t.columnSortList,group:"data"},expression:"{\n                                        item: item,\n                                        list: columnSortList,\n                                        group: 'data',\n                                    }"}],key:a.columnId,staticStyle:{border:"2px"}},[e("el-checkbox",{attrs:{label:a},on:{change:t.cancelSelect},model:{value:t.checkData,callback:function(e){t.checkData=e},expression:"checkData"}},[t._v("\n                                        "+t._s(a.columnName+(a.columnComment?"("+a.columnComment+")":""))+"\n                                    ")]),e("el-switch",{staticStyle:{float:"right"},attrs:{size:"mini","active-value":"asc","inactive-value":"desc","active-text":"升序","inactive-text":"降序"},on:{change:function(e){return t.switchChange(a)}},model:{value:a.sortType,callback:function(e){t.$set(a,"sortType",e)},expression:"item.sortType"}}),e("br"),e("br")],1)})),0):t._e()])],1)],1)],1)],e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cancel}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitData}},[t._v("确 定")])],1)],2):t._e()],1)}),[],!1,null,"097afd5b",null);e.default=f.exports},d131:function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,".cm-s-idea span.cm-meta{color:olive}.cm-s-idea span.cm-number{color:#00f}.cm-s-idea span.cm-keyword{line-height:1em;font-weight:700;color:navy}.cm-s-idea span.cm-atom{font-weight:700;color:navy}.cm-s-idea span.cm-def,.cm-s-idea span.cm-operator,.cm-s-idea span.cm-property,.cm-s-idea span.cm-type,.cm-s-idea span.cm-variable,.cm-s-idea span.cm-variable-2,.cm-s-idea span.cm-variable-3{color:#000}.cm-s-idea span.cm-comment{color:grey}.cm-s-idea span.cm-string,.cm-s-idea span.cm-string-2{color:green}.cm-s-idea span.cm-qualifier{color:#555}.cm-s-idea span.cm-error{color:red}.cm-s-idea span.cm-attribute{color:#00f}.cm-s-idea span.cm-tag{color:navy}.cm-s-idea span.cm-link{color:#00f}.cm-s-idea .CodeMirror-activeline-background{background:#fffae3}.cm-s-idea span.cm-builtin{color:#30a}.cm-s-idea span.cm-bracket{color:#cc7}.cm-s-idea{font-family:Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif}.cm-s-idea .CodeMirror-matchingbracket{outline:1px solid grey;color:#000!important}.CodeMirror-hints.idea{font-family:Menlo,Monaco,Consolas,Courier New,monospace;color:#616569;background-color:#ebf3fd!important}.CodeMirror-hints.idea .CodeMirror-hint-active{background-color:#a2b8c9!important;color:#5c6065!important}",""])},e68a:function(t,e,a){var o=a("2662");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals),(0,a("499e").default)("f422793a",o,!0,{sourceMap:!1,shadowMode:!1})},e762:function(t,e,a){"use strict";a.d(e,"b",(function(){return C})),a.d(e,"a",(function(){return R}));const o="function"==typeof Buffer,i="function"==typeof TextDecoder?new TextDecoder:void 0,s="function"==typeof TextEncoder?new TextEncoder:void 0,n=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),r=(t=>{let e={};return t.forEach((t,a)=>e[t]=a),e})(n),l=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,u=String.fromCharCode.bind(String),c="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),d=t=>t.replace(/=/g,"").replace(/[+\/]/g,t=>"+"==t?"-":"_"),m=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),p=t=>{let e,a,o,i,s="";const r=t.length%3;for(let l=0;l<t.length;){if((a=t.charCodeAt(l++))>255||(o=t.charCodeAt(l++))>255||(i=t.charCodeAt(l++))>255)throw new TypeError("invalid character found");e=a<<16|o<<8|i,s+=n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}return r?s.slice(0,r-3)+"===".substring(r):s},f="function"==typeof btoa?t=>btoa(t):o?t=>Buffer.from(t,"binary").toString("base64"):p,h=o?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let a=0,o=t.length;a<o;a+=4096)e.push(u.apply(null,t.subarray(a,a+4096)));return f(e.join(""))},b=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?u(192|e>>>6)+u(128|63&e):u(224|e>>>12&15)+u(128|e>>>6&63)+u(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return u(240|e>>>18&7)+u(128|e>>>12&63)+u(128|e>>>6&63)+u(128|63&e)},k=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,g=t=>t.replace(k,b),S=o?t=>Buffer.from(t,"utf8").toString("base64"):s?t=>h(s.encode(t)):t=>f(g(t)),C=(t,e=!1)=>e?d(S(t)):S(t),I=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,y=t=>{switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return u(55296+(e>>>10))+u(56320+(1023&e));case 3:return u((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return u((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},v=t=>t.replace(I,y),w=t=>{if(t=t.replace(/\s+/g,""),!l.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,a,o,i="";for(let s=0;s<t.length;)e=r[t.charAt(s++)]<<18|r[t.charAt(s++)]<<12|(a=r[t.charAt(s++)])<<6|(o=r[t.charAt(s++)]),i+=64===a?u(e>>16&255):64===o?u(e>>16&255,e>>8&255):u(e>>16&255,e>>8&255,255&e);return i},D="function"==typeof atob?t=>atob(m(t)):o?t=>Buffer.from(t,"base64").toString("binary"):w,T=o?t=>c(Buffer.from(t,"base64")):t=>c(D(t).split("").map(t=>t.charCodeAt(0))),x=o?t=>Buffer.from(t,"base64").toString("utf8"):i?t=>i.decode(T(t)):t=>v(D(t)),L=t=>m(t.replace(/[-_]/g,t=>"-"==t?"+":"/")),R=t=>x(L(t))},f029:function(t,e,a){"use strict";a.r(e),a("b866"),a("a7be"),a("f6b6");var o=a("56b3");a("8c33"),a("31c5"),a("ffda"),a("9b74"),a("991c");var i={data:function(){return{editor:null}},props:{value:{type:String,default:""},sqlStyle:{type:String,default:"default"},readOnly:{type:[Boolean,String]}},watch:{newVal:function(t,e){this.editor&&this.$emit("changeTextarea",this.editor.getValue())}},computed:{newVal:function(){if(this.editor)return this.editor.getValue()},isView:function(){return"view"===this.$route.query.filter}},mounted:function(){this.initCodeMirror()},methods:{initCodeMirror:function(){var t=this;this.editor=o.fromTextArea(this.$refs.mycode,{value:this.value,mode:"text/x-mariadb",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,cursorHeight:1,lineWrapping:!0,readOnly:this.isView,theme:"idea",autofocus:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},gutters:["myGutter","CodeMirror-linenumbers"],gutterWidth:40}),this.editor.on("inputRead",(function(){t.editor.showHint()}))},setVal:function(){this.editor&&(""===this.value?this.editor.setValue(""):this.editor.setValue(this.value))}}},s=(a("b04a"),a("2877")),n=Object(s.a)(i,(function(){var t=this,e=t._self._c;return e("div",[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"mycode",staticClass:"codesql",domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])}),[],!1,null,"1f45bdba",null);e.default=n.exports}}]);