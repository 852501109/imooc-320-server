(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-39bf0d4c"],{2616:function(t,e,l){var s=l("e229");s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals),(0,l("499e").default)("1bd6d032",s,!0,{sourceMap:!1,shadowMode:!1})},5660:function(t,e,l){"use strict";l.r(e),l("6762"),l("2fdb"),l("20d6"),l("ac6a"),l("5df3"),l("4f7f");var s={data:function(){return{dialogSync:!1,showTable:!1,dialogTitle:"",slot3Option:[{value:"1",label:"全表"},{value:"2",label:"test2"},{value:"3",label:"层级关系"},{value:"4",label:"test4"},{value:"5",label:"test5"},{value:"6",label:"test6"},{value:"7",label:"test7"},{value:"8",label:"test8"},{value:"9",label:"test9"},{value:"10",label:"test10"}],slot4Option1:[{value:"1",label:"test1"},{value:"2",label:"test2"},{value:"3",label:"test3"},{value:"4",label:"test4"},{value:"5",label:"test5"},{value:"6",label:"test6"},{value:"7",label:"test7"},{value:"8",label:"test8"},{value:"9",label:"test9"},{value:"10",label:"test10"}],slot4Option2:[{value:"1",label:"test1"},{value:"2",label:"test2"},{value:"3",label:"test3"},{value:"4",label:"test4"},{value:"5",label:"test5"},{value:"6",label:"test6"},{value:"7",label:"test7"},{value:"8",label:"test8"},{value:"9",label:"test9"},{value:"10",label:"test10"}],slot5Option:[{value:"1",label:"test1"},{value:"2",label:"test2"},{value:"3",label:"test3"},{value:"4",label:"test4"},{value:"5",label:"test5"},{value:"6",label:"test6"},{value:"7",label:"test7"},{value:"8",label:"test8"},{value:"9",label:"test9"},{value:"10",label:"test10"}],ruleForm:{slot1:1,slot2:"",slot3List:[{value:""}],slot4List:[{value1:"",value2:""}],slot5List:[{value:""}],slot6:[],slot7:"",slot8:"",slot9:""},slot6Computed:"",rules:{slot1:[{required:!0,message:"请选择",trigger:"change"}],slot2:[{required:!0,message:"请选择",trigger:"change"}],slot3:[{required:!0,validator:this.validateTjld,trigger:"change"}]},tableData:[{slot1:"",slot2:"",slot3:"",slot4:"",slot5:"",slot6:""}],dragContent:""}},methods:{dialogSyncClose:function(){this.dialogSync=!1},dragstart:function(t){var e=t.target.getAttribute("dragContent");this.dragContent=e},drop:function(t){this.slot6Computed=this.dragContent},radioCancelSelect:function(t,e){var l=this;"INPUT"!==t.target.tagName&&(this.ruleForm.slot1==e?this.$nextTick((function(){l.ruleForm.slot1=""})):this.$nextTick((function(){l.ruleForm.slot1=e})),this.changeSlot1())},showTableChange:function(){this.addTable(),this.showTable=!0},changeSlot1:function(){this.ruleForm.slot2="",this.ruleForm.slot3List=[{value:""}],this.ruleForm.slot4List=[{value1:"",value2:""}],this.ruleForm.slot5List=[{value:""}],this.ruleForm.slot6=[],this.slot6Computed=""},changeSlot2:function(t){this.slot6Computed="",this.ruleForm.slot2=t,this.ruleForm.slot3List=[{value:""}],this.ruleForm.slot4List=[{value1:"",value2:""}],this.ruleForm.slot5List=[{value:""}],this.ruleForm.slot6=[]},changeSlot3:function(t,e){this.ruleForm.slot4List=[{value1:"",value2:""}],this.ruleForm.slot5List=[{value:""}],this.ruleForm.slot6=[],this.slot6Computed="",this.ruleForm.slot3List[e].value=t},submitDialog:function(){var t=/^[a-zA-Z].*$/,e=this.tableData.map((function(t){return t.slot1})).some((function(t){return""==t})),l=this.tableData.length!==new Set(this.tableData.map((function(t){return t.slot1}))).size,s=this.tableData.map((function(t){return t.slot2})).some((function(t){return""==t})),o=this.tableData.length!==new Set(this.tableData.map((function(t){return t.slot2}))).size,a=this.tableData.map((function(t){return t.slot3})).some((function(t){return""==t})),r=this.tableData.map((function(t){return t.slot4})).some((function(t){return""==t})),n=this.tableData.map((function(t){return t.slot5})).some((function(t){return""==t})),i=this.tableData.map((function(t){return t.slot6})).some((function(t){return""==t})),u=this.tableData.map((function(t){return t.slot2})).some((function(e){return!t.test(e)}));e?this.$message.warning("复合指标配置不可为空"):s?this.$message.warning("复合指标英文名不可为空"):a?this.$message.warning("关联配置不可为空"):r?this.$message.warning("间隔参数不可为空"):n?this.$message.warning("间隔单位不可为空"):i?this.$message.warning("计算方式不可为空"):u?this.$message.warning("复合指标英文必须以英文开头"):l?this.$message.warning("复合指标名不可重复"):o?this.$message.warning("复合指标英文名不可重复"):(this.ruleForm.slot6=this.tableData,this.slot6Computed=this.ruleForm.slot6.map((function(t){return t.slot1})).join(";"),this.dialogSyncClose())},tjzqDisable:function(t){return this.ruleForm.slot4List.map((function(t){return t.value1})).includes(t.value)},ywxdDisable:function(t){return this.ruleForm.slot5List.map((function(t){return t.value})).includes(t.value)},slot3ListHasSelect:function(t,e){var l=this.ruleForm.slot3List.findIndex((function(e){return""!==e.value&&"1"!=e.value&&"3"!=e.value&&("1"==t.value||"3"==t.value)}));return this.ruleForm.slot3List.map((function(t){return t.value})).includes(t.value)||-1!==l&&l<e},validateTjld:function(t,e,l){this.ruleForm.slot3List.some((function(t){return""===t.value}))?l(new Error("统计粒度必选")):l()},delSlot3List:function(t){var e=this.ruleForm.slot3List[t].value;this.ruleForm.slot6.map((function(t){return t.slot3})).some((function(t){return t.includes(e)}))?this.$message.warning("该统计粒度已被复合指标使用, 如若想继续删除, 请先取消使用"):this.ruleForm.slot3List.splice(t,1)},delSlot4List:function(t){this.ruleForm.slot4List.splice(t,1)},delSlot5List:function(t){this.ruleForm.slot5List.splice(t,1)},add:function(t){1===this.ruleForm.slot3List.length&&this.ruleForm.slot3List.some((function(t){return""===t.value}))?this.$message({message:"请先配置统计粒度",type:"warning"}):this.ruleForm.slot3List.some((function(t){return"1"===t.value}))?this.$message({message:"有统计粒度为全表时, 不能配置复合指标",type:"warning"}):this.ruleForm.slot3List.some((function(t){return"3"===t.value}))?this.$message({message:"有统计粒度为层级维度时, 不能配置复合指标",type:"warning"}):(this.tableData=JSON.parse(JSON.stringify(this.ruleForm.slot6)),0===this.tableData.length?this.showTable=!1:this.showTable=!0,this.dialogSync=!0,this.dialogTitle=t)},delTable:function(t){this.tableData.splice(t,1),0===t&&0===this.tableData.length&&(this.showTable=!1)},addTable:function(){this.tableData.push({slot1:"",slot2:"",slot3:"",slot4:"",slot5:"",slot6:""})},addSlot3:function(t){this.ruleForm.slot3List.some((function(t){return""===t.value}))?this.$message({message:"请先选好现有的统计粒度",type:"warning"}):this.ruleForm.slot3List.some((function(t){return"1"===t.value||"3"===t.value}))?this.$message({message:'统计粒度包含"全表"或"层级维度"的情况, 只能使用一个统计粒度',type:"warning"}):this.ruleForm[t].push({value:""})},addSlot4:function(t){this.ruleForm.slot4List.length>0&&this.ruleForm.slot6.length>0?this.$message({message:"已配置复合指标, 统计周期数量不能超过一条",type:"warning"}):this.ruleForm.slot4List.some((function(t){return""===t.value1||""===t.value2}))?this.$message({message:"请先填好现有的统计周期",type:"warning"}):this.ruleForm[t].push({value1:"",value2:""})},addSlot5:function(t){this.ruleForm.slot5List.some((function(t){return""===t.value}))?this.$message({message:"业务限定不能为空",type:"warning"}):this.ruleForm[t].push({value:""})},submitForm:function(){var t=this;return new Promise((function(e,l){t.$refs.ruleForm.validate((function(s){s?e(t.ruleForm):l("error")}))}))},resetForm:function(){this.$refs.ruleForm.resetFields()}}},o=(l("9f37"),l("2877")),a=Object(o.a)(s,(function(){var t=this,e=t._self._c;return e("div",[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"140px",disabled:"view"===t.$route.query.filter}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"指标类型",prop:"slot1"}},[e("el-radio",{attrs:{label:1},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.radioCancelSelect(e,1)}},model:{value:t.ruleForm.slot1,callback:function(e){t.$set(t.ruleForm,"slot1",e)},expression:"ruleForm.slot1"}},[t._v("原子指标")]),e("el-radio",{attrs:{label:2},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.radioCancelSelect(e,2)}},model:{value:t.ruleForm.slot1,callback:function(e){t.$set(t.ruleForm,"slot1",e)},expression:"ruleForm.slot1"}},[t._v("衍生指标")])],1),e("el-form-item",{attrs:{label:"选择指标",prop:"slot2"}},[e("div",[e("el-select",{attrs:{value:t.ruleForm.slot2,placeholder:"请选择"},on:{change:t.changeSlot2}},t._l(t.slot3Option,(function(t,l){return e("el-option",{key:l,attrs:{label:t.lavel,value:t.value}})})),1)],1)]),e("el-form-item",{attrs:{label:"统计粒度",prop:"slot3"}},[t._l(t.ruleForm.slot3List,(function(l,s){return e("div",{key:s,staticClass:"row"},[e("el-select",{attrs:{value:l.value,placeholder:"请选择"},on:{change:function(e){return t.changeSlot3(e,s)}}},t._l(t.slot3Option,(function(l,o){return e("el-option",{key:o,attrs:{label:l.label,value:l.value,disabled:t.slot3ListHasSelect(l,s)}})})),1),t.ruleForm.slot3List.length>1?e("el-button",{on:{click:function(e){return t.delSlot3List(s)}}},[t._v("删除")]):t._e()],1)})),3!==t.ruleForm.slot3List.length?e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addSlot3("slot3List")}}},[t._v("新增统计粒度")]):t._e()],2),e("el-form-item",{attrs:{label:"统计周期",prop:"slot4"}},[t._l(t.ruleForm.slot4List,(function(l,s){return e("div",{key:s,staticClass:"row tjzq"},[e("div",[e("el-select",{attrs:{placeholder:"请选择"},model:{value:l.value1,callback:function(e){t.$set(l,"value1",e)},expression:"i.value1"}},t._l(t.slot4Option1,(function(l,s){return e("el-option",{key:s,attrs:{label:l.label,value:l.value,disabled:t.tjzqDisable(l)}})})),1)],1),e("div",[e("el-select",{attrs:{placeholder:"请选择"},model:{value:l.value2,callback:function(e){t.$set(l,"value2",e)},expression:"i.value2"}},t._l(t.slot4Option2,(function(t,l){return e("el-option",{key:l,attrs:{label:t.label,value:t.value}})})),1)],1),t.ruleForm.slot4List.length>1?e("el-button",{on:{click:function(e){return t.delSlot4List(s)}}},[t._v("删除")]):t._e()],1)})),3!==t.ruleForm.slot4List.length&&0===this.ruleForm.slot6.length?e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addSlot4("slot4List")}}},[t._v("新增统计周期")]):t._e()],2),e("el-form-item",{attrs:{label:"业务限定",prop:"slot5"}},[t._l(t.ruleForm.slot5List,(function(l,s){return e("div",{key:s,staticClass:"row"},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:l.value,callback:function(e){t.$set(l,"value",e)},expression:"i.value"}},t._l(t.slot5Option,(function(l,s){return e("el-option",{key:s,attrs:{label:l.label,value:l.value,disabled:t.ywxdDisable(l)}})})),1),t.ruleForm.slot5List.length>1?e("el-button",{on:{click:function(e){return t.delSlot5List(s)}}},[t._v("删除")]):t._e()],1)})),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addSlot5("slot5List")}}},[t._v("新增业务限定")])],2)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"所属部门",prop:"slot7"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.ruleForm.slot7,callback:function(e){t.$set(t.ruleForm,"slot7",e)},expression:"ruleForm.slot7"}},[e("el-option",{attrs:{label:"test1",value:"test1"}}),e("el-option",{attrs:{label:"test2",value:"test2"}})],1)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"来源依据",prop:"slot8",placeholder:"请输入"}},[e("el-input",{model:{value:t.ruleForm.slot8,callback:function(e){t.$set(t.ruleForm,"slot8",e)},expression:"ruleForm.slot8"}})],1)],1),e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"描述",placeholder:"请输入"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.slot9,callback:function(e){t.$set(t.ruleForm,"slot9",e)},expression:"ruleForm.slot9"}})],1)],1)],1)],1),e("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogSync,width:"70%","before-close":t.dialogSyncClose},on:{"update:visible":function(e){t.dialogSync=e}}},[t.showTable?e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"slot1",label:"复合指标配置"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-input",{attrs:{placeholder:"请输入"},model:{value:l.row.slot1,callback:function(e){t.$set(l.row,"slot1",e)},expression:"scope.row.slot1"}})]}}],null,!1,1602373780)}),e("el-table-column",{attrs:{prop:"slot2",label:"复合指标英文名"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-input",{attrs:{placeholder:"请输入"},model:{value:l.row.slot2,callback:function(e){t.$set(l.row,"slot2",e)},expression:"scope.row.slot2"}})]}}],null,!1,3076198135)}),e("el-table-column",{attrs:{prop:"slot3",label:"关联配置"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-select",{attrs:{placeholder:"请选择",multiple:""},model:{value:l.row.slot3,callback:function(e){t.$set(l.row,"slot3",e)},expression:"scope.row.slot3"}},t._l(t.slot3Option.filter((function(e){return t.ruleForm.slot3List.map((function(t){return t.value})).includes(e.value)})),(function(t,l){return e("el-option",{key:l,attrs:{label:t.label,value:t.value}})})),1)]}}],null,!1,854594358)}),e("el-table-column",{attrs:{prop:"slot4",label:"间隔参数"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-input",{attrs:{placeholder:"请输入"},model:{value:l.row.slot4,callback:function(e){t.$set(l.row,"slot4",e)},expression:"scope.row.slot4"}})]}}],null,!1,1264271921)}),e("el-table-column",{attrs:{prop:"slot5",label:"间隔单位"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-select",{attrs:{placeholder:"请选择"},model:{value:l.row.slot5,callback:function(e){t.$set(l.row,"slot5",e)},expression:"scope.row.slot5"}},[e("el-option",{attrs:{label:"周",value:"1"}}),e("el-option",{attrs:{label:"月",value:"2"}}),e("el-option",{attrs:{label:"季",value:"3"}}),e("el-option",{attrs:{label:"年",value:"4"}})],1)]}}],null,!1,2741409200)}),e("el-table-column",{attrs:{prop:"slot6",label:"计算方式"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-select",{attrs:{placeholder:"请选择"},model:{value:l.row.slot6,callback:function(e){t.$set(l.row,"slot6",e)},expression:"scope.row.slot6"}},[e("el-option",{attrs:{label:"数量",value:"1"}}),e("el-option",{attrs:{label:"百分比",value:"2"}})],1)]}}],null,!1,2772516848)}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("div",{staticClass:"operator"},[e("span",{on:{click:function(e){return t.delTable(l.$index)}}},[t._v("删除")]),t._v("    \n                        "),l.$index===t.tableData.length-1?e("span",{on:{click:t.addTable}},[t._v("添加")]):t._e()])]}}],null,!1,2495041215)})],1):t._e(),t.showTable?t._e():e("el-button",{attrs:{type:"primary"},on:{click:t.showTableChange}},[t._v("添加")]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogSync=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitDialog}},[t._v("确 定")])],1)],1)],1)}),[],!1,null,"7493a81e",null);e.default=a.exports},"9f37":function(t,e,l){"use strict";l("2616")},e229:function(t,e,l){(t.exports=l("2350")(!1)).push([t.i,".row[data-v-7493a81e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:10px}.tjzq[data-v-7493a81e]{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.tjzq>div[data-v-7493a81e]{width:49.8%}.fhzb[data-v-7493a81e]{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fhzb>div[data-v-7493a81e]:first-child{width:calc(100% - 150px)}.fhzb>div[data-v-7493a81e]:nth-child(2){width:125px}.operator span[data-v-7493a81e]{cursor:pointer;color:#137cf5}",""])}}]);