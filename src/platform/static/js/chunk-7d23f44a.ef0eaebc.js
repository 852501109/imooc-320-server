(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7d23f44a"],{"4c4a":function(e,t,a){"use strict";a.r(t),a("7f7f"),a("386d"),a("8e6e"),a("456d"),a("ac6a");var o=a("ade3"),i=a("2f62"),n=a("365c");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(o.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={data:function(){return{isSearch:!1,param:{name:null,page:1,rows:10},tableList:{tableList:[],total:0},activityName:0,titles:["待我审批","已审批"],idVisibleDialog:!1,imageDataSrc:"",imageDataSuccess:!0,activeProcDefId:null,ruleForm:{},suspendedObj:{null:"-",1:"运行中",2:"暂停"}}},created:function(){this.loadData()},components:{nodeConfigPublic:a("18d6").default},methods:r(r({},Object(i.b)(["_AJAX"])),{},{loadData:function(){var e=this;if(0===this.activityName){var t=Object.assign({},this.param);t.categoryId=3,this._AJAX({url:"activiti.task.list",method:"POST",data:t}).then((function(t){0==t.code&&(e.tableList=t.result)}))}else this._AJAX({url:"activiti.task.done",method:"POST",data:this.param}).then((function(t){0==t.code&&(e.tableList=t.result)}))},changeTableList:function(e){this.param.page=1,this.param.rows=10,this.activityName=e,this.loadData()},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.loadData()},handleCurrentChange:function(e){this.param.page=e,this.loadData()},search:function(e){var t=this;this.param.page=1,0==e&&this.publics.resetFun(this.param,(function(){t.param.rows=10})),this.loadData()},changeStatus:function(e){var t=this,a=1==e.isSuspended?0:1;this._AJAX({url:"activiti.process.instance.status",method:"POST",data:{procInsId:e.procInstId,status:a}}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:0===a?"激活成功":"挂起成功",methods:{okEvent:function(){t.loadData()}}})}))},del:function(e){},view:function(e){var t=this;this.activeProcDefId=null,this._AJAX({url:"activiti.process.select.id",method:"GET",data:{bizCode:e.businessKey}}).then((function(e){var a=e.result?e.result:{};t.ruleForm=a,t.activeProcDefId=a.procDefId;var o=n.default["activiti.models.img"]+"?procDefId="+a.procDefId+"&t="+Date.now();t.imageDataSrc=o,t.idVisibleDialog=!0}))},preview:function(e){this.$AudaqueToast.dialog({title:"流程图",className:"",width:"60%",data:{imageDataSrc:"",imageDataSuccess:!0,imageDataError:"",hideCancel_a_d_q:!0,okBtnName:"确定"},mounted:function(){var t=n.default["activiti.models.img"]+"?procInstId="+e.procInstId+"&t="+Date.now();this.imageDataSrc=t},template:'\n                                 <div style="text-align:center">\n                                <img style="min-height:280px" class="content-image" :src="imageDataSrc" v-show="imageDataSuccess"/>\n                                <span v-show="!imageDataSuccess">{{ imageDataError }}</span>\n                            </div>\n\n                            ',methods:{okEvent:function(){}}})},by:function(e){var t=this;this.$AudaqueToast.dialog({title:"通过",align:"left",className:"",width:"650px",data:{ruleForm:{users:"",comment:""},rules:{comment:[{trigger:"blur",required:!0,message:"请输入审核意见"}]},byList:[],isShowSh:!0},showFooter:!1,mounted:function(){var a=this;t._AJAX({url:"activiti.process.node.next",method:"POST",data:{procDefId:e.procDefId,procInstId:e.procInstId,currActId:e.key}}).then((function(e){0==e.code&&(2===e.result.type||4===e.result.type?a.isShowSh=!1:a.isShowSh=!0,e.result.users&&e.result.users.length>0?(a.byList=e.result.users,e.result.users.forEach((function(e){a.ruleForm.users.push(e.id)}))):(a.byList=[],a.$set(a.ruleForm,"users",[])))})).catch((function(){}))},template:'\n                            <el-form :model="ruleForm" :rules="rules" ref="ruleForm" label-position="top" label-width="80px">\n                                <el-form-item label="审核人" prop="users" v-if="isShowSh">\n                                  <el-select v-model="ruleForm.users" placeholder="请选择" filterable multiple >\n                                    <el-option :label="item.account" :value="item.id" v-for="item in byList"\n                                               :key="item.id">\n                                    </el-option>\n                                </el-select>\n                                </el-form-item>\n                                <el-form-item label="审核意见" prop="comment">\n                                  <el-input\n                                    class="news-type-sys-introduction"\n                                    type="textarea"\n                                    autosize\n                                    placeholder=""\n                                    maxlength="100"\n                                    show-word-limit\n                                    v-model.trim="ruleForm.comment">\n                                    </el-input>\n                              </el-form-item>\n                            </el-form>\n                            <div name="footer" class="dialog-footer" style="text-align: right;">\n                            <el-button v-if="!hideCancel_a_d_q" @click.stop="cancelEvent_a_d_q">取 消</el-button>\n                            <el-button type="primary"  class="confirm"  @click.stop="okEvent_a_d_q" ><i class="el-icon-loading"></i>通过</el-button>\n                            <el-button type="primary"  class="confirm"  @click.stop="turnDown" ><i class="el-icon-loading"></i>驳回发起人</el-button>\n                        </div>\n                        ',methods:{turnDown:function(){var a=this,o=this;this.$refs.ruleForm.validate((function(i){if(!i)return!1;t._AJAX({url:"activiti.task.reject",method:"POST",data:{id:e.id,comment:a.ruleForm.comment,pass:!0}}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){o.cancelEvent_a_d_q(),t.loadData()}}})})).catch((function(){}))}))},okEvent:function(){var a=this,o=!1;return this.$refs.ruleForm.validate((function(i){if(!i)return o=!0,!1;t._AJAX({url:"activiti.task.submit",method:"POST",data:{id:e.id,comment:a.ruleForm.comment,pass:!0}}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){t.loadData()}}})})).catch((function(){}))})),o},cancelEvent:function(){}}})},versionDeploy:function(e){var t=this;this.$AudaqueToast.dialog({title:"版本部署",align:"left",className:"",width:"650px",data:{ruleForm:{version:[{index:1,account:""}]},rules:{version:[{trigger:"change",required:!0,message:"请选择版本号"}]},versionList:[{value:"1.0.0",label:"1.0.0"},{value:"2.0.0",label:"2.0.0"}]},mounted:function(){},template:'\n                            <el-form :model="ruleForm" :rules="rules" ref="ruleForm" label-position="top" label-width="80px">\n                                <el-form-item label="流程版本" prop="version">\n                                  <el-select v-model="ruleForm.version" placeholder="请选择">\n                                    <el-option :label="item.label" :value="item.value" v-for="item in versionList"\n                                               :key="item.value">\n                                    </el-option>\n                                </el-select>\n                              </el-form-item>\n                              <el-form-item label=" ">\n                                    <div style="text-align: left;line-height: 22px;">提示：已审批通过的流程，更换流程版本，需再次提交进行审批，待审批通过，更换了新流程版本的流程才可发布使用。</div>\n                              </el-form-item>\n                            </el-form>\n                        ',methods:{okEvent:function(){var e=!1;return this.$refs.ruleForm.validate((function(a){if(!a)return e=!0,!1;t._AJAX({url:"org.setMyDeptManager",method:"POST",data:{}}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"部署成功",methods:{okEvent:function(){}}})})).catch((function(){}))})),e},cancelEvent:function(){}}})}})},c=(a("9c20"),a("2877")),u=Object(c.a)(s,(function(){var e=this,t=e._self._c;return t("audaque-table-list-page",[t("template",{slot:"title"},[t("audaque-table-title",{attrs:{titles:e.titles,index:e.activityName},on:{change:e.changeTableList}},[t("i",{staticClass:"iconfont iconshaixuan audaque-rect-icon",on:{click:function(t){e.isSearch=!e.isSearch}}},[e._v("筛选 ")])])],1),t("template",{slot:"search"},[t("audaque-table-search",{directives:[{name:"show",rawName:"v-show",value:e.isSearch,expression:"isSearch"}],on:{close:function(t){e.isSearch=!1},search:function(t){return e.search(1)},reset:function(t){return e.search(0)}}},[t("audaque-table-search-item",{attrs:{title:"流程名称"}},[t("el-input",{staticClass:"autoSize f14",model:{value:e.param.name,callback:function(t){e.$set(e.param,"name","string"==typeof t?t.trim():t)},expression:"param.name"}})],1)],1)],1),[t("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.tableList.rows,border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},width:"50"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"categoryName",label:"业务"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"processName",label:"业务名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"title",label:"申请标题"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"owner",label:"发起人"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"deptnames",label:"发起人所属组织"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"startTime",label:"发起时间"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(a){return[3===a.row.categoryId?t("span",{staticClass:"iconfont iconchakan11 operate",attrs:{title:"查看"},on:{click:function(t){return e.view(a.row)}}}):e._e(),t("span",{staticClass:"iconfont iconxianshi operate",attrs:{title:"预览"},on:{click:function(t){return e.preview(a.row)}}}),0===e.activityName?t("span",{staticClass:"iconfont iconjianyishupc-icon1024_shenhe operate",attrs:{title:"审核"},on:{click:function(t){return e.by(a.row)}}}):e._e()]}}])}),t("template",{slot:"empty"},[t("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.loadData()}}})],1)],2),t("adq-pagination",{attrs:{"current-page":e.param.page,"page-size":e.param.rows,total:e.tableList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],t("el-dialog",{staticClass:"data-permission",attrs:{title:"查看",visible:e.idVisibleDialog,width:"1000","close-on-click-modal":!1},on:{"update:visible":function(t){e.idVisibleDialog=t}}},[t("el-form",{attrs:{"label-width":"80px",model:e.ruleForm,disabled:""}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"流程名称"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"==typeof t?t.trim():t)},expression:"ruleForm.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"业务标识"}},[t("el-input",{model:{value:e.ruleForm.bizCode,callback:function(t){e.$set(e.ruleForm,"bizCode","string"==typeof t?t.trim():t)},expression:"ruleForm.bizCode"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"类型名称"}},[t("el-input",{model:{value:e.ruleForm.categoryName,callback:function(t){e.$set(e.ruleForm,"categoryName","string"==typeof t?t.trim():t)},expression:"ruleForm.categoryName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description","string"==typeof t?t.trim():t)},expression:"ruleForm.description"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"可见范围"}},[t("el-input",{model:{value:e.ruleForm.depName,callback:function(t){e.$set(e.ruleForm,"depName","string"==typeof t?t.trim():t)},expression:"ruleForm.depName"}})],1)],1)],1)],1),e.idVisibleDialog?t("node-config-public",{attrs:{"opt-type":"view",procDefId:e.activeProcDefId}}):e._e(),t("div",{staticStyle:{"text-align":"center"}},[t("img",{directives:[{name:"show",rawName:"v-show",value:e.imageDataSuccess,expression:"imageDataSuccess"}],staticClass:"content-image",staticStyle:{height:"250px"},attrs:{src:e.imageDataSrc}})]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.idVisibleDialog=!1}}},[e._v("确 定")])],1)],1)],2)}),[],!1,null,"3baec2c4",null);t.default=u.exports},"9c20":function(e,t,a){"use strict";a("e8f0")},c8e8:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,'[data-v-3baec2c4] .audaque-table-title__title-active{position:relative;margin-right:35px}[data-v-3baec2c4] .audaque-table-title__title-active:before{content:"";width:100%;height:2px;background:#5394eb;position:absolute;bottom:-12px}.operate[data-v-3baec2c4]{cursor:pointer}',""])},e8f0:function(e,t,a){var o=a("c8e8");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,a("499e").default)("4b127ffc",o,!0,{sourceMap:!1,shadowMode:!1})}}]);