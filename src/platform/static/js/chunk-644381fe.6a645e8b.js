(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-644381fe","chunk-3d40b6aa"],{1201:function(e,t,r){var a=r("4af7");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,r("499e").default)("b8fd6b3a",a,!0,{sourceMap:!1,shadowMode:!1})},2362:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".row[data-v-1460e294]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row>div[data-v-1460e294]:first-child{margin-right:10px}[data-v-1460e294] .el-dialog__body{max-height:100%!important}[data-v-1460e294] .pane-comp,[data-v-1460e294] .tree-dashed{overflow:auto}.expand[data-v-1460e294]{width:100%}.expand[data-v-1460e294] .cell{text-align:center}.el-icon-download[data-v-1460e294]{color:#409eff;font-size:18px;cursor:pointer}.cell[data-v-1460e294],[data-v-1460e294].cell,[data-v-1460e294] .cell{line-height:100%!important}",""])},"4af7":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".row[data-v-cc4353ba]{width:42%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.table_box[data-v-cc4353ba]{width:100%;overflow-x:auto}[data-v-cc4353ba] .el-date-editor.el-input,[data-v-cc4353ba] .el-date-editor.el-input__inner,[data-v-cc4353ba] .el-range-editor--medium.el-input__inner{width:100%}",""])},5058:function(e,t,r){"use strict";r.r(t),r("8e6e"),r("ac6a"),r("456d"),r("7514");var a=r("ade3"),o=(r("c5f6"),r("2f62"));function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var n={props:{show:{type:Boolean,default:!1},resourceId:{type:Number,default:null},type:{type:String,default:"1"},templateId:{type:String,default:""}},data:function(){return{selectId:"",tableLoading:!1}},components:{},computed:i({},Object(o.d)("dataReporting",["templateTableList"])),created:function(){this.selectId=Number(this.templateId),this.GET_TEMPLATE_TABLE_LIST({reourceId:this.resourceId})},mounted:function(){},methods:i(i(i({},Object(o.b)(["_AJAX"])),Object(o.b)("dataReporting",["GET_TEMPLATE_TABLE_LIST"])),{},{downLoad:function(e){var t=this;this.tableLoading=!0,this.publics.exportFilePromise(this,"/gdrsTemplate/exportExcelTemplate.do",{resourceId:e.reourceId,templateId:e.id}).then((function(){t.tableLoading=!1})).catch((function(){t.tableLoading=!1}))},sure:function(){var e=this;if(""!==this.selectId){var t=this.templateTableList.find((function(t){return t.id==e.selectId}));this.$emit("sure",t)}else this.$message.warning("请选择模板后确定")},cancel:function(){this.$emit("cancel")}})},s=(r("724c"),r("2877")),c=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"模版下载",visible:e.show,width:"60%","append-to-body":"","before-close":e.cancel},on:{"update:visible":function(t){e.show=t},close:e.cancel}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"custom-container",staticStyle:{"min-height":"60vh"},attrs:{"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.5)"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.templateTableList}},[1!=e.type?t("el-table-column",{attrs:{align:"center",width:"30",label:"","cell-class-name":"custom_radio_class_name"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-radio-group",{model:{value:e.selectId,callback:function(t){e.selectId=t},expression:"selectId"}},[t("el-radio",{staticClass:"radio",attrs:{label:r.row.id}})],1)]}}],null,!1,528259780)}):e._e(),t("el-table-column",{attrs:{type:"expand",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticClass:"expand"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.row.columnList}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"300"}}),t("el-table-column",{attrs:{prop:"name",label:"中文描述",align:"center"}}),t("el-table-column",{attrs:{prop:"code",label:"对应字段",align:"center"}})],1)],1)]}}])}),t("el-table-column",{attrs:{type:"index",label:"序号"}}),t("el-table-column",{attrs:{label:"模版名称",prop:"templateName"}}),t("el-table-column",{attrs:{label:"默认模版",prop:"isDefaultTemplate"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(1==t.row.isDefaultTemplate?"是":"否")+"\n                ")]}}])}),2!=e.type?t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("i",{staticClass:"el-icon-download",on:{click:function(t){return e.downLoad(r.row)}}})]}}],null,!1,2971859013)}):e._e()],1)],1),1!=e.type?t("div",{staticClass:"dialog-footer row",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.sure}},[e._v("确定")])],1)]):e._e()])}),[],!1,null,"1460e294",null);t.default=c.exports},"724c":function(e,t,r){"use strict";r("df8b")},8022:function(e,t,r){"use strict";r("1201")},aa04:function(e,t,r){"use strict";r.r(t),r("7f7f"),r("8e6e"),r("456d"),r("a481"),r("5df3"),r("4f7f"),r("ac6a"),r("96cf");var a=r("1da1"),o=(r("6b54"),r("ade3")),l=r("2f62");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s,c={name:"",data:function(){return{isShowSelectModal:!1,menuList:[],checkData:[],form:{recordType:2,resourceName:"",resourceId:"",templateId:"",templateName:"",userId:"",fileId:"",fileName:"",reportDepartment:"",reportTimeType:"",reportTimeIndex:"",reportTimeYear:"",reportTimes:[],reportRemark:""},dataReportParamList:[],rules:{userId:[{required:!0,message:"上报人不能为空",trigger:"change"}],templateName:[{required:!0,message:"上报模板不能为空",trigger:"change"}],fileName:[{required:!0,message:"上报数据不能为空",trigger:"change"}],reportDepartment:[{required:!0,message:"上报部门不能为空",trigger:"change"}],reportTimeType:[{required:!0,message:"期别不能为空",trigger:"change"}],reportTimeIndex:[{required:!0,message:"月度不能为空",trigger:"change"}],reportTimeYear:[{required:!0,message:"年不能为空",trigger:"change"}],reportTimes:[{required:!0,message:"日期不能为空",trigger:"change"}]},operateName:"",publicKey:"",optId:this.$route.query.id,optType:this.$route.query.optType,userMaxLength:window.accountMaxLength,dialogTableVisible:!1,currentType:"",search:"",tableDialogType:"",queryTableListTemp:[],selectRow:{},hoverMenu:[{cdbh:1,cdmc:"第一个"},{cdbh:2,cdmc:"第二个"},{cdbh:3,cdmc:"第三个"}]}},components:{loadModal:r("5058").default},watch:{},computed:n(n({},Object(l.d)("dataReporting",["dataReportingEdit","deptList","userList","userIdOrDeptId","periodList","headList"])),{},{percent:function(){var e=(3+this.headList.length)/this.headList.length;return document.documentElement.clientWidth/1422*e}}),mounted:function(){},created:function(){var e=this;this.GETRESOURCEID({sourceId:this.optId}).then((function(){e.form.resourceName=e.dataReportingEdit.resourceName,e.form.resourceId=e.optId})),this.GETDEPTLIST(),this.GETUSERLIST(),this.GETPERIODLIST(),this.GETUSERIDORDEPTID().then((function(){e.form.userId=e.userIdOrDeptId.userId||"",e.form.reportDepartment=e.userIdOrDeptId.deptId||""})),this.GETHEADLIST({resourecId:this.optId}).then((function(e){}))},methods:n(n(n({},Object(l.b)("dataReporting",["GETDEPTLIST","GETUSERLIST","GETUSERIDORDEPTID","GETPERIODLIST","GETHEADLIST","GETRESOURCEID","INSERT_DATA_REPORT"])),Object(l.b)(["_AJAX"])),{},{loadModalSure:function(e){this.selectRow=e,this.form.templateId=e.id,this.form.templateName=e.templateName,this.isShowSelectModal=!1},cancelSelect:function(){},changeReportTimeType:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth();if("1"==this.form.reportTimeType){if(r>0)this.form.reportTimeYear=t.toString(),this.form.reportTimeIndex=r.toString();else{var a=t-1;this.form.reportTimeYear=a.toString(),this.form.reportTimeIndex=String(12)}this.form.reportTimes=[]}if("2"==this.form.reportTimeType){var o=Math.floor(r/3);if(o>0)this.form.reportTimeYear=t.toString(),this.form.reportTimeIndex=o.toString();else{var l=t-1;this.form.reportTimeYear=l.toString(),this.form.reportTimeIndex=String(4)}this.form.reportTimes=[]}if("3"==this.form.reportTimeType){var i=t-1;this.form.reportTimeYear=i.toString(),this.form.reportTimeIndex="",this.form.reportTimes=[]}if("4"==this.form.reportTimeType){this.form.reportTimeYear="",this.form.reportTimeIndex="";var n=new Date(e);n.setDate(n.getDate()-1);var s=new Date(e);s.setDate(s.getDate()-8),this.form.reportTimes[0]=s,this.form.reportTimes[1]=n}},importToExcel:(s=Object(a.a)(regeneratorRuntime.mark((function e(t){var r,a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:if(a=new FormData,!(r.size>20971520)){e.next=8;break}return this.$message.error("请上传20M以下文件"),this.$refs.addFile.value="",e.abrupt("return");case 8:a.append("file",r),a.append("resourceId",this.optId),this._AJAX({url:"dataReporting.upload",data:a,method:"POST"}).then((function(e){o.$refs.addFile.value="",o.form.fileName=e.result.fileName,o.form.fileId=e.result.id,o.$message.success("上传成功")})).catch((function(){o.$refs.addFile.value=""}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)}),selectModal:function(){this.isShowSelectModal=!0},subBtn:function(){var e=this;this.$refs.ruleform.validate((function(t){if(t){var r,a;if(e.$store.commit("dataReporting/CHANGELOADING",!0),e.dataReportParamList.forEach((function(t){e.headList.forEach((function(e){0==e.nullAble&&""===t[e.code]&&(r||(r=e.name||e.code))}))})),r)return void e.$message.warning("".concat(r,"字段不可为空"));if(e.headList.filter((function(e){return 1==e.primaryKey})).forEach((function(t){var r=e.dataReportParamList.map((function(e){return e[t.code]}));new Set(r).size===r.length||a||(a=t.name||t.code)})),a)return void e.$message.warning("".concat(a,"为主键不可重复"));var o=e.deepClone(e.form);o.reportTimes.length>0&&(o.reportStartTime=o.reportTimes[0],o.reportEndTime=o.reportTimes[1]),e.INSERT_DATA_REPORT(o).then((function(){e.$message({message:"数据导入成功",type:"success",showClose:!0}),e.$store.commit("dataReporting/CHANGELOADING",!1),e.$router.go(-1)})).finally((function(){e.$store.commit("dataReporting/CHANGELOADING",!1)}))}}))},deepClone:function(e){return JSON.parse(JSON.stringify(e))},addDataReportParamLis:function(){var e={};this.headList.forEach((function(t){e[t.code]=""})),this.dataReportParamList.push(e)},removeDataReportParamList:function(e){this.dataReportParamList.splice(e,1)},handleInput:function(e){e.fieldWidth=e.fieldWidth.replace(/\D/g,"")}})},p=(r("8022"),r("2877")),d=Object(p.a)(c,(function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"ruleform",staticClass:"form-item",attrs:{model:e.form,"label-width":"120px",rules:e.rules,disabled:"view"===e.optType}},[t("el-form-item",{attrs:{label:"资源名称",prop:"resourceName"}},[t("el-input",{attrs:{disabled:"",placeholder:"请输入","show-word-limit":""},model:{value:e.form.resourceName,callback:function(t){e.$set(e.form,"resourceName","string"==typeof t?t.trim():t)},expression:"form.resourceName"}})],1),t("el-form-item",{attrs:{label:"上报人",prop:"userId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}},e._l(e.userList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"上报部门",prop:"reportDepartment"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportDepartment,callback:function(t){e.$set(e.form,"reportDepartment",t)},expression:"form.reportDepartment"}},e._l(e.deptList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"期别",prop:"reportTimeType","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeReportTimeType},model:{value:e.form.reportTimeType,callback:function(t){e.$set(e.form,"reportTimeType",t)},expression:"form.reportTimeType"}},e._l(e.periodList,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),"1"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeIndex","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportTimeIndex,callback:function(t){e.$set(e.form,"reportTimeIndex",t)},expression:"form.reportTimeIndex"}},[t("el-option",{attrs:{label:"1月",value:"1"}}),t("el-option",{attrs:{label:"2月",value:"2"}}),t("el-option",{attrs:{label:"3月",value:"3"}}),t("el-option",{attrs:{label:"4月",value:"4"}}),t("el-option",{attrs:{label:"5月",value:"5"}}),t("el-option",{attrs:{label:"6月",value:"6"}}),t("el-option",{attrs:{label:"7月",value:"7"}}),t("el-option",{attrs:{label:"8月",value:"8"}}),t("el-option",{attrs:{label:"9月",value:"9"}}),t("el-option",{attrs:{label:"10月",value:"10"}}),t("el-option",{attrs:{label:"11月",value:"11"}}),t("el-option",{attrs:{label:"12月",value:"12"}})],1)],1)],1)],1)],1):e._e(),"2"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeIndex","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportTimeIndex,callback:function(t){e.$set(e.form,"reportTimeIndex",t)},expression:"form.reportTimeIndex"}},[t("el-option",{attrs:{label:"第一季度",value:"1"}}),t("el-option",{attrs:{label:"第二季度",value:"2"}}),t("el-option",{attrs:{label:"第三季度",value:"3"}}),t("el-option",{attrs:{label:"第四季度",value:"4"}})],1)],1)],1)],1)],1):e._e(),"3"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1):e._e(),"4"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimes","validate-event":!1}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.form.reportTimes,callback:function(t){e.$set(e.form,"reportTimes",t)},expression:"form.reportTimes"}})],1)],1):e._e()],1),t("el-form-item",{attrs:{label:"上报数据",prop:"fileName"}},[t("input",{ref:"addFile",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.importToExcel}}),t("div",{staticClass:"row"},[t("el-input",{attrs:{disabled:""},model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}}),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.addFile.click()}}},[e._v("上传文件")])],1)]),t("el-form-item",{attrs:{label:"使用模版",prop:"templateName"}},[t("div",{staticClass:"row"},[t("el-input",{attrs:{disabled:""},model:{value:e.form.templateName,callback:function(t){e.$set(e.form,"templateName",t)},expression:"form.templateName"}}),t("el-button",{attrs:{type:"primary"},on:{click:e.selectModal}},[e._v("选择模版")])],1)]),t("el-form-item",{attrs:{label:"上报说明"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入","show-word-limit":""},model:{value:e.form.reportRemark,callback:function(t){e.$set(e.form,"reportRemark","string"==typeof t?t.trim():t)},expression:"form.reportRemark"}})],1)],1),e.isShowSelectModal?t("loadModal",{attrs:{show:e.isShowSelectModal,resourceId:e.dataReportingEdit.id,templateId:e.form.templateId,type:"2"},on:{cancel:function(t){e.isShowSelectModal=!1},sure:e.loadModalSure}}):e._e()],1)}),[],!1,null,"cc4353ba",null);t.default=d.exports},df8b:function(e,t,r){var a=r("2362");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,r("499e").default)("45de72b0",a,!0,{sourceMap:!1,shadowMode:!1})}}]);