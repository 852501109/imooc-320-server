(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-16dcd938","chunk-7a1ef581","chunk-2d237543"],{1617:function(e,t,r){"use strict";r("5632")},"45c1":function(e,t,r){"use strict";r.r(t),r("8e6e"),r("456d"),r("c5f6"),r("28a5"),r("96cf");var l=r("1da1"),a=(r("ac6a"),r("ade3")),o=r("2f62"),i=r("fb3d"),n=r("aad9");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,l)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u,d={computed:c({},Object(o.d)(["upload"])),data:function(){return{formTitle:"edit"===this.$route.query.optType?"编辑公告":"view"===this.$route.query.optType?"查看公告":"新增公告",ruleForm:{type:1},rules:{title:{required:!0,message:"请输入标题",trigger:"blur"},level:{required:!0,message:"请选择紧急程度",trigger:"change"},receiveType:{required:!0,message:"请选择通告类型",trigger:"change"},content:{required:!0,message:"请输入内容",trigger:"change"}},isView:!1,levelList:i.levelList,userList:[],defaultCheckedKeys:[],userParams:{page:1,rows:200,name:null},historyList:[]}},components:{adqTree:n.default},watch:{"ruleForm.content":{handler:function(e){this.$refs.ruleForm.validateField("content"),e&&e.length>0&&this.$refs.ruleForm.clearValidate("content")},deep:!0},userList:{handler:function(e){var t=this,r=e.map((function(e){return e.id}));this.defaultCheckedKeys.forEach((function(e,l){-1===r.indexOf(e)&&t.defaultCheckedKeys.splice(l,1)}))},deep:!0}},created:(u=Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("view"===this.$route.query.optType&&(this.isView=!0),!this.$route.query.id){e.next=4;break}return e.next=4,this.loadData();case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),methods:c(c({},Object(o.b)(["_AJAX"])),{},{loadData:function(){var e=this;this._AJAX({url:"sys.message.notice.id",method:"GET",data:{id:this.$route.query.id,needSendList:0}}).then((function(t){if(0==t.code){var r=t.result;e.ruleForm=r,/[，,]/g.test(r.receiveCode)?(e.ruleForm.receiveCode=r.receiveCode.split(",").map(Number),e.defaultCheckedKeys=e.ruleForm.receiveCode):(r.receiveCode&&(e.ruleForm.receiveCode=[Number(r.receiveCode)]),r.receiveCode&&(e.defaultCheckedKeys=e.ruleForm.receiveCode))}})),this._AJAX({url:"sys.messagePublishHis.list",method:"GET",data:{page:1,rows:99999,messageCode:this.$route.query.uuidCode}}).then((function(t){0==t.code&&(e.historyList=t.result)}))},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){var r=e;if(!t)return!1;if(e.ruleForm.content.length>65535)return e.$AudaqueToast.error({template:"内容超出允许输入的上限，请整理后重新输入!",methods:{okEvent:function(){}}});var l=Object.assign({},e.ruleForm),a=null;e.$refs.tree&&(a=e.$refs.tree.$refs.adqTree.getCheckedKeys(),l.receiveCode=a),l.receiveCode&&l.receiveCode.length>0&&(l.receiveCode=l.receiveCode.join(",")),1===e.ruleForm.receiveType&&e.$delete(l,"receiveCode"),e.$store.commit("SHOW_LOADING",!0),e.$route.query.id?e._AJAX({url:"sys.message.edit",method:"POST",data:l}).then((function(t){e.$AudaqueToast.tip({template:"编辑成功",methods:{okEvent:function(){r.$router.go(-1)}}})})):e._AJAX({url:"sys.message.add",method:"POST",data:l}).then((function(t){e.$AudaqueToast.tip({template:"新增成功",methods:{okEvent:function(){r.$router.go(-1)}}})}))}))}})},f=(r("6fcc"),r("2877")),p=Object(f.a)(d,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{staticClass:"news-type-sys-edit",attrs:{title:e.formTitle,"opt-type":e.$route.query.optType},on:{"submit-click":e.submitForm}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"90px",disabled:e.isView}},[t("el-form-item",{attrs:{label:"标题",prop:"title"}},[t("el-input",{attrs:{placeholder:"","show-word-limit":"",maxlength:"32"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title","string"==typeof t?t.trim():t)},expression:"ruleForm.title"}})],1),t("el-form-item",{attrs:{label:"内容",prop:"content"}},[t("tinymce",{attrs:{disabled:e.isView},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),t("el-form-item",{attrs:{label:"摘要",prop:"messageAbstract"}},[t("el-input",{staticClass:"news-type-sys-introduction",attrs:{type:"textarea",autosize:"",placeholder:"","show-word-limit":"",maxlength:"1000"},model:{value:e.ruleForm.messageAbstract,callback:function(t){e.$set(e.ruleForm,"messageAbstract","string"==typeof t?t.trim():t)},expression:"ruleForm.messageAbstract"}})],1),t("el-form-item",{attrs:{label:"紧急程度",prop:"level"}},[t("el-select",{model:{value:e.ruleForm.level,callback:function(t){e.$set(e.ruleForm,"level",t)},expression:"ruleForm.level"}},e._l(e.levelList,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"通告类型",prop:"receiveType"}},[t("el-select",{model:{value:e.ruleForm.receiveType,callback:function(t){e.$set(e.ruleForm,"receiveType",t)},expression:"ruleForm.receiveType"}},[t("el-option",{attrs:{label:"全体用户",value:1}}),t("el-option",{attrs:{label:"指定用户",value:2}}),t("el-option",{attrs:{label:"指定部门",value:3}})],1)],1),2===e.ruleForm.receiveType?t("el-form-item",{attrs:{label:"用户",prop:"receiveCode"}},[t("adq-user-list-component",{attrs:{multiple:!0,userList:e.userList},on:{"update:userList":function(t){e.userList=t},"update:user-list":function(t){e.userList=t}},model:{value:e.ruleForm.receiveCode,callback:function(t){e.$set(e.ruleForm,"receiveCode",t)},expression:"ruleForm.receiveCode"}})],1):e._e(),3===e.ruleForm.receiveType?t("el-form-item",{attrs:{label:"部门",prop:"departmentIds"}},[t("div",{staticClass:"dept-box"},[t("adq-tree",{ref:"tree",attrs:{defaultCheckedKeys:e.defaultCheckedKeys,"check-strictly":!0}})],1)]):e._e(),"view"===e.$route.query.optType?t("el-form-item",{attrs:{label:""}},[t("div",{staticClass:"history-record-item"},[t("div",{staticClass:"history-record-title"},[e._v("公告发布撤销日志")]),t("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.historyList.rows,border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",width:"50"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"createUserName",label:"操作人"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"publishStatus",label:"操作行为"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(0===t.row.publishStatus?"撤销":"发布")+"\n                        ")]}}],null,!1,4047229038)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"createTime",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(e.publics.formatTime(t.row.createTime,"Y-M-D h:m:s"))+"\n                        ")]}}],null,!1,4154183725)})],1)],1)]):e._e()],1)],1)}),[],!1,null,"cbb280ce",null);t.default=p.exports},5632:function(e,t,r){var l=r("b219");l.__esModule&&(l=l.default),"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals),(0,r("499e").default)("1b5e0773",l,!0,{sourceMap:!1,shadowMode:!1})},"6fcc":function(e,t,r){"use strict";r("a758")},a758:function(e,t,r){var l=r("b8ed");l.__esModule&&(l=l.default),"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals),(0,r("499e").default)("06546623",l,!0,{sourceMap:!1,shadowMode:!1})},aad9:function(e,t,r){"use strict";r.r(t),r("8e6e"),r("456d"),r("7f7f"),r("ac6a");var l=r("ade3"),a=r("2f62");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,l)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){Object(l.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var n={name:"adqTree",data:function(){return{filterText:"",isAllCheck:null,allIds:[],treeData:[],loading:!1,isSearch:!1}},watch:{treeData:{handler:function(e){},deep:!0},filterText:function(e){0===e.length&&(this.isSearch=!1,this.$refs.adqTree.filter(e))}},props:{defaultCheckedKeys:{type:Array,default:function(){return[]}},defaultExpandedKeys:{type:Array,default:function(){return[]}},checkStrictly:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!0},isCheckBtn:{type:Boolean,default:!0},expandOnClickNode:{type:Boolean,default:!0},nodeKey:{type:String,default:"id"},defaultProps:{type:Object,default:function(){return{label:"name",children:"children",isLeaf:"isEnd"}}}},mounted:function(){this.loadInit()},methods:i(i({},Object(a.b)(["_AJAX"])),{},{loadInit:function(){var e=this;this.loading=!0,this._AJAX({url:"org.findRootDept",method:"GET",data:{}}).then((function(t){0===t.code&&e._AJAX({url:"org.findRootDeptTree",method:"GET",data:{deptId:t.result.id}}).then((function(t){e.treeData=[t.result],e.loading=!1,e.defaultExpandedKeys.push(t.result.id),e.allIds=[],e.loadIds([t.result])}))}))},loadIds:function(e){var t=this;e.forEach((function(e){t.allIds.push(e.id),e.children&&e.children.length>0&&t.loadIds(e.children)}))},treeIsAllCheck:function(e){e?this.$refs.adqTree.setCheckedKeys(this.allIds):this.$refs.adqTree.setCheckedKeys([])},clickInquireTreeData:function(){var e=this;this.isSearch=!0,this.loading=!0,setTimeout((function(){e.$refs.adqTree.filter(e.filterText),e.$nextTick().then((function(){setTimeout((function(){e.loading=!1}),500)}))}),50)},parentSearch:function(e){this.filterText=e,this.clickInquireTreeData()},filterNode:function(e,t,r){return!e||-1!==t.name.indexOf(e)},filterNodeMethod:function(e){var t=this;!function r(l){l.map((function(l){var a=l[t.defaultProps.children];l.visible=t.filterNode(e,l),a&&a.length>0&&r(a)}))}(this.treeData)},handleNodeClick:function(e,t){this.$emit("node-click",e,t),this.showChildrenNode(e,t)},showChildrenNode:function(e,t){1!=t.level&&!t.isLeaf&&this.isSearch&&(t.expanded=!0,t.childNodes.forEach((function(e){e.visible=!0})))},handleCheckChange:function(e,t){this.$emit("check-change",e,t)},handleRenderContent:function(e,t){var r=t.node,l=t.data,a=(t.store,"iconfont icondrxx95 group");return l.isPosition?a=l.leader?"iconfont iconlingdao leader":"iconfont iconyuangong people":1===r.level&&(a="iconfont icondrxx95 root"),e("span",{class:a,style:""},[" ",l.name])}})},s=(r("1617"),r("2877")),c=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"adq-tree"},[t("el-input",{staticClass:"filter-tree-input",attrs:{placeholder:"输入关键字进行过滤",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.clickInquireTreeData.apply(null,arguments)}},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[t("el-button",{staticClass:"query-btn",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.clickInquireTreeData},slot:"append"},[e._v("搜索")])],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"adq-tree-item",attrs:{"element-loading-spinner":"el-icon-loading"}},[e.showCheckbox&&e.isCheckBtn?t("el-radio-group",{staticStyle:{"margin-left":"20px"},model:{value:e.isAllCheck,callback:function(t){e.isAllCheck=t},expression:"isAllCheck"}},[t("el-radio-button",{attrs:{label:!0},nativeOn:{click:function(t){return e.treeIsAllCheck(!0)}}},[e._v("全选")]),t("el-radio-button",{attrs:{label:!1},nativeOn:{click:function(t){return e.treeIsAllCheck(!1)}}},[e._v("全不选")])],1):e._e(),t("el-tree",{ref:"adqTree",staticClass:"tree-dashed",attrs:{props:e.defaultProps,"show-checkbox":e.showCheckbox,"expand-on-click-node":e.expandOnClickNode,"node-key":e.nodeKey,"default-checked-keys":e.defaultCheckedKeys,"default-expanded-keys":e.defaultExpandedKeys,"check-strictly":e.checkStrictly,"render-content":e.handleRenderContent,"filter-node-method":e.filterNode,indent:20,data:e.treeData},on:{"node-click":e.handleNodeClick,"check-change":e.handleCheckChange}})],1)],1)}),[],!1,null,"3c72946d",null);t.default=c.exports},b219:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".adq-tree[data-v-3c72946d]{border:1px solid #dcdfe6;width:100%;z-index:99999;max-height:300px;overflow:auto}.adq-tree .filter-tree-input .query-btn[data-v-3c72946d]{background:#409eff;color:#fff}.adq-tree .adq-tree-item[data-v-3c72946d]{height:260px}.adq-tree .adq-tree-item[data-v-3c72946d] .el-loading-spinner i{font-size:30px}",""])},b8ed:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,"[data-v-cbb280ce] .news-type-sys-introduction{min-height:90px!important;height:auto!important}[data-v-cbb280ce] .news-type-sys-introduction /deep/ .el-textarea__inner{min-height:90px!important}.history-record-item[data-v-cbb280ce]{border-top:1px solid #e0e0e0}.history-record-item .history-record-title[data-v-cbb280ce]{font-size:16px;padding-top:10px;margin-bottom:10px}",""])},fb3d:function(e,t,r){"use strict";r.r(t),r.d(t,"msgTypeList",(function(){return l})),r.d(t,"msgNoticeTypeList",(function(){return a})),r.d(t,"levelList",(function(){return o})),r.d(t,"sendStatusList",(function(){return i})),r.d(t,"publishStatusList",(function(){return n})),r.d(t,"handleStatusList",(function(){return s})),r.d(t,"channelList",(function(){return c}));var l=[{label:"其他",value:0},{label:"公告",value:1},{label:"消息",value:2},{label:"任务",value:3},{label:"告警",value:4}],a=[{label:"标签",value:0},{label:"全部用户",value:1},{label:"用户",value:2},{label:"部门",value:3}],o=[{label:"默认",value:0},{label:"低",value:1},{label:"中",value:2},{label:"高",value:3}],i=[{label:"初始化",value:0},{label:"已发送",value:1},{label:"推送失败",value:3},{label:"失败不再发送",value:-1}],n=[{label:"未发布",value:0},{label:"已发布",value:1},{label:"已撤销",value:2}],s=[{label:"-",value:null},{label:"部分办理",value:3},{label:"撤销",value:2},{label:"办理",value:1},{label:"未办",value:0}],c=[{label:"系统",value:"1"},{label:"邮件",value:"2"},{label:"短信",value:"3"}]}}]);