(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ae390142","chunk-2d237782"],{4267:function(e,t,r){var a=r("531e5");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,r("499e").default)("506e25d3",a,!0,{sourceMap:!1,shadowMode:!1})},"531e5":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".footer[data-v-0bbf2242]{width:100%;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.footer[data-v-0bbf2242],.row[data-v-0bbf2242]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row[data-v-0bbf2242]{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.get-edit-item[data-v-0bbf2242]{padding-top:20px;margin:0 50px}.get-edit-item li[data-v-0bbf2242]{margin-top:20px;display:-webkit-box;display:-ms-flexbox;display:flex}.get-edit-item li .get-edit-type[data-v-0bbf2242]{height:40px;line-height:40px}.get-edit-item li .get-edit-title[data-v-0bbf2242]{width:80px;color:#3a405b;height:40px;line-height:40px}.get-edit-item li .el-tree[data-v-0bbf2242]{width:100%;border:1px solid #dcdfe6;padding:24px}[data-v-0bbf2242] .audaque-detail-form-page__form-btn{display:none!important}",""])},"6cf7":function(e,t,r){"use strict";r.r(t),r("7514"),r("7f7f"),r("8e6e"),r("456d"),r("6b54"),r("c5f6"),r("ac6a"),r("28a5"),r("96cf");var a=r("1da1"),o=(r("a481"),r("ade3")),n=r("2f62"),i=r("faf7"),l=r("bc3a"),s=r.n(l);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u,d={mixins:[i.default],data:function(){return{value:"",rowId:this.$route.query.id,responseExample:"",filter:"view"!=this.$route.query.filter,fixStr:"JSON",tokenRes:{},param:{id:"",serviceNameEn:"",serviceNameCn:"",serviceProviderDeptId:"",tokenGetUrl:"",serviceAccessUrl:"",secretKey:""},condtionFieldDtoList:[],rules:{serviceProviderDeptId:[{required:!0,message:"请选择",trigger:"change"}],serviceNameCn:[{required:!0,message:"请输入",trigger:"blur"}],serviceNameEn:[{required:!0,message:"请输入",trigger:"blur"}]},mutipleSelectVal:[],returnParamLists:[],metaTableIdOptions:[]}},components:{},computed:p({currentTable:function(){var e=this;return this.metaTableIdOptions.find((function(t){return t.id==e.param.metaTableId}))||{}}},Object(n.d)("apiServiceManage",["queryTableColumnObjList","queryMapAddBefore"])),methods:p(p(p({},Object(n.b)(["_AJAX"])),Object(n.b)("apiServiceManage",["GOEDITAPISERVICEACCESSRECORD","MODIFYAPISERVICEACCESSRECORD","ADDAPISERVICEACCESSRECORD","QUERY_TABLE_COLUMN_OBJ_LIST","QUERY_MAP_ADD_BEFORE","GENERATE_SERVICE_SQL"])),{},{handleInput:function(e,t){e[t]=e[t].replace(/\D/g,"")},deepClone:function(e){return JSON.parse(JSON.stringify(e))},getToken:function(){var e=this;return new Promise((function(t){var r=e.param.tokenGetUrl,a=r.substring(r.indexOf("/webkit"));e._AJAX({url:a,method:"GET"}).then((function(r){"0000"==r.code?(e.tokenRes=r,t(r)):e.$message.warning(r.msg)}))}))},getPublicParam:function(e,t,r){var a=this,o=s.a.create({headers:{Token:t,"User-Account":r,"Content-Type":"application/json;","X-Requested-With":"XMLHttpRequest"}}),n="/webkit/service/".concat(this.param.serviceNameEn);return new Promise((function(t){1==a.param.serviceHttpMethod&&o.get(n,{params:e}).then((function(e){t(e.data)})).catch((function(e){var r=(e.code?e:JSON.parse(e.request.responseText)).msg;t(r)})),2==a.param.serviceHttpMethod&&o.post(n,e).then((function(e){t(e.data)})).catch((function(e){var r=(e.code?e:JSON.parse(e.request.responseText)).msg;t(r)}))}))},test:(u=Object(a.a)(regeneratorRuntime.mark((function e(){var t,r,a,o,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.condtionFieldDtoList.find((function(e){return e.isRequire&&!e.requestParam})))){e.next=4;break}return this.$message.warning("".concat(t.columnName,"字段必填")),e.abrupt("return");case 4:return r=this.param.tokenGetUrl,e.next=7,this.getToken();case 7:a=r.substring(r.indexOf("userAccount")).split("=")[1],o={},this.queryMapAddBefore.publicVariableDoList.filter((function(e){return 2==e.varType})).forEach((function(e){e.requestParam&&(o[e.varName]=Number(e.requestParam))})),this.condtionFieldDtoList.forEach((function(e){o[e.columnName]=e.requestParam})),this.getPublicParam(o,this.tokenRes.data.token,a).then((function(e){n.responseExample=JSON.stringify(e)}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})}),mounted:function(){},created:function(){var e=this;this.QUERY_MAP_ADD_BEFORE(),this.rowId&&(this.$store.commit("apiConsumerTesting/changeLoading",!0),this.GOEDITAPISERVICEACCESSRECORD({id:this.rowId}).then((function(t){e.param=t.serviceManageDto,e.param.tokenGetUrl=t.tokenGetUrl,e.param.secretKey=t.secretKey,e.param.serviceAccessUrl=t.serviceAccessUrl;var r=t.condtionFieldDtoList;r.forEach((function(e){e.requestParam=""})),e.condtionFieldDtoList=r,e.param.serviceProviderDeptId=e.param.serviceProviderDeptId.toString(),e.metaTableIdOptions=[{id:e.param.metaTableId,tableName:e.param.tableName}],e.QUERY_TABLE_COLUMN_OBJ_LIST({tableId:e.param.metaTableId}).then((function(){e.$nextTick((function(){e.$store.commit("apiConsumerTesting/changeLoading",!1)}))}))})))}},f=(r("6e8d"),r("2877")),m=Object(f.a)(d,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{directives:[{name:"loading",rawName:"v-loading",value:e.$store.state.apiConsumerTesting.isLoading,expression:"$store.state.apiConsumerTesting.isLoading"}],attrs:{title:"API消费测试","opt-type":e.$route.query.filter,"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.5)"}},[[t("el-form",{ref:"apiServiceAccessRecordForm",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules}},[t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"服务中文名",prop:"serviceNameCn"}},[t("el-input",{attrs:{disabled:""},model:{value:e.param.serviceNameCn,callback:function(t){e.$set(e.param,"serviceNameCn","string"==typeof t?t.trim():t)},expression:"param.serviceNameCn"}})],1)],1),t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"服务英文名",prop:"serviceNameEn"}},[t("el-input",{attrs:{disabled:""},model:{value:e.param.serviceNameEn,callback:function(t){e.$set(e.param,"serviceNameEn","string"==typeof t?t.trim():t)},expression:"param.serviceNameEn"}})],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"服务提供方",prop:"serviceProviderDeptId"}},[e.queryMapAddBefore?t("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.param.serviceProviderDeptId,callback:function(t){e.$set(e.param,"serviceProviderDeptId",t)},expression:"param.serviceProviderDeptId"}},e._l(e.queryMapAddBefore.deptList,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1):e._e()],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"公共入参"}},[e.queryMapAddBefore&&e.queryMapAddBefore.publicVariableDoList?t("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.queryMapAddBefore.publicVariableDoList.filter((function(e){return 1==e.varType})),border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",align:"center",label:"序号",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varName",label:"参数名"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varDesc",label:"参数描述"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"是否必填"},scopedSlots:e._u([{key:"default",fn:function(r){return[1==r.row.varIsRequired?t("span",[e._v("是")]):t("span",[e._v("否")])]}}],null,!1,2192463538)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varPosition",label:"参数位置"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varRemark",label:"说明"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varValue",label:"请求参数值"},scopedSlots:e._u([{key:"default",fn:function(e){}}],null,!1,4154174436)})],1):e._e()],1)],1)],1),e.param.isPageFlag?t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"分页参数"}},[1==e.param.isPageFlag&&e.queryMapAddBefore&&e.queryMapAddBefore.publicVariableDoList?t("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.queryMapAddBefore.publicVariableDoList.filter((function(e){return 2==e.varType})),border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",align:"center",label:"序号",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varName",label:"参数名"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varDesc",label:"参数描述"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"是否必填"},scopedSlots:e._u([{key:"default",fn:function(r){return[1==r.row.varIsRequired?t("span",[e._v("必填")]):t("span",[e._v("非必填")])]}}],null,!1,1658632165)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varPosition",label:"参数位置"}},[[1==e.param.serviceHttpMethod?t("span",[e._v("params")]):e._e(),2==e.param.serviceHttpMethod?t("span",[e._v("body")]):e._e()]],2),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varRemark",label:"说明"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"varValue",label:"请求参数值"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{on:{input:function(t){return e.handleInput(r.row,"requestParam")}},model:{value:r.row.requestParam,callback:function(t){e.$set(r.row,"requestParam",t)},expression:"scope.row.requestParam"}})]}}],null,!1,3595040844)})],1):e._e()],1)],1)],1):e._e(),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"服务条件入参项"}},[t("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.condtionFieldDtoList,border:""}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",align:"center",label:"序号",width:"80"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"资源表名"}},[e.currentTable?t("span",[e._v(e._s(e.currentTable.tableName))]):e._e()]),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"columnName",label:"字段英文名"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"columnComment",label:"字段中文名"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"matchingMethod",label:"匹配方式"},scopedSlots:e._u([{key:"default",fn:function(t){return e.queryMapAddBefore.matchingMethod.some((function(e){return e.code==t.row.matchingMode}))?[e._v("\n                                        "+e._s(e.queryMapAddBefore.matchingMethod.find((function(e){return e.code==t.row.matchingMode})).name)+"\n                                    ")]:void 0}}],null,!0)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"matchingMode",label:"匹配含义"},scopedSlots:e._u([{key:"default",fn:function(t){return e.queryMapAddBefore.matchingMode.some((function(e){return e.code==t.row.matchingMode}))?[e._v("\n                                        "+e._s(e.queryMapAddBefore.matchingMode.find((function(e){return e.code==t.row.matchingMode})).name)+"\n                                    ")]:void 0}}],null,!0)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"是否必填"},scopedSlots:e._u([{key:"default",fn:function(r){return[1==r.row.isRequire?t("span",[e._v("是")]):t("span",[e._v("否")])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"请求参数值"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{model:{value:r.row.requestParam,callback:function(t){e.$set(r.row,"requestParam",t)},expression:"scope.row.requestParam"}})]}}])})],1)],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"消费测试结果"}},[t("el-input",{attrs:{type:"textarea",placeholder:"",disabled:""},model:{value:e.responseExample,callback:function(t){e.responseExample=t},expression:"responseExample"}})],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("div",{staticClass:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.test}},[e._v("消费测试")])],1)])],1)],1)])]],2)}),[],!1,null,"0bbf2242",null);t.default=m.exports},"6e8d":function(e,t,r){"use strict";r("4267")},faf7:function(e,t,r){"use strict";r.r(t),r("8e6e"),r("456d"),r("7f7f"),r("7514"),r("6762"),r("2fdb"),r("ac6a");var a=r("ade3"),o=r("2f62");function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l={computed:i({},Object(o.d)("fusionTask",["databaseConf"])),data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],databaseList:[{label:"前置库",options:[]},{label:"",options:[]}],nameMap:{0:"stepStart",au_ods:"stepOds",au_std:"stepStd",au_dwd:"stepDwd",au_dwm:"stepDwm",au_dws:"stepDws",au_app:"stepApp"},titleMap:{0:"开始",1:"归集层",2:"标准层",3:"基础层",4:"主题层",5:"专题层",6:"安全层",7:"前置库"},process:[{id:"",title:"开始",stepId:"",success:!1}]}},methods:i(i({},Object(o.b)("fusionTask",["GET_DATA_BASE_LIST","GET_STEP_HEADERR"])),{},{getStepHeader:function(){var e=this;return new Promise((function(t){e.GET_STEP_HEADERR({taskId:e.$route.query.taskId}).then((function(r){if(r&&r.length>0){var a=r;a.forEach((function(t,r){if(0===r)t.success=!0,t.title="开始";else{var a=t.stepDetailList[0].targetDbCode;t.success=!0,t.title=e.storey.includes(a)?e.databaseList[1].options.find((function(e){return e.code===a})).label:e.databaseList[0].options.find((function(e){return e.code===a})).label}})),e.process=a}t(r)}))}))}}),created:function(){var e=this;this.isLoading=!0,this.databaseList[1].options=[],this.GET_DATA_BASE_LIST().then((function(){e.databaseConf.frontDBList.forEach((function(t,r){e.databaseList[0].options.push({label:t.name,value:r+1,type:t.type,code:t.code})})),e.databaseConf.modelDBList.forEach((function(t,r){e.databaseList[1].options.push({label:t.name,value:r+1,type:t.type,code:t.code})})),e.getStepHeader().then((function(t){e.$route.query.stepId&&e.process.find((function(t){return t.id==e.$route.query.stepId}))?e.backTo(e.process.find((function(t){return t.id==e.$route.query.stepId}))):t.length>0&&e.backTo(e.process[e.process.length-1])}))}))}};t.default=l}}]);