(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0ab7e2"],{1607:function(t,e,a){"use strict";a.r(e),a("8e6e"),a("456d"),a("28a5"),a("6b54"),a("ac6a");var o=a("ade3"),i=a("2f62"),r=a("1971"),n=a("365c");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){Object(o.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var c={data:function(){return{key2:+new Date,isSearch:!1,param:{page:1,rows:10},tableList:{rows:[],total:0},isVisibleDialog:!1,activeData:{},formConf:{},formInfo:{},formModel:{},theadList:[],dialogTitle:"新增",dialogType:"add",tableName:this.$route.query.tableName,formId:this.$route.query.formId,formCode:this.$route.query.formCode,loadNum:0,dictionary:{}}},created:function(){this.loadData()},watch:{dictionary:function(t){}},methods:s(s({},Object(i.b)(["_AJAX"])),{},{loadData:function(){var t=this;if(this.formId){var e=n.default["form.design.select"]+"/"+this.formId;this._AJAX({url:e,method:"GET",data:{}}).then((function(e){if(t.formInfo=e.result,e.result.formJson){var a=JSON.parse(e.result.formJson);t.formConf=a,0===t.loadNum&&(t.fieldTranslation(a.fields),(t.formConf.fields[0].__config__.children?t.formConf.fields[0].__config__.children:t.formConf.fields).forEach((function(e){if("el-upload"!=e.__config__.tag&&"table-component"!=e.__config__.tag){var a={};a.label=e.__config__.label,a.value=e.__vModel__,a.tag=e.__config__.tag,a.formJson=e,t.theadList.push(a)}})),++t.loadNum);var o=Object.assign({tableName:t.tableName,formCode:t.formCode},t.param);setTimeout((function(){t._AJAX({url:"form.data.list",method:"GET",data:o}).then((function(e){t.tableList=e.result}))}),200)}}))}},fieldTranslation:function(t){var e=this,a=this;t.forEach((function(t){"table-component"!==t.__config__.tag&&(t.__config__.children?e.fieldTranslation(t.__config__.children):"dynamic"===t.__config__.dataType?Object(r.fetchDynamicData)({method:t.__config__.method,url:t.__config__.url}).then((function(e){a.$set(a.dictionary,t.__vModel__,{}),"el-tree"===t.__config__.tag||"el-cascader"===t.__config__.tag?"Object"===Object.prototype.toString.call(e[t.__config__.dataPath]).slice(8,-1)?a.TreeTranslation([e[t.__config__.dataPath]],t):a.TreeTranslation(e[t.__config__.dataPath],t):e[t.__config__.dataPath].forEach((function(e){var o=e[t.props.props.value];a.$set(a.dictionary[t.__vModel__],o,e[t.props.props.label])}))})):(a.$set(a.dictionary,t.__vModel__,{}),"Object"===Object.prototype.toString.call(t[t.__config__.dataConsumer]).slice(8,-1)?a.TreeTranslation([t[t.__config__.dataConsumer]],t):a.TreeTranslation(t[t.__config__.dataConsumer],t)))}))},TreeTranslation:function(t,e){var a=this;t&&t.forEach((function(t){if(t[e.props.props.children]&&t[e.props.props.children].length>0)if("el-select"===e.__config__.tag||"el-checkbox-group"===e.__config__.tag||"el-radio-group"===e.__config__.tag){var o=t.value;a.$set(a.dictionary[e.__vModel__],o,t.label),a.TreeTranslation(t.children,e)}else{var i=t[e.props.props.value];a.$set(a.dictionary[e.__vModel__],i,t[e.props.props.label]),a.TreeTranslation(t[e.props.props.children],e)}else if("el-select"===e.__config__.tag||"el-checkbox-group"===e.__config__.tag||"el-radio-group"===e.__config__.tag){var r=t.value;a.$set(a.dictionary[e.__vModel__],r,t.label)}else{var n=t[e.props.props.value];a.$set(a.dictionary[e.__vModel__],n,t[e.props.props.label])}}))},handleSizeChange:function(t){this.param.rows=t,this.param.page=1,this.loadData()},handleCurrentChange:function(t){this.param.page=t,this.loadData()},search:function(t){var e=this;this.param.page=1,0==t&&this.publics.resetFun(this.param,(function(){e.param.rows=10})),this.loadData()},selectComponentsList:function(t,e){if(!t)return"-";if(/[，,]/g.test(t)){for(var a=t.indexOf("]")>0?JSON.parse(t):t.split(","),o=0;o<a.length;o++){var i=a[o];a[o]=this.dictionary[e][i]}return a.join(",")}return this.dictionary[e][t]},viewSwitchName:function(t,e){if(t&&null!=e&&null!=e){t.formJson["active-value"];var a={};return a[t.formJson["active-value"]]=t.formJson.__config__.activeName||"开启",a[t.formJson["inactive-value"]]=t.formJson.__config__.inactiveName||"关闭",a[e]}return"-"},selectList:function(t,e){if(!e)return"-";var a={};if(t.formJson.options&&t.formJson.options.forEach((function(e){a[e[t.formJson.props.props.value]]=e[t.formJson.props.props.label]})),/[，,]/g.test(e)){for(var o=e.split(","),i=0;i<o.length;i++){var r=o[i];o[i]=a[r]}return o.join(",")}return a[e]},submitForm:function(t){var e=this,a=this,o=null;o="add"===this.dialogType?Object.assign({},t):Object.assign(t,{id:this.activeData.id,uuid:this.activeData.uuid}),this.$store.commit("SHOW_LOADING",!0),this._AJAX({url:"add"===this.dialogType?"form.data.new":"form.data.update",method:"POST",data:{tableName:this.tableName?this.tableName:null,dataMap:o,rowId:"edit"===this.dialogType?this.activeData.uuid?this.activeData.uuid:this.activeData.id:null,formCode:this.formCode}}).then((function(t){e.$AudaqueToast.tip({template:"add"===e.dialogType?"新增成功":"编辑成功",methods:{okEvent:function(){a.isVisibleDialog=!1,a.loadData()}}})}))},resetForm:function(){},infoEdit:function(){this.dialogTitle="新增",this.dialogType="add",this.isVisibleDialog=!0},edit:function(t){var e=this;this._AJAX({url:"form.data.select",method:"GET",data:{rowId:t.uuid?t.uuid:t.id,tableName:t.uuid?this.tableName:null,formCode:this.formCode}}).then((function(t){e.formModel=t.result,r.fillFormData.call(e,e.formConf.fields,t.result,e.formConf),e.key2=+new Date,e.dialogTitle="编辑",e.dialogType="edit",e.isVisibleDialog=!0,e.activeData=t.result}))},del:function(t){var e=this;this.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){e.$store.commit("SHOW_LOADING",!0),e._AJAX({url:"form.data.delete",method:"GET",data:{rowId:t.uuid?t.uuid:t.id,tableName:t.uuid?e.tableName:null,formCode:e.formCode}}).then((function(t){e.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){e.loadData()}}})}))}}})}})},f=a("2877"),u=Object(f.a)(c,(function(){var t=this,e=t._self._c;return e("audaque-table-list-page",[e("template",{slot:"title"},[e("audaque-table-title",{attrs:{title:"表单数据"}},[e("i",{staticClass:"iconfont iconfanhui1 audaque-rect-icon",on:{click:function(e){return t.$router.go(-1)}}},[t._v(" 返回")]),t.permitList.formDateNew&&(t.formInfo.tableName||t.formInfo.apiDataAdd)?e("i",{staticClass:"iconfont iconxinzeng2 audaque-rect-icon",on:{click:function(e){return t.infoEdit()}}},[t._v("\n                新增")]):t._e()])],1),e("template",{slot:"search"}),[e("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:t.tableList.rows,border:""}},[e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.param.page,t.param.rows)},width:"50"}}),t._l(t.theadList,(function(a,o){return e("el-table-column",{key:o,attrs:{"show-overflow-tooltip":"",prop:a.value,label:a.label},scopedSlots:t._u([{key:"default",fn:function(o){return["el-date-picker"===a.tag||"el-time-picker"===a.tag?[a.formJson.__config__.isRange?["el-time-picker"===a.tag?[t._v("\n                                "+t._s(o.row[a.value])+" - "+t._s(o.row[a.formJson.__vModel_1__])+"\n                            ")]:[t._v("\n                                "+t._s(t.$utils.timeToDate(o.row[a.value],!1))+" -\n                                "+t._s(t.$utils.timeToDate(o.row[a.formJson.__vModel_1__],!1))+"\n                            ")]]:["el-time-picker"===a.tag?[t._v("\n                                "+t._s(o.row[a.value])+"\n                            ")]:[t._v("\n                                "+t._s(t.$utils.timeToDate(o.row[a.value],!1))+"\n                            ")]]]:"el-tree"===a.tag||"el-select"===a.tag||"el-cascader"===a.tag||"el-checkbox-group"===a.tag||"el-radio-group"===a.tag?e("div",[e("span",{domProps:{textContent:t._s(t.selectComponentsList(o.row[a.value],a.value))}})]):"el-switch"===a.tag?[t._v("\n                        "+t._s(t.viewSwitchName(a,o.row[a.value]))+"\n                    ")]:e("div",["dynamic"===a.formJson.__config__.dataType?e("span",[t._v(t._s(t.dictionary[a.value][o.row[a.value]]))]):e("span",[t._v(t._s(o.row[a.value]))])])]}}],null,!0)})})),e("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.permitList.formDateUpdate?e("span",{staticClass:"iconfont iconFill",attrs:{title:"编辑"},on:{click:function(e){return t.edit(a.row)}}}):t._e(),!t.permitList.formDateDel||a.row.actStatus&&0!=a.row.actStatus||!t.formInfo.tableName&&!t.formInfo.apiDataDelete?t._e():e("span",{staticClass:"iconfont iconShape1",attrs:{title:"删除"},on:{click:function(e){return t.del(a.row)}}})]}}])}),e("template",{slot:"empty"},[e("audaque-table-empty",{attrs:{tableFetchStatus:t.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(e){return t.loadData()}}})],1)],2),e("adq-pagination",{attrs:{"current-page":t.param.page,"page-size":t.param.rows,total:t.tableList.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],e("el-dialog",{staticClass:"form-parser-dialog",attrs:{title:t.dialogTitle,visible:t.isVisibleDialog,width:"500","close-on-click-modal":!1},on:{"update:visible":function(e){t.isVisibleDialog=e},close:function(e){return t.$refs.formParser.resetForm()}}},[t.isVisibleDialog?e("form-parser",{key:t.key2,ref:"formParser",attrs:{formConf:t.formConf},on:{submit:t.submitForm,reset:t.resetForm}}):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.isVisibleDialog=!t.isVisibleDialog}}},[t._v("取消")]),e("el-button",{attrs:{loading:t.isSHowButtonLoading},on:{click:function(e){return t.$refs.formParser.submitForm()}}},[t._v("提交")])],1)],1)],2)}),[],!1,null,null,null);e.default=u.exports}}]);