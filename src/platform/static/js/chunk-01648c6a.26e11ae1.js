(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-01648c6a"],{"2e69":function(e,t,i){(e.exports=i("2350")(!1)).push([e.i,"[data-v-51d11991] .resource{border:1px solid #e1dfdc}[data-v-51d11991] .submit-wrap{text-align:center;margin-top:.2rem}[data-v-51d11991] .el-tree{height:3.5rem;overflow-y:scroll}.system-config-edit[data-v-51d11991] .system-introduction{min-height:90px!important;height:auto!important}.system-config-edit[data-v-51d11991] .system-introduction /deep/ .el-textarea__inner{min-height:90px!important}.system-config-edit[data-v-51d11991] .manual-file{width:100%}.system-config-edit[data-v-51d11991] .manual-file /deep/ .el-upload-list__item-name{line-height:40px}.system-config-edit[data-v-51d11991] .manual-file .prompt{width:20px;height:20px;margin-left:20px}.upload-file-list li[data-v-51d11991]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;cursor:pointer;color:#606266}.upload-file-list li[data-v-51d11991]:hover{background:#fafafa;color:#409eff}",""])},8622:function(e,t,i){var r=i("2e69");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,i("499e").default)("372b65b0",r,!0,{sourceMap:!1,shadowMode:!1})},afaa:function(e,t,i){"use strict";i.r(t),i("7f7f"),i("8e6e"),i("20d6"),i("28a5"),i("456d"),i("ac6a");var r=i("ade3"),a=i("2f62"),s=i("f0f8"),l=i("365c");function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){Object(r.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var u={computed:n({},Object(a.d)(["upload"])),components:{uploadComponents:s.default},data:function(){return{imgVisible:!1,preview:"",smallIconFile:[],largeIconFile:[],ruleForm:{name:"",appId:"",mainUrl:"",remark:"",smallIcon:"",userGuide:""},rules:{name:[{required:!0,message:"系统名称不能为空",trigger:"blur"}],appId:[{required:!0,message:"接入应用不能为空",trigger:"change"}],mainUrl:[{required:!0,message:"模块URL不能为空",trigger:"blur"}],remark:[{required:!0,message:"系统介绍内容不能为空",trigger:"blur"}]},fileList:[],manualFileList:[],options:[],percent:null,isView:!1,token:sessionStorage.getItem("token"),defaultProps:{label:"name",disabled:"other"},myResource:[],selectOrg:{orgsid:[]},resourceList:[]}},created:function(){var e=this;this._AJAX({url:"webkit.appList",method:"GET",data:{page:1,rows:1e4}}).then((function(t){if(0==t.code){var i=[];t.rows.forEach((function(e){e.enabled&&i.push(e)})),e.options=i}})),this.$route.query.id&&this.loadData(),this.$route.query.view&&(this.isView=!0)},methods:n(n(n({},Object(a.b)(["LOADIMG","LOADOBJ","_AJAX","MYPLATFORM"])),Object(a.b)("webkit",["MODIFYAPP","ADDAPP","APPDETAIL"])),{},{getResourceList:function(){var e=this,t=!this.$route.query.view;this._AJAX({url:"webkit.displayChildrenResourceList",method:"GET",data:{filter:t}}).then((function(i){if(0==i.code){var r,a=[];r=i.result,Object.keys(r).forEach((function(i){var s=i.split("__")[1];r[i].forEach((function(i){e.treeIsDisabled(i,t,s)})),a.push({name:s,children:r[i],index:"",other:!0})})),e.resourceList=a}}))},treeIsDisabled:function(e,t,i){t||(e.other=!0),e.value="".concat(i,"_").concat(e.name),e.children&&e.children.length>0&&this.treeIsDisabled(e.children,t,i)},loadData:function(){var e=this;this._AJAX({url:"authorManage.find",method:"GET",data:{id:this.$route.query.id}}).then((function(t){if(0==t.code){var i=t.result;if(i.smallIcon&&e.LOADOBJ(i.smallIcon).then((function(t){if(t){var i="svg"===t.extName?"data:image/svg+xml;base64,"+t.contentBase64:"data:image/*;base64,"+t.contentBase64;e.fileList=[{lastModifiedDate:new Date,name:"small",url:i}]}})),i.userGuide){var r=l.default["global.viewName"]+i.userGuide+".go";e._AJAX({url:r,method:"GET",data:{}}).then((function(t){e.manualFileList=[{lastModifiedDate:new Date,name:t.result,key:i.userGuide}]}))}e.ruleForm=i}}))},uploadSuccess:function(e){this.fileList=e.fileList,this.ruleForm.smallIcon=e.res.result},uploadImgSuccess:function(e){this.fileList=e.fileList,this.ruleForm.smallIcon=e.res.result},handleFilePreview:function(e){if(e.key){var t="/file/pub/down/".concat(e.key,".do");this.publics.exportFile(this,t,{})}},handleFileRemove:function(e,t){this.manualFileList=t,this.ruleForm.userGuide=""},handleFileSuccess:function(e){this.manualFileList=[e.file],this.ruleForm.userGuide=e.res.result},uploadDialogSubmit:function(e){this.ruleForm=Object.assign(this.ruleForm,{visibleRange:e})},validateUserGuide:function(e,t,i){this.manualFileList&&this.manualFileList.length>0?i():(i(new Error(" ")),this.$AudaqueToast.error({template:"请上传用户手册",methods:{okEvent:function(){}}}))},treeCheckChange:function(e,t,i){var r=this.$refs.tree.getCheckedKeys();r.splice(r.findIndex((function(t){return t===e.value})),1),this.selectOrg.orgsid=r;var a=this.selectOrg.orgsid.indexOf(e.value);a<0&&this.selectOrg.orgsid.length>=1&&t?(this.$message({message:"只能选择一个选项！",type:"error",showClose:!0}),this.$refs.tree.setChecked(e,!1)):0===this.selectOrg.orgsid.length&&t?(this.selectOrg.orgsid=[],this.selectOrg.orgsid.push(e.value)):a>=0&&1===this.selectOrg.orgsid.length&&!t&&(this.selectOrg.orgsid=[])},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var i=e,r=n({},e.ruleForm);i.$store.commit("SHOW_LOADING",!0),e.$route.query.id?e._AJAX({url:"authorManage.modify",method:"POST",data:r}).then((function(t){e.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){i.$router.go(-1),i.MYPLATFORM({page:1,row:1e3})}}})})):e._AJAX({url:"authorManage.add",method:"POST",data:r}).then((function(t){e.$AudaqueToast.tip({template:"新增成功",methods:{okEvent:function(){i.$router.go(-1),i.MYPLATFORM({page:1,row:1e3})}}})}))}))}})},c=(i("e322"),i("2877")),d=Object(c.a)(u,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{staticClass:"system-config-edit",attrs:{title:e.$route.query.id?e.isView?"查看系统":"编辑系统":"新增系统","opt-type":e.$route.query.optType},on:{"submit-click":e.submitForm}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"120px",disabled:e.isView}},[t("el-form-item",{attrs:{label:"系统名称",prop:"name"}},[t("el-input",{attrs:{maxlength:"24","show-word-limit":""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"==typeof t?t.trim():t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"接入应用",prop:"appId"}},[t("el-select",{attrs:{clearable:"",placeholder:"",filterable:""},model:{value:e.ruleForm.appId,callback:function(t){e.$set(e.ruleForm,"appId",t)},expression:"ruleForm.appId"}},e._l(e.options,(function(e){return t("el-option",{key:e.id,attrs:{label:e.appName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"模块URL",prop:"mainUrl"}},[t("el-input",{attrs:{maxlength:"200","show-word-limit":""},model:{value:e.ruleForm.mainUrl,callback:function(t){e.$set(e.ruleForm,"mainUrl","string"==typeof t?t.trim():t)},expression:"ruleForm.mainUrl"}})],1),t("el-form-item",{attrs:{label:"系统介绍内容",prop:"remark"}},[t("el-input",{staticClass:"system-introduction",attrs:{type:"textarea",autosize:"",placeholder:"",maxlength:"200","show-word-limit":""},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark","string"==typeof t?t.trim():t)},expression:"ruleForm.remark"}}),t("div",{staticClass:"clear"})],1),t("el-form-item",{attrs:{label:"系统图标"}},[t("adq-upload-img",{attrs:{disabled:e.isView,action:e.upload,"file-list":e.fileList},on:{uploadSuccess:e.uploadSuccess,closeFileList:function(){e.fileList=[],e.ruleForm.smallIcon=""}}})],1),t("el-form-item",{attrs:{label:"用户资料",prop:"userGuide"}},[t("div",[e.isView?e._e():[t("upload-components",{attrs:{type:"file",disabled:e.isView,action:e.upload,data:e.ruleForm.visibleRange,"file-list":e.manualFileList,"upload-file-type":["xls","xlsx","doc","docx","word","txt","pdf","ppt","pptx","jpg","png","gif","svg","zip","rar"]},on:{uploadSuccess:e.handleFileSuccess,submit:e.uploadDialogSubmit,closeFileList:function(t){e.manualFileList=t,e.ruleForm.userGuide=""}}})],e.manualFileList&&e.manualFileList.length>0?[t("ul",{staticClass:"upload-file-list"},e._l(e.manualFileList,(function(i,r){return t("li",{key:r},[t("div",[t("span",{staticClass:"el-icon-document",staticStyle:{"margin-right":"8px"}}),t("span",{on:{click:function(t){return e.handleFilePreview(i)}}},[e._v(e._s(i.name))])]),t("span",{staticClass:"icon el-icon-error",on:{click:function(t){return e.handleFileRemove(i,[])}}})])})),0)]:e._e()],2)])],1),t("div",{staticClass:"clear"}),t("div",{ref:"downDiv",staticStyle:{display:"none"}})],1)}),[],!1,null,"51d11991",null);t.default=d.exports},e322:function(e,t,i){"use strict";i("8622")}}]);