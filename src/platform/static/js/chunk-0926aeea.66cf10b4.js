(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0926aeea","chunk-0380b8ac"],{6665:function(e,t,o){"use strict";o("6fca")},"6fca":function(e,t,o){var a=o("9a51");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,o("499e").default)("11cdbedb",a,!0,{sourceMap:!1,shadowMode:!1})},"7d90":function(e,t,o){"use strict";o.r(t),o("ac6a");var a=o("be81"),l={props:{tableData:{type:Object,default:function(){}}},components:{SqlEditor:a.default},data:function(){return{placeholder:"输入ctrl+d可格式化",currentsql:"select * from table",list:[],leftParam:"",dialogSync:!1,ruleForm:{slot1:"",slot2:"",slot3:"",slot4:"",slot5:"",slot6:"",slot7:""},rules:{slot1:[{required:!0,message:"请选择",trigger:"change"}],slot2:[{required:!0,message:"请选择",trigger:"change"}],slot3:[{required:!0,message:"请输入",trigger:"blur"}]}}},watch:{tableData:{handler:function(){this.init()},deep:!0}},created:function(){},methods:{viewSql:function(){this.dialogSync=!0},changeTextarea:function(e){this.currentSql=e},init:function(){var e=this;this.list=[],this.tableData.slot4List.length>0?this.tableData.slot4List.forEach((function(t){e.list.push({slot1:e.tableData.slot2,slot2:"",slot3:e.tableData.slot3List.map((function(e){return e.value})).join("_"),slot4:t.value1,slot5:e.tableData.slot5List.map((function(e){return e.value})).join("_"),slot6:"",slot7:2})})):this.list.push({slot1:this.tableData.slot2,slot2:"",slot3:this.tableData.slot3List.map((function(e){return e.value})).join("_"),slot4:"-",slot5:this.tableData.slot5List.map((function(e){return e.value})).join("_"),slot6:"",slot7:2}),this.tableData.slot6.forEach((function(t){e.list.push({slot1:t.slot1,slot2:t.slot2,slot3:e.tableData.slot3List.map((function(e){return e.value})).join("_"),slot4:e.tableData.slot4List[0].value1,slot5:e.tableData.slot5List.map((function(e){return e.value})).join("_"),slot6:"",slot7:2})}))},submitForm:function(){var e=this;return new Promise((function(t){var o=/^[^\u4e00-\u9fa5]+$/,a=e.list.map((function(e){return e.slot2})).some((function(e){return""==e})),l=e.list.map((function(e){return e.slot6})).some((function(e){return""==e})),r=e.list.map((function(e){return e.slot2})).some((function(e){return!o.test(e)})),n=e.list.map((function(e){return e.slot6})).some((function(e){return!o.test(e)}));a?e.$message.warning("指标英文名不可为空"):l?e.$message.warning("结果表名不可为空"):r?e.$message.warning("指标英文名不可有中文"):n?e.$message.warning("结果表名不可有中文"):t("submit")}))},resetForm:function(){this.$refs.ruleForm.resetFields()}}},r=o("2877"),n=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,disabled:"view"===e.$route.query.filter}},[t("el-table-column",{attrs:{prop:"slot1",label:"指标名"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-input",{attrs:{placeholder:"请输入"},model:{value:o.row.slot1,callback:function(t){e.$set(o.row,"slot1",t)},expression:"scope.row.slot1"}})]}}])}),t("el-table-column",{attrs:{prop:"slot2",label:"指标英文名"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-input",{attrs:{placeholder:"必填，不能为中文"},model:{value:o.row.slot2,callback:function(t){e.$set(o.row,"slot2",t)},expression:"scope.row.slot2"}})]}}])}),t("el-table-column",{attrs:{prop:"slot3",label:"统计粒度"}}),t("el-table-column",{attrs:{prop:"slot4",label:"统计周期"}}),t("el-table-column",{attrs:{prop:"slot5",label:"业务限定"}}),t("el-table-column",{attrs:{prop:"slot6",label:"结果表名"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-input",{attrs:{placeholder:"必填，不能为中文"},model:{value:o.row.slot6,callback:function(t){e.$set(o.row,"slot6",t)},expression:"scope.row.slot6"}})]}}])}),t("el-table-column",{attrs:{prop:"slot7",label:"结果表更新策略"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",{staticStyle:{padding:"0 4px"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:o.row.slot7,callback:function(t){e.$set(o.row,"slot7",t)},expression:"scope.row.slot7"}},[t("el-option",{attrs:{label:"全量",value:1}}),t("el-option",{attrs:{label:"增量",value:2}})],1)],1)]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("i",{staticClass:"icon iconfontzbxt icon-chakanSQL",staticStyle:{cursor:"pointer",color:"#409eff","font-size":"15px"},attrs:{title:"查看sql"},on:{click:function(t){return e.viewSql(o.row)}}})]}}])})],1),t("el-dialog",{attrs:{title:"SQL预览",visible:e.dialogSync,width:"600px"},on:{"update:visible":function(t){e.dialogSync=t}}},[e.currentsql?t("SqlEditor",{ref:"sqleditor",attrs:{value:e.currentsql,placeholder:e.placeholder,readOnly:!0},on:{changeTextarea:function(t){return e.changeTextarea(t)}}}):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogSync=!1}}},[e._v("关闭")])],1)],1)],1)}),[],!1,null,"dceda0b0",null);t.default=n.exports},"9a51":function(e,t,o){(e.exports=o("2350")(!1)).push([e.i,"[data-v-cfaba83a] .CodeMirror{color:#000;direction:ltr;line-height:22px;border:1px solid #e7e7e7}[data-v-cfaba83a] .CodeMirror pre.CodeMirror-placeholder{color:#929292;font-size:15px}",""])},b866:function(e,t,o){var a=o("d131");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,o("499e").default)("3875f97e",a,!0,{sourceMap:!1,shadowMode:!1})},be81:function(e,t,o){"use strict";o.r(t),o("b866"),o("a7be"),o("f6b6"),o("d7d5");var a=o("db05"),l=o.n(a),r=o("56b3");o("8c33"),o("31c5"),o("ffda"),o("9b74"),o("991c");var n={data:function(){return{editor:null}},props:{value:{type:String,default:""},sqlStyle:{type:String,default:"default"},readOnly:{type:[Boolean,String]},placeholder:{type:String,default:""}},watch:{newVal:function(e,t){this.editor&&this.$emit("changeTextarea",this.editor.getValue())}},computed:{newVal:function(){if(this.editor)return this.editor.getValue()},isView:function(){return"view"===this.$route.query.filter}},mounted:function(){this.initCodeMirror()},methods:{formaterSql:function(){this.editor.setValue(l.a.format(this.editor.getValue()))},initCodeMirror:function(){var e=this,t=this;this.editor=r.fromTextArea(this.$refs.mycode,{value:this.value,mode:"text/x-mariadb",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,cursorHeight:1,lineWrapping:!0,readOnly:this.readOnly,theme:"idea",autofocus:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},gutters:["myGutter","CodeMirror-linenumbers"],gutterWidth:40}),this.editor.on("inputRead",(function(){e.editor.showHint()})),this.editor.setOption("extraKeys",{"Ctrl-D":function(e){t.formaterSql()}})},setVal:function(){this.editor&&(""===this.value?this.editor.setValue(""):this.editor.setValue(this.value))}}},s=(o("6665"),o("2877")),i=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticStyle:{border:"1px solid #409eff"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"mycode",staticClass:"codesql",attrs:{placeholder:e.placeholder},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}})])}),[],!1,null,"cfaba83a",null);t.default=i.exports},d131:function(e,t,o){(e.exports=o("2350")(!1)).push([e.i,".cm-s-idea span.cm-meta{color:olive}.cm-s-idea span.cm-number{color:#00f}.cm-s-idea span.cm-keyword{line-height:1em;font-weight:700;color:navy}.cm-s-idea span.cm-atom{font-weight:700;color:navy}.cm-s-idea span.cm-def,.cm-s-idea span.cm-operator,.cm-s-idea span.cm-property,.cm-s-idea span.cm-type,.cm-s-idea span.cm-variable,.cm-s-idea span.cm-variable-2,.cm-s-idea span.cm-variable-3{color:#000}.cm-s-idea span.cm-comment{color:grey}.cm-s-idea span.cm-string,.cm-s-idea span.cm-string-2{color:green}.cm-s-idea span.cm-qualifier{color:#555}.cm-s-idea span.cm-error{color:red}.cm-s-idea span.cm-attribute{color:#00f}.cm-s-idea span.cm-tag{color:navy}.cm-s-idea span.cm-link{color:#00f}.cm-s-idea .CodeMirror-activeline-background{background:#fffae3}.cm-s-idea span.cm-builtin{color:#30a}.cm-s-idea span.cm-bracket{color:#cc7}.cm-s-idea{font-family:Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif}.cm-s-idea .CodeMirror-matchingbracket{outline:1px solid grey;color:#000!important}.CodeMirror-hints.idea{font-family:Menlo,Monaco,Consolas,Courier New,monospace;color:#616569;background-color:#ebf3fd!important}.CodeMirror-hints.idea .CodeMirror-hint-active{background-color:#a2b8c9!important;color:#5c6065!important}",""])},d7d5:function(e,t,o){!function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function o(e){t(e);var o=e.state.placeholder=document.createElement("pre");o.style.cssText="height: 0; overflow: visible",o.style.direction=e.getOption("direction"),o.className="CodeMirror-placeholder CodeMirror-line-like";var a=e.getOption("placeholder");"string"==typeof a&&(a=document.createTextNode(a)),o.appendChild(a),e.display.lineSpace.insertBefore(o,e.display.lineSpace.firstChild)}function a(e){r(e)&&o(e)}function l(e){var a=e.getWrapperElement(),l=r(e);a.className=a.className.replace(" CodeMirror-empty","")+(l?" CodeMirror-empty":""),l?o(e):t(e)}function r(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",(function(r,n,s){var i=s&&s!=e.Init;if(n&&!i)r.on("blur",a),r.on("change",l),r.on("swapDoc",l),e.on(r.getInputField(),"compositionupdate",r.state.placeholderCompose=function(){!function(e){setTimeout((function(){var a=!1;if(1==e.lineCount()){var l=e.getInputField();a="TEXTAREA"==l.nodeName?!e.getLine(0).length:!/[^\u200b]/.test(l.querySelector(".CodeMirror-line").textContent)}a?o(e):t(e)}),20)}(r)}),l(r);else if(!n&&i){r.off("blur",a),r.off("change",l),r.off("swapDoc",l),e.off(r.getInputField(),"compositionupdate",r.state.placeholderCompose),t(r);var c=r.getWrapperElement();c.className=c.className.replace(" CodeMirror-empty","")}n&&!r.hasFocus()&&a(r)}))}(o("56b3"))}}]);