(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3b964058","chunk-0926aeea","chunk-0380b8ac","chunk-2d0b9209"],{"322f":function(t,e,o){"use strict";o.r(e),o("8e6e"),o("ac6a"),o("456d");var i=o("ade3"),a=(o("20d6"),o("2f62"));function r(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)}return o}var n={data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],databaseList:[{label:"前置库",options:[]},{label:"",options:[]}],title:"view"===this.$route.query.filter?"查看派生指标":this.$route.query.id?"编辑派生指标":"新增派生指标",permission:[],process:[{id:"configStep",title:"配置派生指标",success:!0},{id:"submitStep",title:"提交派生指标",success:!0}]}},computed:{hasNext:function(){var t=this;return this.permission.findIndex((function(e){return e===t.stepActiveId}))+1<this.permission.length},hasPre:function(){var t=this;return this.permission.findIndex((function(e){return e===t.stepActiveId}))>0}},methods:function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach((function(e){Object(i.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},Object(a.b)("fusionTask",["GET_DATA_BASE_LIST","GET_STEP_HEADERR"])),created:function(){}};e.default=n},"4bcaf":function(t,e,o){(t.exports=o("2350")(!1)).push([t.i,".custom-steps[data-v-77383022]{height:80px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.custom-steps[data-v-77383022],.custom-steps>div[data-v-77383022]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.custom-steps>div[data-v-77383022]{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.custom-steps .active .content .num[data-v-77383022]{background:#409eff;color:#fff}.custom-steps .active .content .title[data-v-77383022]{color:#409eff;width:100px;text-align:center}.custom-steps .active .content .num[data-v-77383022]{width:35px;height:35px;line-height:35px;text-align:center;border-radius:35px}.custom-steps .content[data-v-77383022]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap;width:150px;font-size:15px;cursor:pointer}.custom-steps .content .num[data-v-77383022]{width:30px;height:30px;line-height:30px;text-align:center;border-radius:30px;background:#b3b3b3;color:#fff;-webkit-transition:all .2s ease-in;transition:all .2s ease-in}.custom-steps .content .title[data-v-77383022]{padding-top:5px;color:#b3b3b3}.custom-steps .line[data-v-77383022]{height:23px;border-top:2px solid #c5c5c5;width:100px}[data-v-77383022] .el-steps{width:140px}.overflow-one-lines[data-v-77383022]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;overflow:hidden;text-overflow:ellipsis}[data-v-77383022] .el-table__body-wrapper,[data-v-77383022] .el-table__header-wrapper{border-left:1px solid #eee;border-right:1px solid #eee}[data-v-77383022] .el-table__header-wrapper{border-top:1px solid #eee}[data-v-77383022] .el-badge__content.is-fixed,[data-v-77383022] .el-badge__content.is-fixed.is-dot{right:-14px!important;top:2px!important}[data-v-77383022] .el-badge__content.is-fixed{-webkit-transition:all 0s!important;transition:all 0s!important}",""])},6665:function(t,e,o){"use strict";o("6fca")},"6adf":function(t,e,o){"use strict";o("ce89")},"6fca":function(t,e,o){var i=o("9a51");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,o("499e").default)("11cdbedb",i,!0,{sourceMap:!1,shadowMode:!1})},"7d90":function(t,e,o){"use strict";o.r(e),o("ac6a");var i=o("be81"),a={props:{tableData:{type:Object,default:function(){}}},components:{SqlEditor:i.default},data:function(){return{placeholder:"输入ctrl+d可格式化",currentsql:"select * from table",list:[],leftParam:"",dialogSync:!1,ruleForm:{slot1:"",slot2:"",slot3:"",slot4:"",slot5:"",slot6:"",slot7:""},rules:{slot1:[{required:!0,message:"请选择",trigger:"change"}],slot2:[{required:!0,message:"请选择",trigger:"change"}],slot3:[{required:!0,message:"请输入",trigger:"blur"}]}}},watch:{tableData:{handler:function(){this.init()},deep:!0}},created:function(){},methods:{viewSql:function(){this.dialogSync=!0},changeTextarea:function(t){this.currentSql=t},init:function(){var t=this;this.list=[],this.tableData.slot4List.length>0?this.tableData.slot4List.forEach((function(e){t.list.push({slot1:t.tableData.slot2,slot2:"",slot3:t.tableData.slot3List.map((function(t){return t.value})).join("_"),slot4:e.value1,slot5:t.tableData.slot5List.map((function(t){return t.value})).join("_"),slot6:"",slot7:2})})):this.list.push({slot1:this.tableData.slot2,slot2:"",slot3:this.tableData.slot3List.map((function(t){return t.value})).join("_"),slot4:"-",slot5:this.tableData.slot5List.map((function(t){return t.value})).join("_"),slot6:"",slot7:2}),this.tableData.slot6.forEach((function(e){t.list.push({slot1:e.slot1,slot2:e.slot2,slot3:t.tableData.slot3List.map((function(t){return t.value})).join("_"),slot4:t.tableData.slot4List[0].value1,slot5:t.tableData.slot5List.map((function(t){return t.value})).join("_"),slot6:"",slot7:2})}))},submitForm:function(){var t=this;return new Promise((function(e){var o=/^[^\u4e00-\u9fa5]+$/,i=t.list.map((function(t){return t.slot2})).some((function(t){return""==t})),a=t.list.map((function(t){return t.slot6})).some((function(t){return""==t})),r=t.list.map((function(t){return t.slot2})).some((function(t){return!o.test(t)})),n=t.list.map((function(t){return t.slot6})).some((function(t){return!o.test(t)}));i?t.$message.warning("指标英文名不可为空"):a?t.$message.warning("结果表名不可为空"):r?t.$message.warning("指标英文名不可有中文"):n?t.$message.warning("结果表名不可有中文"):e("submit")}))},resetForm:function(){this.$refs.ruleForm.resetFields()}}},r=o("2877"),n=Object(r.a)(a,(function(){var t=this,e=t._self._c;return e("div",[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,disabled:"view"===t.$route.query.filter}},[e("el-table-column",{attrs:{prop:"slot1",label:"指标名"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-input",{attrs:{placeholder:"请输入"},model:{value:o.row.slot1,callback:function(e){t.$set(o.row,"slot1",e)},expression:"scope.row.slot1"}})]}}])}),e("el-table-column",{attrs:{prop:"slot2",label:"指标英文名"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-input",{attrs:{placeholder:"必填，不能为中文"},model:{value:o.row.slot2,callback:function(e){t.$set(o.row,"slot2",e)},expression:"scope.row.slot2"}})]}}])}),e("el-table-column",{attrs:{prop:"slot3",label:"统计粒度"}}),e("el-table-column",{attrs:{prop:"slot4",label:"统计周期"}}),e("el-table-column",{attrs:{prop:"slot5",label:"业务限定"}}),e("el-table-column",{attrs:{prop:"slot6",label:"结果表名"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-input",{attrs:{placeholder:"必填，不能为中文"},model:{value:o.row.slot6,callback:function(e){t.$set(o.row,"slot6",e)},expression:"scope.row.slot6"}})]}}])}),e("el-table-column",{attrs:{prop:"slot7",label:"结果表更新策略"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("div",{staticStyle:{padding:"0 4px"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:o.row.slot7,callback:function(e){t.$set(o.row,"slot7",e)},expression:"scope.row.slot7"}},[e("el-option",{attrs:{label:"全量",value:1}}),e("el-option",{attrs:{label:"增量",value:2}})],1)],1)]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("i",{staticClass:"icon iconfontzbxt icon-chakanSQL",staticStyle:{cursor:"pointer",color:"#409eff","font-size":"15px"},attrs:{title:"查看sql"},on:{click:function(e){return t.viewSql(o.row)}}})]}}])})],1),e("el-dialog",{attrs:{title:"SQL预览",visible:t.dialogSync,width:"600px"},on:{"update:visible":function(e){t.dialogSync=e}}},[t.currentsql?e("SqlEditor",{ref:"sqleditor",attrs:{value:t.currentsql,placeholder:t.placeholder,readOnly:!0},on:{changeTextarea:function(e){return t.changeTextarea(e)}}}):t._e(),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogSync=!1}}},[t._v("关闭")])],1)],1)],1)}),[],!1,null,"dceda0b0",null);e.default=n.exports},"9a51":function(t,e,o){(t.exports=o("2350")(!1)).push([t.i,"[data-v-cfaba83a] .CodeMirror{color:#000;direction:ltr;line-height:22px;border:1px solid #e7e7e7}[data-v-cfaba83a] .CodeMirror pre.CodeMirror-placeholder{color:#929292;font-size:15px}",""])},ab0f:function(t,e,o){"use strict";o.r(e),o("8e6e"),o("ac6a"),o("456d");var i=o("ade3"),a=o("2f62"),r=o("322f"),n=o("5660"),s=o("7d90");function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach((function(e){Object(i.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var u={mixins:[r.default],data:function(){return{stepActiveId:"configStep",tableData:{},filter:"edit"==this.$route.query.filter}},computed:{},components:{configStep:n.default,submitStep:s.default},created:function(){},methods:c(c({},Object(a.b)(["_AJAX"])),{},{clone:function(t){return JSON.parse(JSON.stringify(t))},cancel:function(){this.$router.push("/wdglLdit")},next:function(){var t=this;this.$refs[this.stepActiveId].submitForm().then((function(e){t.tableData=e,t.stepActiveId="submitStep"})).catch((function(t){}))},save:function(){this.$refs[this.stepActiveId].submitForm().then((function(){}))},pre:function(){this.stepActiveId="configStep"},backTo:function(t){this.stepActiveId=t.id},submit:function(){0!==this.$refs.submitStep.list.length?this.$refs[this.stepActiveId].submitForm().then((function(){})):this.$message.warning("暂无可提交数据，请先在第一步配置派生指标")}})},d=(o("6adf"),o("2877")),p=Object(d.a)(u,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("audaque-detail-form-page",{directives:[{name:"loading",rawName:"v-loading",value:t.$store.state.fusionTask.isLoading,expression:"$store.state.fusionTask.isLoading"}],attrs:{title:t.title,"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.95)"}},[t.process.length>0?e("div",{staticClass:"custom-steps"},t._l(t.process,(function(o,i){return e("div",{key:i,class:[o.success?"success":"",""!==o.id&&o.id==t.stepActiveId?"active":""]},[e("div",{staticClass:"content",on:{click:function(e){return t.backTo(o)}}},[e("div",{staticClass:"num"},[t._v(t._s(i+1))]),e("div",{staticClass:"title overflow-one-lines",attrs:{title:o.title}},[t._v(t._s(o.title))])]),i<t.process.length-1?e("div",{staticClass:"line"}):t._e()])})),0):t._e(),e("configStep",{directives:[{name:"show",rawName:"v-show",value:"configStep"===t.stepActiveId,expression:"stepActiveId === 'configStep'"}],ref:"configStep"}),e("submitStep",{directives:[{name:"show",rawName:"v-show",value:"submitStep"===t.stepActiveId,expression:"stepActiveId === 'submitStep'"}],ref:"submitStep",attrs:{tableData:t.tableData}}),e("template",{slot:"bottom"},[e("div",{staticClass:"footer"},[[e("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:t.cancel}},[t._v("取消")]),"submitStep"==t.stepActiveId?[e("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:t.pre}},[t._v("上一步")])]:t._e(),"configStep"==t.stepActiveId?[e("el-button",{key:1,staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:t.next}},[t._v("下一步")])]:t._e(),"submitStep"==t.stepActiveId&&"view"!==t.$route.query.filter?[e("el-button",{key:2,staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])]:t._e()]],2)])],2)}),[],!1,null,"77383022",null);e.default=p.exports},b866:function(t,e,o){var i=o("d131");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,o("499e").default)("3875f97e",i,!0,{sourceMap:!1,shadowMode:!1})},be81:function(t,e,o){"use strict";o.r(e),o("b866"),o("a7be"),o("f6b6"),o("d7d5");var i=o("db05"),a=o.n(i),r=o("56b3");o("8c33"),o("31c5"),o("ffda"),o("9b74"),o("991c");var n={data:function(){return{editor:null}},props:{value:{type:String,default:""},sqlStyle:{type:String,default:"default"},readOnly:{type:[Boolean,String]},placeholder:{type:String,default:""}},watch:{newVal:function(t,e){this.editor&&this.$emit("changeTextarea",this.editor.getValue())}},computed:{newVal:function(){if(this.editor)return this.editor.getValue()},isView:function(){return"view"===this.$route.query.filter}},mounted:function(){this.initCodeMirror()},methods:{formaterSql:function(){this.editor.setValue(a.a.format(this.editor.getValue()))},initCodeMirror:function(){var t=this,e=this;this.editor=r.fromTextArea(this.$refs.mycode,{value:this.value,mode:"text/x-mariadb",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,cursorHeight:1,lineWrapping:!0,readOnly:this.readOnly,theme:"idea",autofocus:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},gutters:["myGutter","CodeMirror-linenumbers"],gutterWidth:40}),this.editor.on("inputRead",(function(){t.editor.showHint()})),this.editor.setOption("extraKeys",{"Ctrl-D":function(t){e.formaterSql()}})},setVal:function(){this.editor&&(""===this.value?this.editor.setValue(""):this.editor.setValue(this.value))}}},s=(o("6665"),o("2877")),l=Object(s.a)(n,(function(){var t=this,e=t._self._c;return e("div",{staticStyle:{border:"1px solid #409eff"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"mycode",staticClass:"codesql",attrs:{placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])}),[],!1,null,"cfaba83a",null);e.default=l.exports},ce89:function(t,e,o){var i=o("4bcaf");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,o("499e").default)("6890d9b4",i,!0,{sourceMap:!1,shadowMode:!1})},d131:function(t,e,o){(t.exports=o("2350")(!1)).push([t.i,".cm-s-idea span.cm-meta{color:olive}.cm-s-idea span.cm-number{color:#00f}.cm-s-idea span.cm-keyword{line-height:1em;font-weight:700;color:navy}.cm-s-idea span.cm-atom{font-weight:700;color:navy}.cm-s-idea span.cm-def,.cm-s-idea span.cm-operator,.cm-s-idea span.cm-property,.cm-s-idea span.cm-type,.cm-s-idea span.cm-variable,.cm-s-idea span.cm-variable-2,.cm-s-idea span.cm-variable-3{color:#000}.cm-s-idea span.cm-comment{color:grey}.cm-s-idea span.cm-string,.cm-s-idea span.cm-string-2{color:green}.cm-s-idea span.cm-qualifier{color:#555}.cm-s-idea span.cm-error{color:red}.cm-s-idea span.cm-attribute{color:#00f}.cm-s-idea span.cm-tag{color:navy}.cm-s-idea span.cm-link{color:#00f}.cm-s-idea .CodeMirror-activeline-background{background:#fffae3}.cm-s-idea span.cm-builtin{color:#30a}.cm-s-idea span.cm-bracket{color:#cc7}.cm-s-idea{font-family:Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif}.cm-s-idea .CodeMirror-matchingbracket{outline:1px solid grey;color:#000!important}.CodeMirror-hints.idea{font-family:Menlo,Monaco,Consolas,Courier New,monospace;color:#616569;background-color:#ebf3fd!important}.CodeMirror-hints.idea .CodeMirror-hint-active{background-color:#a2b8c9!important;color:#5c6065!important}",""])},d7d5:function(t,e,o){!function(t){function e(t){t.state.placeholder&&(t.state.placeholder.parentNode.removeChild(t.state.placeholder),t.state.placeholder=null)}function o(t){e(t);var o=t.state.placeholder=document.createElement("pre");o.style.cssText="height: 0; overflow: visible",o.style.direction=t.getOption("direction"),o.className="CodeMirror-placeholder CodeMirror-line-like";var i=t.getOption("placeholder");"string"==typeof i&&(i=document.createTextNode(i)),o.appendChild(i),t.display.lineSpace.insertBefore(o,t.display.lineSpace.firstChild)}function i(t){r(t)&&o(t)}function a(t){var i=t.getWrapperElement(),a=r(t);i.className=i.className.replace(" CodeMirror-empty","")+(a?" CodeMirror-empty":""),a?o(t):e(t)}function r(t){return 1===t.lineCount()&&""===t.getLine(0)}t.defineOption("placeholder","",(function(r,n,s){var l=s&&s!=t.Init;if(n&&!l)r.on("blur",i),r.on("change",a),r.on("swapDoc",a),t.on(r.getInputField(),"compositionupdate",r.state.placeholderCompose=function(){!function(t){setTimeout((function(){var i=!1;if(1==t.lineCount()){var a=t.getInputField();i="TEXTAREA"==a.nodeName?!t.getLine(0).length:!/[^\u200b]/.test(a.querySelector(".CodeMirror-line").textContent)}i?o(t):e(t)}),20)}(r)}),a(r);else if(!n&&l){r.off("blur",i),r.off("change",a),r.off("swapDoc",a),t.off(r.getInputField(),"compositionupdate",r.state.placeholderCompose),e(r);var c=r.getWrapperElement();c.className=c.className.replace(" CodeMirror-empty","")}n&&!r.hasFocus()&&i(r)}))}(o("56b3"))}}]);