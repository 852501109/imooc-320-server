(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5b9e31c4","chunk-58ea2247","chunk-7a416bf5","chunk-3c2a0cd6","chunk-382a01c4","chunk-2d20f585"],{"0577":function(e,t,a){"use strict";a.r(t),a("6762"),a("2fdb"),a("a481"),a("8e6e"),a("ac6a"),a("456d"),a("c5f6"),a("7514"),a("6b54");var r=a("ade3"),s=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var n={props:{show:{type:Boolean,default:!1},currentSelectDatabase:{type:Object,default:function(){}},currentLayerValue:{type:String,default:""},selectParam:{type:Object,default:function(){}},currentType:{type:Object,default:function(){}}},data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],datas:[],templateSelection:"",tableData:[],selectedRow:null,multipleSelection:[],defaultProps:{label:"name",children:"children"},treeExpandData:[],searchText:"",param:{code:"",type:"",tagId:null,tableNameOrComment:"",page:1,rows:10,total:0}}},components:{},computed:{},mounted:function(){this.init(),this.$nextTick((function(){document.querySelector(".pane-comp")&&(document.querySelector(".pane-comp").style.width="177px")}))},methods:o(o(o({},Object(s.b)("fusionTask",["GET_TREE"])),Object(s.b)(["_AJAX"])),{},{init:function(){var e=this;this.$nextTick((function(){var t=document.querySelector(".custom-container");t&&(t.style.height=t.clientHeight+"px",e.getTree().then((function(){e.selectCurrent()})))}))},selectCurrent:function(){this.param.page=1,this.param.rows=10,this.param.code=this.currentSelectDatabase.code,this.param.type=this.currentSelectDatabase.type,this.param.tagId=null,this.param.tableNameOrComment="",this.getTable()},getTree:function(){var e=this;return new Promise((function(t,a){e.param.tableNameOrComment="",e.GET_TREE().then((function(a){e.datas=a||[],e.treeExpandData.push("1"),t(a)})).catch((function(e){a(e)}))}))},onSearch:function(){this.getTable()},getTable:function(){var e=this,t={code:this.param.code,type:this.param.type.toString(),page:this.param.page,rows:this.param.rows,tableNameOrComment:this.param.tableNameOrComment};this.param.tagId&&(t.tagId=this.param.tagId),this._AJAX({url:"task.stepHeader.getTableByDBTag",method:"get",data:t}).then((function(t){e.tableData=t.rows,e.param.total=t.total}))},flattenArray:function(e){for(var t=[],a=0;a<e.length;a++)Array.isArray(e[a])?t=t.concat(this.flattenArray(e[a])):t.push(e[a]);return t},onSubmit:function(){var e=this,t=Array.isArray(this.templateSelection)?this.templateSelection:[this.tableData.find((function(t){return t.id===e.templateSelection}))];if((t=t.filter((function(e){return void 0!==e}))).some((function(e){return 0===e.tableIscreate}))&&this.storey.includes(this.currentSelectDatabase.code))return this.$AudaqueToast.warn({template:"选中的含有未创建表，请前往：模型分层-".concat(this.currentSelectDatabase.label,"中创建"),methods:{okEvent:function(){}}}),!1;var a=this.flattenArray(this.selectParam.sourceRows.map((function(e){return e.alreadySelectSourceTableValue})));if(("au_dwd"===this.currentLayerValue||"au_dwm"===this.currentLayerValue)&&t.some((function(e){return a.includes(e.id)})))return this.$AudaqueToast.warn({template:"当前选中的表与已选中的表有重复值，请重新选择",methods:{okEvent:function(){}}}),!1;this.$emit("submit",t)},isSelectable:function(e){return!0},handleClose:function(){this.$emit("close")},handleRowClick:function(e){this.selectedRow===e?this.selectedRow=null:this.selectedRow=e},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.getTable()},handleCurrentChange:function(e){this.param.page=e,this.getTable()},handleCheckboxChange:function(e){e.checked||(this.selectedRow=null)},rowChang:function(e){this.templateSelection=e.id},handleSelectionChange:function(e){this.templateSelection=e},handleNodeClick:function(e){this.param.code=this.currentSelectDatabase.code,this.param.type=this.currentSelectDatabase.type,this.param.tagId=Number(e.id),this.param.page=1,this.param.rows=10,this.getTable()}})},i=(a("a849"),a("2877")),c=Object(i.a)(n,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"库表选择",visible:e.show,width:"80%","before-close":e.handleClose,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[t("div",{staticClass:"custom-container",staticStyle:{"min-height":"60vh"}},[t("audaque-resize-split-page",[t("template",{slot:"leftPane"},[t("div",{staticStyle:{"padding-left":"24px","white-space":"nowrap",overflow:"hidden"}},[e._v("\n                    当前库："),t("span",{staticStyle:{cursor:"pointer",color:"#409eff"},on:{click:e.selectCurrent}},[e._v(e._s(e.currentSelectDatabase.label)+"--")])]),t("el-tree",{staticClass:"tree-dashed",attrs:{data:e.datas,props:e.defaultProps,"default-expanded-keys":e.treeExpandData,"node-key":"id"},on:{"node-click":e.handleNodeClick}})],1),t("template",{slot:"rightPane"},[t("div",{staticClass:"row",staticStyle:{"margin-bottom":"10px"}},[t("div",{staticStyle:{width:"50%"}},[t("el-input",{attrs:{placeholder:"通过表名，表中文名模糊查询"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.param.tableNameOrComment,callback:function(t){e.$set(e.param,"tableNameOrComment",t)},expression:"param.tableNameOrComment"}})],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("筛选")])],1)]),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"highlight-current-row":""},on:{"row-click":e.rowChang,"selection-change":e.handleSelectionChange}},["au_dwd"!==e.currentLayerValue&&"au_dws"!==e.currentLayerValue||"target"===e.currentType.type?t("el-table-column",{attrs:{align:"center",width:"55",label:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-radio",{staticClass:"radio",attrs:{label:a.row.id},model:{value:e.templateSelection,callback:function(t){e.templateSelection=t},expression:"templateSelection"}},[e._v(" ")])]}}])}):t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{width:"80",prop:"schemaName",label:"数据库名"}}),t("el-table-column",{attrs:{prop:"tableName",label:"表名"}}),t("el-table-column",{attrs:{prop:"tableComment",label:"表中文描述"}}),t("el-table-column",{attrs:{width:"80",prop:"dataNum",label:"数据量"}}),t("el-table-column",{attrs:{width:"100",prop:"tagFullName",label:"元数据标签"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.tagFullName?t("span",{domProps:{innerHTML:e._s(a.row.tagFullName.replace(/;/g,"<br>").replace(/,/g,"→").replace(/;$/,""))}}):e._e()]}}])}),e.storey.includes(e.currentSelectDatabase.code)?t("el-table-column",{attrs:{prop:"tableIscreate",label:"表是否已创建",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(1===t.row.tableIscreate?"已创建":"未创建")+"\n                        ")]}}],null,!1,1411126668)}):e._e()],1),t("adq-pagination",{attrs:{"current-page":e.param.page,total:e.param.total,"page-size":e.param.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)],1),t("div",{staticClass:"dialog-footer row",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{on:{click:e.handleClose}},[e._v("取消")])],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确认")])],1)])])}),[],!1,null,"ec76bff8",null);t.default=c.exports},"107f":function(e,t,a){var r=a("eb30");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("0c781b4e",r,!0,{sourceMap:!1,shadowMode:!1})},"48e2":function(e,t,a){var r=a("710e");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("47011602",r,!0,{sourceMap:!1,shadowMode:!1})},"5d21":function(e,t,a){"use strict";a.r(t),a("7514"),a("6762"),a("2fdb");var r={props:["selectParam","databaseList","isAlreadyStart","stepActiveId","startStep"],data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],numSort:{au_ods:1,au_std:2,au_dwd:3,au_dwm:4,au_dws:5,au_app:6}}},components:{},computed:{comSourceIsDisabled:function(){return function(e){var t=this;return!this.isAlreadyStart&&"0"!==e.type||!!(""!==this.selectParam.targetDatabase&&this.storey.includes(this.selectParam.targetDatabase)&&"1"===e.type&&e.value>this.databaseList[1].options.find((function(e){return e.code===t.selectParam.targetDatabase})).value)}},comTargetIsDisabled:function(){return function(e){var t=this,a=this.selectParam.sourceRows.filter((function(e){return""!==e.sourceDatabase&&"0"!==e.type})),r=a.map((function(e){return t.numSort[e.sourceDatabase]}));if(!(this.isAlreadyStart&&this.stepActiveId!=this.startStep.id||"1"===e.type))return!0;if(0===a.length)return!1;var s=r.reduce((function(e,t){return e>t?e:t}));return"0"!==e.type&&e.value<=s}}},mounted:function(){},methods:{delRow:function(e){this.$emit("delRow",e)},addRow:function(){this.$emit("addRow")},autoCreate:function(){this.$emit("autoCreate")},sourceChange:function(e){this.$emit("sourceChange",e)},targetChange:function(){this.$emit("targetChange")},selectTable:function(e,t){this.$emit("select",e,t)},toHandleCreate:function(){this.$emit("handleCreate")}}},s=(a("7ae7"),a("2877")),l=Object(s.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search"},[e._l(e.selectParam.sourceRows,(function(a,r){return t("div",{key:r,staticClass:"row"},[e._m(0,!0),t("div",[t("el-select",{attrs:{disabled:0===r&&e.isAlreadyStart,placeholder:"请选择",clearable:""},on:{change:function(t){return e.sourceChange(a)}},model:{value:a.sourceDatabase,callback:function(t){e.$set(a,"sourceDatabase",t)},expression:"p.sourceDatabase"}},e._l(e.databaseList,(function(a){return t("el-option-group",{key:a.label,attrs:{label:a.label}},e._l(a.options,(function(a){return t("el-option",{key:a.code,attrs:{label:a.label,value:a.code,disabled:e.comSourceIsDisabled(a)}})})),1)})),1)],1),e._v("\n          \n        "),t("div",[t("el-select",{attrs:{multiple:"",placeholder:"请选择原表",disabled:""},model:{value:a.alreadySelectSourceTableValue,callback:function(t){e.$set(a,"alreadySelectSourceTableValue",t)},expression:"p.alreadySelectSourceTableValue"}},e._l(a.alreadySelectSourceTable,(function(e){return t("el-option",{key:e.id,attrs:{label:e.tableName,value:e.id}})})),1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[e._v("\n              "),t("el-button",{attrs:{disabled:0===r&&e.isAlreadyStart,type:"primary"},on:{click:function(t){return e.selectTable("source",r)}}},[e._v("选择")])],1)])})),t("div",{staticClass:"row"},[e._m(1),t("div",[t("el-select",{attrs:{disabled:e.isAlreadyStart,placeholder:"请选择",clearable:""},on:{change:e.targetChange},model:{value:e.selectParam.targetDatabase,callback:function(t){e.$set(e.selectParam,"targetDatabase",t)},expression:"selectParam.targetDatabase"}},e._l(e.databaseList,(function(a){return t("el-option-group",{key:a.label,attrs:{label:a.label}},e._l(a.options,(function(a){return t("el-option",{key:a.code,attrs:{label:a.label,value:a.code,disabled:e.comTargetIsDisabled(a)}})})),1)})),1)],1),e._v("\n          \n        "),e.selectParam.autoCreate?e._e():t("div",[t("el-select",{attrs:{multiple:"",placeholder:"请选择目标表",disabled:""},model:{value:e.selectParam.alreadySelectTargetTableValue,callback:function(t){e.$set(e.selectParam,"alreadySelectTargetTableValue",t)},expression:"selectParam.alreadySelectTargetTableValue"}},e._l(e.selectParam.alreadySelectTargetTable,(function(e){return t("el-option",{key:e.id,attrs:{label:e.tableName,value:e.id}})})),1)],1),e._v("\n          "),e.selectParam.autoCreate?e._e():t("el-button",{attrs:{disabled:e.isAlreadyStart,type:"primary"},on:{click:function(t){return e.selectTable("target")}}},[e._v("选择")]),t("div",[t("el-popconfirm",{attrs:{title:"确定自动建表吗？"},on:{confirm:e.autoCreate}},[t("span",{directives:[{name:"show",rawName:"v-show",value:"au_dwd"!==e.selectParam.targetDatabase&&"au_dws"!==e.selectParam.targetDatabase&&""!==e.selectParam.targetDatabase,expression:"\n                        selectParam.targetDatabase !== 'au_dwd' &&\n                        selectParam.targetDatabase !== 'au_dws' &&\n                        selectParam.targetDatabase !== ''\n                    "}],staticStyle:{color:"#409eff",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[e._v("    ")])])],1)],1)],2)}),[function(){var e=this._self._c;return e("div",{staticClass:"label"},[e("span",{staticClass:"require"},[this._v("*")]),this._v("源数据层")])},function(){var e=this._self._c;return e("div",{staticClass:"label"},[e("span",{staticClass:"require"},[this._v("*")]),this._v("目标数据层")])}],!1,null,"285f502b",null);t.default=l.exports},6093:function(e,t,a){"use strict";a.r(t),a("8e6e"),a("456d"),a("5df3"),a("4f7f");var r=a("2909"),s=(a("6762"),a("2fdb"),a("a481"),a("c5f6"),a("ac6a"),a("7514"),a("ade3")),l=a("5d21"),o=a("0577"),n=a("be6f"),i=a("e10e"),c=a("2f62");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(s.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={mixins:[a("b2dc").default],data:function(){return{customData:[],tableShow:!1,taskId:this.$route.query.taskId,stepId:this.$route.query.stepId,autoMapValue:!1,param:{page:1,rows:10,whereCondition:"",tableData:[],asyncConfig:2,growField:""},taskStep:{id:this.$route.query.stepId,taskId:this.$route.query.taskId,autoCreateTab:0,isAutoCreate:!1,taskStepDetail:{id:null,stepId:null,sourceTableId:null,targetTableId:null,sqlContent:"",whereCondition:"",taskRuleRelList:[],asyncConfig:1,growField:""}},rules:{sourceDatabase:[{required:!0,message:"请选择",trigger:"change"}]},storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],currentSelectDatabase:{},targetName:"",sqlResponse:{},showAutoCreate:!1,showHandleCreate:!1,showTableSelectionPage:!1,selectParam:{targetDatabase:"",alreadySelectTargetTable:[],alreadySelectTargetTableValue:[],isAutoCreate:!1,sourceRows:[{sourceDatabase:"",alreadySelectSourceTable:[],alreadySelectSourceTableValue:[]}]},histories:[],currentType:{type:"",index:""},nextActive:"",stepActiveId:""}},computed:d(d({},Object(c.d)("dataFusionTask",["fusionStrategyOptions","sourceColumnList","tableDataYSYY","tableColumnData","stepAndDetail"])),{},{currentLayerValue:function(){return this.selectParam?this.selectParam.targetDatabase:""},isAlreadyStart:function(){return this.process[0]&&this.process[0].success},startStep:function(){return this.process[0]&&this.process[0].success?this.process[0]:{}}}),components:{searchGroup:l.default,tableSelectionPage:o.default,autoCreate:n.default,handleCreate:i.default},created:function(){this.stepId&&this.handleStep(this.stepId)},methods:d(d(d({},Object(c.b)(["_AJAX"])),Object(c.b)("dataFusionTask",["GETFUSIONSTRATEGY_LIST","GETSOURCECOLUMNLIST","GETYSYYTABLEDATA","GETCOLUMNSORTDATA","UPDATESORT","INSERTSORT","DELSORT","ADDSTEP","UPDATESTEP","QUERYSTEPANDDETAIL"])),{},{initAutoCreate:function(e){e.tableId&&(this.selectParam.alreadySelectTargetTableValue=[e.tableId],this.selectParam.alreadySelectTargetTable=[{id:e.tableId,tableName:e.newTableName}],this.selectParam.isAutoCreate=!0)},backTo:function(e){if(e&&e.id){this.stepActiveId=e.id;var t=e.stepDetailList[0],a=e.stepDetailList.reduce((function(e,t){var a=e.find((function(e){return e.sourceDatabase===t.sourceDbCode}));return a?(a.alreadySelectSourceTable.push({id:t.sourceTableId,tableName:t.sourceTableName}),a.alreadySelectSourceTableValue.push(t.sourceTableId)):e.push({sourceDatabase:t.sourceDbCode,alreadySelectSourceTable:[{id:t.sourceTableId,tableName:t.sourceTableName}],alreadySelectSourceTableValue:[t.sourceTableId]}),e}),[]);this.selectParam={targetDatabase:t.targetDbCode,alreadySelectTargetTable:[{id:t.targetTableId,tableName:t.targetTableName}],alreadySelectTargetTableValue:[t.targetTableId],isAutoCreate:!1,sourceRows:a}}},initHandleCreate:function(e){e.id&&(this.selectParam.alreadySelectTargetTableValue=[e.id],this.selectParam.alreadySelectTargetTable=[{id:e.id,tableName:e.tableName}],this.showHandleCreate=!1)},initMap:function(e){var t=this,a=this.currentType.type,r=this.currentType.index;if(e.length>0){if("source"===a&&(this.selectParam.sourceRows[r].alreadySelectSourceTable=e,this.selectParam.sourceRows[r].alreadySelectSourceTableValue=e.map((function(e){return e.id}))),"target"===a){if(this.selectParam.alreadySelectTargetTableValue[0]===e.map((function(e){return e.id}))[0])return void(this.showTableSelectionPage=!1);this.selectParam.alreadySelectTargetTable=e,this.selectParam.alreadySelectTargetTableValue=e.map((function(e){return e.id})),this.selectParam.isAutoCreate=!1}this.selectParam.alreadySelectTargetTable.length>0&&this.selectParam.sourceRows[0].alreadySelectSourceTable.length>0&&(this.GETSOURCECOLUMNLIST({sourceTableId:this.selectParam.sourceRows[0].alreadySelectSourceTable[0].id,targetTableId:this.selectParam.alreadySelectTargetTable[0].id}).then((function(){t.customData=t.sourceColumnList[t.selectParam.sourceRows[0].alreadySelectSourceTable[0].id]})),this.tableShow=!0)}this.showTableSelectionPage=!1},change:function(e,t){var a={};a.sourceColumnId=e.id,a.targetColumnId=e.targetColumnCode,a.taskId=this.taskId,a.catCode="FUSION_STRATEGY",this.taskStep.taskStepDetail.taskRuleRelList.push(a)},handleStep:function(){var e=this,t=this;t.QUERYSTEPANDDETAIL({taskId:t.taskId,id:t.stepId}).then((function(){t.param.whereCondition=e.stepAndDetail.taskStepDetail.whereCondition,t.param.growField=e.stepAndDetail.increaseField,t.param.asyncConfig=e.stepAndDetail.syncType,t.GETSOURCECOLUMNLIST({sourceTableId:t.stepAndDetail.taskStepDetail.sourceTableId,targetTableId:t.stepAndDetail.taskStepDetail.targetTableId}).then((function(){t.customData=t.sourceColumnList[t.stepAndDetail.taskStepDetail.sourceTableId],setTimeout((function(){t.tableShow=!0,t.customData.forEach((function(e,a){var r=t.stepAndDetail.taskStepDetail.taskRuleRelList.find((function(t){return t.sourceColumnId===e.id}));if(null!=r){var s=t.deepClone(r);e.targetColumnCode=s.targetColumnId,null!=s.targetColumnId&&t.$set(t.customData[a],"targetColumnCode",Number(s.targetColumnId)),t.$set(t.customData[a],"ruleId",s.ruleId+"")}}))}),200)}))}))},Automaticmapping:function(e){var t=this;e?this.customData.forEach((function(e){var a=t.sourceColumnList[t.selectParam.alreadySelectTargetTable[0].id].find((function(t){return t.columnName.toLowerCase().replace(/_/g,"")===e.columnName.toLowerCase().replace(/_/g,"")||e.columnName.toLowerCase().replace(/_/g,"")===t.columnName.toLowerCase().replace(/_/g,"")}));e.targetColumnCode=a?a.id:"";var r={};r.sourceColumnId=e.id,r.targetColumnId=e.targetColumnCode,r.taskId=t.taskId,r.catCode="FUSION_STRATEGY",t.taskStep.taskStepDetail.taskRuleRelList.push(r)})):this.customData.forEach((function(e){e.targetColumnCode=""}))},deepClone:function(e){return JSON.parse(JSON.stringify(e))},addSourceRow:function(){this.selectParam.sourceRows.push({sourceDatabase:"",alreadySelectSourceTableValue:[],alreadySelectSourceTable:[]})},delSourceRow:function(e){this.selectParam.sourceRows.splice(e,1)},clone:function(e){return JSON.parse(JSON.stringify(e))},handleSourceChange:function(e){this.tableShow=!1,this.$set(e,"alreadySelectSourceTable",[]),this.$set(e,"alreadySelectSourceTableValue",[])},handleTargetChange:function(){this.tableShow=!1,this.selectParam.alreadySelectTargetTable=[],this.selectParam.alreadySelectTargetTableValue=[],this.selectParam.isAutoCreate=!1,this.selectParam.sourceRows.splice(1,this.selectParam.sourceRows.length)},handleCreate:function(){this.showHandleCreate=!0},autoCreate:function(){var e=this;if(""!==this.selectParam.sourceRows[0].sourceDatabase)if(0!==this.selectParam.sourceRows[0].alreadySelectSourceTableValue.length)if(""!==this.selectParam.targetDatabase){var t=this.selectParam;this._AJAX({url:"task.stepHeader.autoCreateTable",method:"POST",data:{sourceTableId:t.sourceRows[0].alreadySelectSourceTableValue[0],sourceTableName:t.sourceRows[0].alreadySelectSourceTable[0].tableName,targetLevelCode:t.targetDatabase,sourceDBType:this.storey.includes(t.sourceRows[0].sourceDatabase)?"1":"0"}}).then((function(t){e.sqlResponse=t,1e4===t.code?(e.initAutoCreate(t.data),e.showAutoCreate=null!==t.data.sqlStr):e.showAutoCreate=!0}))}else this.$AudaqueToast.warn({template:"目标层不可为空"});else this.$AudaqueToast.warn({template:"源数据层表不可为空"});else this.$AudaqueToast.warn({template:"源数据层不可为空"})},selectTable:function(e,t){if("source"!==e||""!==this.selectParam.sourceRows[t].sourceDatabase)if("target"!==e||""!==this.selectParam.targetDatabase){var a=[].concat(Object(r.a)(this.databaseList[0].options),Object(r.a)(this.databaseList[1].options));if(this.currentType={type:e,index:t},"source"===e){var s=this.selectParam.sourceRows[t].sourceDatabase;this.currentSelectDatabase=a.find((function(e){return e.code===s}))}if("target"===e){var l=this.selectParam.targetDatabase;this.currentSelectDatabase=a.find((function(e){return e.code===l}))}this.showTableSelectionPage=!0}else this.$AudaqueToast.warn({template:"目标层不可为空"});else this.$AudaqueToast.warn({template:"源数据层不可为空"})},hasDuplicateValues:function(){for(var e=new Set,t=0;t<this.customData.length;t++){var a=this.customData[t].targetColumnCode;if(e.has(a))return!0;e.add(a)}return!1},submit:function(){var e=this,t=this;return this.hasDuplicateValues()?this.$message.error("目标表字段不能重复"):new Promise((function(a,r){t.$refs.stepThemeLayerForm.validate((function(a){a&&(e.$store.commit("SHOW_LOADING",!0),e.stepId?(t.taskStep.isAutoCreate=t.selectParam.isAutoCreate,t.taskStep.taskStepDetail.stepId=e.stepId,t.taskStep.taskStepDetail.id=e.stepAndDetail.taskStepDetail.id,t.taskStep.taskStepDetail.sourceTableId=t.sourceTableValue,t.taskStep.taskStepDetail.targetTableId=t.selectParam.alreadySelectTargetTable[0].id,t.taskStep.taskStepDetail.sqlContent=t.sqlValue,t.taskStep.taskStepDetail.whereCondition=t.param.whereCondition,t.taskStep.increaseField=t.param.growField,t.taskStep.syncType=t.param.asyncConfig,t.UPDATESTEP(t.taskStep).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){t.$router.go(-1)}}})})).catch((function(){e.$AudaqueToast.tip({template:"修改失败",methods:{okEvent:function(){}}})}))):(t.taskStep.isAutoCreate=t.selectParam.isAutoCreate,t.taskStep.increaseField=t.param.growField,t.taskStep.syncType=t.param.asyncConfig,t.taskStep.taskStepDetail.whereCondition=t.param.whereCondition,t.taskStep.taskStepDetail.sourceTableId=t.selectParam.sourceRows[0].alreadySelectSourceTable[0].id,t.taskStep.taskStepDetail.targetTableId=t.selectParam.alreadySelectTargetTable[0].id,t.ADDSTEP(t.taskStep).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"新增成功",methods:{okEvent:function(){t.$router.go(-1)}}})})).catch((function(){e.$AudaqueToast.tip({template:"新增失败",methods:{okEvent:function(){t.$router.go(-1)}}})}))))}))}))}})},m=(a("8b6d"),a("2877")),f=Object(m.a)(p,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("audaque-detail-form-page",{attrs:{title:"实时任务配置"}},[t("search-group",{attrs:{selectParam:e.selectParam,databaseList:e.databaseList,isAlreadyStart:e.isAlreadyStart,stepActiveId:e.stepActiveId,startStep:e.startStep},on:{autoCreate:e.autoCreate,handleCreate:e.handleCreate,select:e.selectTable,sourceChange:e.handleSourceChange,targetChange:e.handleTargetChange}}),e.showTableSelectionPage?t("table-selection-page",{attrs:{show:e.showTableSelectionPage,currentSelectDatabase:e.currentSelectDatabase,currentLayerValue:e.currentLayerValue,selectParam:e.selectParam,currentType:e.currentType},on:{submit:e.initMap,close:function(t){e.showTableSelectionPage=!1}}}):e._e(),[t("div",{staticStyle:{width:"80%",margin:"0 auto"}},[t("el-form",{ref:"stepThemeLayerForm",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules,"label-position":"left",disabled:"view"===e.$route.query.filter}},[e.tableShow?t("div",[t("div",{staticClass:"checkboxrow"},[t("el-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(t){return e.Automaticmapping(!0)}}},[e._v("字段自动映射")])],1),t("br"),t("el-table",{ref:"tableData",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:e.customData,border:""}},[e.selectParam.sourceRows[0].alreadySelectSourceTable[0].tableName?t("el-table-column",{attrs:{label:e.selectParam.sourceRows[0].alreadySelectSourceTable[0].tableName,align:"center",prop:"columnName"}}):e._e(),e.selectParam.alreadySelectTargetTable[0].tableName?t("el-table-column",{attrs:{label:e.selectParam.alreadySelectTargetTable[0].tableName,prop:"targetColumnCode"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{filterable:"",size:"mini",clearabl:"",e:""},on:{change:function(t){return e.change(a.row,a.$index)}},model:{value:a.row.targetColumnCode,callback:function(t){e.$set(a.row,"targetColumnCode",t)},expression:"scope.row.targetColumnCode"}},e._l(e.sourceColumnList[e.selectParam.alreadySelectTargetTable[0].id],(function(e){return t("el-option",{key:e.id,attrs:{label:e.columnName,value:e.id}})})),1)]}}],null,!1,322649775)}):e._e()],1),t("br"),t("el-form-item",{attrs:{"class-name":"tablerow"},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v("同步配置")]),t("el-tooltip",{staticClass:"item",staticStyle:{"padding-left":"18px"},attrs:{effect:"dark",placement:"right"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("注：实时任务只能配置增量同步")]),t("i",{staticClass:"content-view iconfont iconbangzhu operate"})])]},proxy:!0}],null,!1,2941102157)},[t("el-radio",{attrs:{label:2},model:{value:e.param.asyncConfig,callback:function(t){e.$set(e.param,"asyncConfig",t)},expression:"param.asyncConfig"}},[e._v("增量")])],1),2===e.param.asyncConfig?t("el-form-item",{attrs:{label:"增量字段",prop:"growField",rules:{required:!0,message:"请选择",trigger:"change"}}},[t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.param.growField,callback:function(t){e.$set(e.param,"growField",t)},expression:"param.growField"}},e._l(e.customData,(function(e){return t("el-option",{key:e.columnName,attrs:{label:e.columnName,value:e.columnName}})})),1)],1):e._e(),t("el-form-item",{attrs:{prop:"whereCondition",rules:{required:!1,message:"请输入",trigger:"change"}},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v("where条件")]),t("el-tooltip",{staticClass:"item",staticStyle:{"padding-left":"10px"},attrs:{effect:"dark",placement:"right"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("注：where条件不需填写where关键字")]),t("i",{staticClass:"content-view iconfont iconbangzhu operate"})])]},proxy:!0}],null,!1,3032826153)},[t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.param.whereCondition,callback:function(t){e.$set(e.param,"whereCondition",t)},expression:"param.whereCondition"}})],1)],1):e._e()])],1)],t("template",{slot:"bottom"},[t("div",{staticClass:"footer"},[e.currentLayerValue&&"view"!==e.$route.query.filter?t("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.submit}},[e._v("完成")]):e._e()],1)])],2)}),[],!1,null,"0583b54f",null);t.default=f.exports},"710e":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".custom-steps[data-v-0583b54f]{height:80px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.custom-steps[data-v-0583b54f],.custom-steps>div[data-v-0583b54f]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.custom-steps>div[data-v-0583b54f]{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.custom-steps .success .content .num[data-v-0583b54f]{background:#409eff;color:#fff}.custom-steps .success .content .title[data-v-0583b54f]{color:#409eff}.custom-steps .active .content .num[data-v-0583b54f]{width:35px;height:35px;line-height:35px;text-align:center;border-radius:35px}.custom-steps .content[data-v-0583b54f]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap;width:50px;font-size:15px;cursor:pointer}.custom-steps .content .num[data-v-0583b54f]{width:30px;height:30px;line-height:30px;text-align:center;border-radius:30px;background:#b3b3b3;color:#fff;-webkit-transition:all .2s ease-in;transition:all .2s ease-in}.custom-steps .content .title[data-v-0583b54f]{padding-top:5px;color:#b3b3b3}.custom-steps .line[data-v-0583b54f]{height:23px;border-top:2px solid #c5c5c5;width:170px}[data-v-0583b54f] .el-steps{width:140px}",""])},"77d9":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".row[data-v-ec76bff8]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row>div[data-v-ec76bff8]:first-child{margin-right:10px}[data-v-ec76bff8] .el-dialog__body{max-height:100%!important}[data-v-ec76bff8] .pane-comp,[data-v-ec76bff8] .tree-dashed{overflow:auto}",""])},"7ae7":function(e,t,a){"use strict";a("f7c0")},"8b6d":function(e,t,a){"use strict";a("48e2")},a849:function(e,t,a){"use strict";a("cca9")},b2dc:function(e,t,a){"use strict";a.r(t),a("8e6e"),a("456d"),a("7f7f"),a("7514"),a("6762"),a("2fdb"),a("ac6a");var r=a("ade3"),s=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var n={computed:o({},Object(s.d)("fusionTask",["databaseConf"])),data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],databaseList:[{label:"前置库",options:[]},{label:"",options:[]}],nameMap:{0:"stepStart",au_ods:"stepOds",au_std:"stepStd",au_dwd:"stepDwd",au_dwm:"stepDwm",au_dws:"stepDws",au_app:"stepApp"},titleMap:{0:"开始",1:"归集层",2:"标准层",3:"基础层",4:"主题层",5:"专题层",6:"安全层",7:"前置库"},process:[{id:"",title:"开始",stepId:"",success:!1}]}},methods:o(o({},Object(s.b)("fusionTask",["GET_DATA_BASE_LIST","GET_STEP_HEADERR"])),{},{getStepHeader:function(){var e=this;return new Promise((function(t){e.GET_STEP_HEADERR({taskId:e.$route.query.taskId}).then((function(a){if(a&&a.length>0){var r=a;r.forEach((function(t,a){if(0===a)t.success=!0,t.title="开始";else{var r=t.stepDetailList[0].targetDbCode;t.success=!0,t.title=e.storey.includes(r)?e.databaseList[1].options.find((function(e){return e.code===r})).label:e.databaseList[0].options.find((function(e){return e.code===r})).label}})),e.process=r}t(a)}))}))}}),created:function(){var e=this;this.isLoading=!0,this.$store.commit("fusionTask/changeLoading",!0),this.databaseList[1].options=[],this.GET_DATA_BASE_LIST().then((function(){e.databaseConf.frontDBList.forEach((function(t,a){e.databaseList[0].options.push({label:t.name,value:a+1,type:t.type,code:t.code})})),e.databaseConf.modelDBList.forEach((function(t,a){e.databaseList[1].options.push({label:t.name,value:a+1,type:t.type,code:t.code})})),e.getStepHeader().then((function(t){e.backTo(t[0])}))}))}};t.default=n},be6f:function(e,t,a){"use strict";a.r(t),a("28a5"),a("6762"),a("2fdb"),a("8e6e"),a("ac6a"),a("456d");var r=a("ade3"),s=a("2f62"),l=a("e762");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var i={props:["show","selectParam","sqlResponse"],data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"]}},components:{},computed:{decodeStr:function(){return function(e){return Object(l.a)(decodeURIComponent(e))}}},mounted:function(){},methods:n(n({},Object(s.b)(["_AJAX"])),{},{handleClose:function(){this.$emit("close")}})},c=a("2877"),u=Object(c.a)(i,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticStyle:{height:"80vh"},attrs:{title:"自动建表",visible:e.show,width:"80%","before-close":e.handleClose,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[t("div",{staticStyle:{padding:"20px"}},[0===e.sqlResponse.code&&e.sqlResponse.message.includes("$")?t("div",[t("div",[e._v("日志："+e._s(e.sqlResponse.message.split("$")[0]))]),t("div",[e._v("语句："+e._s(e.decodeStr(e.sqlResponse.message.split("$")[1])))])]):0!==e.sqlResponse.code||e.sqlResponse.message.includes("$")?1e4===e.sqlResponse.code?t("div",[e.sqlResponse.data.sqlStr?t("div",[e._v("\n                "+e._s(e.sqlResponse.data.sqlStr)+"\n            ")]):t("div",[e._v("成功")])]):e._e():t("div",[t("div",[e._v("日志："+e._s(e.sqlResponse.message))])])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})])}),[],!1,null,"fa7f0556",null);t.default=u.exports},cca9:function(e,t,a){var r=a("77d9");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("2f5baaed",r,!0,{sourceMap:!1,shadowMode:!1})},d184:function(e,t,a){"use strict";a("107f")},e10e:function(e,t,a){"use strict";a.r(t),a("7f7f"),a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("8e6e"),a("456d"),a("ac6a");var r=a("ade3"),s=a("2f62");function l(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,n=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){i=!0,l=e},f:function(){try{n||null==a.return||a.return()}finally{if(i)throw l}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var c={props:["show","selectParam"],data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],defaultProps:{children:"children",label:"name"},hrefPath:"",activeName:"first",param:{id:"",tableName:"",tableComment:"",modelName:"",modelId:"",columnInfoList:[],sql:""},rules:{modelName:[{required:!0,message:"请选择模块",trigger:"change"}],sql:[{required:!0,message:"请输入sql",trigger:"blur"}],tableName:[{required:!0,message:"请输入表名",trigger:"blur"}],tableComment:[{required:!0,message:"请输入表注释",trigger:"blur"}]}}},computed:i(i(i(i(i({},Object(s.d)("baseLayer",["baseLayerList","dataTypeOptions"])),Object(s.d)("subjectLayer",["subjectLayerList"])),Object(s.d)("specialLayer",["specialLayerList"])),Object(s.d)("safeLayer",["safeLayerList"])),{},{current:function(){return this.selectParam.targetDatabase}}),created:function(){this.GETDATATYPEOPTIONS_LIST(),"au_dwd"===this.current&&this.BASELAYER_LIST(),"au_dwm"===this.current&&this.SUBJECTLAYER_LIST(),"au_dws"===this.current&&this.SPECIALLAYER_LIST(),"au_app"===this.current&&this.SAFELAYER_LIST()},components:{},mounted:function(){this.$nextTick((function(){var e=document.querySelector(".custom-container");e&&(e.style.height=e.clientHeight+"px")}))},methods:i(i(i(i(i(i({},Object(s.b)(["_AJAX"])),Object(s.b)("baseLayer",["BASELAYER_LIST","GETDATATYPEOPTIONS_LIST"])),Object(s.b)("subjectLayer",["SUBJECTLAYER_LIST"])),Object(s.b)("specialLayer",["SPECIALLAYER_LIST"])),Object(s.b)("safeLayer",["SAFELAYER_LIST"])),{},{exportFun:function(){this.publics.exportFile(this,{au_dwd:"/baseLayer/createTableTemplateDown.do",au_dwm:"/subjectLayer/createTableTemplateDown.do",au_dws:"/specialLayer/createTableTemplateDown.do",au_app:"/safeLayer/createTableTemplateDown.do"}[this.selectParam.targetDatabase],{})},handleUpload:function(e){var t=this;if(!this.param.modelId)return this.$refs.upload.value=null,Vue.prototype.$message.warning("请选择建表目录！");this.formData=new FormData,this.formData.append("upFile",e.target.files[0]),this.formData.append("categoryId",this.param.modelId),this.loading=!0,this._AJAX({url:{au_dwd:"baseLayer.tableImport",au_dwm:"subjectLayer.tableImport",au_dws:"specialLayer.tableImport",au_app:"safeLayer.tableImport"}[this.selectParam.targetDatabase],data:this.formData,method:"POST"}).then((function(e){t.loading=!1,0===e.code?t.$message({message:"导入成功",type:"success"}):t.$message({message:"导入失败",type:"error"}),t.delFormData()})).catch((function(){t.loading=!1,t.delFormData()}))},delFormData:function(){this.$refs.upload.value=null;var e,t=l(this.formData.keys());try{for(t.s();!(e=t.n()).done;){var a=e.value;this.formData.delete(a)}}catch(e){t.e(e)}finally{t.f()}},addRow:function(){this.param.columnInfoList.push({})},removeRow:function(e){this.param.columnInfoList.splice(e,1)},handleClose:function(){this.$emit("close")},handleClick:function(e){this.activeName=e.name},handleMoveNodeClick:function(e){this.param.modelName=e.name,this.param.modelId=e.id},subBtn:function(){var e=this;if(this.param.modelId){var t=this,a={au_dwd:"baseLayer",au_dwm:"subjectLayer",au_dws:"specialLayer",au_app:"safeLayer"};"first"==t.activeName?this.$refs.createTableForm.validate((function(r){if(!r)return!1;e.$store.commit("SHOW_LOADING",!0),e.$store.dispatch("".concat(a[e.selectParam.targetDatabase],"/CREATETABLESD"),t.param).then((function(t){0==t.code&&(e.$message.success("建表成功"),e.$emit("success",t.result))}))})):"third"==t.activeName&&this.$refs.createTableByDdl.validate((function(r){if(!r)return!1;var s=e.param.sql;t.param.sql=encodeURIComponent(s),e.$store.commit("SHOW_LOADING",!0),e.$store.dispatch("".concat(a[e.selectParam.targetDatabase],"/CREATETABLEDDL"),t.param).then((function(t){0==t.code&&(e.$message.success("建表成功"),e.$emit("success",t.result))})),e.param.sql=s}))}else this.$message({message:"请选择建表目录",type:"warning"})}})},u=(a("d184"),a("2877")),d=Object(u.a)(c,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"手动建表",visible:e.show,"before-close":e.handleClose,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[t("div",{staticClass:"custom-container"},[t("audaque-resize-split-page",[t("template",{slot:"leftPane"},["au_dwd"===e.current?t("el-tree",{ref:"tree",staticClass:"tree-dashed",attrs:{data:e.baseLayerList,"node-key":"value","expand-on-click-node":!1,"highlight-current":"",props:e.defaultProps,"default-expand-all":!0},on:{"node-click":function(t){return e.handleMoveNodeClick(t,"au_dwd")}}}):e._e(),"au_dwm"===e.current?t("el-tree",{ref:"tree",staticClass:"tree-dashed",attrs:{data:e.subjectLayerList,"node-key":"value","expand-on-click-node":!1,"highlight-current":"",props:e.defaultProps,"default-expand-all":!0},on:{"node-click":function(t){return e.handleMoveNodeClick(t,"au_dwm")}}}):e._e(),"au_dws"===e.current?t("el-tree",{ref:"tree",staticClass:"tree-dashed",attrs:{data:e.specialLayerList,"node-key":"value","expand-on-click-node":!1,"highlight-current":"",props:e.defaultProps,"default-expand-all":!0},on:{"node-click":function(t){return e.handleMoveNodeClick(t,"au_dws")}}}):e._e(),"au_app"===e.current?t("el-tree",{ref:"tree",staticClass:"tree-dashed",attrs:{data:e.safeLayerList,"node-key":"value","expand-on-click-node":!1,"highlight-current":"",props:e.defaultProps,"default-expand-all":!0},on:{"node-click":function(t){return e.handleMoveNodeClick(t,"au_app")}}}):e._e()],1),t("template",{slot:"rightPane"},[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"手动建表",name:"first"}},[[t("el-form",{ref:"createTableForm",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"模块",prop:"modelName",rules:e.rules.modelName}},[t("el-input",{attrs:{disabled:"",placeholder:"请选择模块","show-word-limit":""},model:{value:e.param.modelName,callback:function(t){e.$set(e.param,"modelName","string"==typeof t?t.trim():t)},expression:"param.modelName"}})],1),t("el-form-item",{attrs:{label:"表名",prop:"tableName",rules:e.rules.tableName}},[t("el-input",{attrs:{placeholder:"请输入表名",maxlength:"200","show-word-limit":""},model:{value:e.param.tableName,callback:function(t){e.$set(e.param,"tableName","string"==typeof t?t.trim():t)},expression:"param.tableName"}})],1),t("el-form-item",{attrs:{label:"表注释",prop:"tableComment",rules:e.rules.tableComment}},[t("el-input",{attrs:{placeholder:"请输入表注释",maxlength:"200","show-word-limit":""},model:{value:e.param.tableComment,callback:function(t){e.$set(e.param,"tableComment","string"==typeof t?t.trim():t)},expression:"param.tableComment"}})],1)],1),t("el-col",{attrs:{span:24}},[t("table",{staticClass:"custom_table custom_table1"},[t("thead",[t("tr",[t("th",[e._v("序号")]),t("th",[e._v("列名")]),t("th",[e._v("列中文名")]),t("th",[e._v("类型")]),t("th",[e._v("可为空")]),t("th",[e._v("主键")]),t("th",[e._v("长度")]),t("th",[e._v("精度")]),t("th",[t("el-tooltip",{staticClass:"item",attrs:{size:"mini",effect:"dark",content:"新增",placement:"top-start"}},[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addRow}})],1)],1)])]),t("tbody",e._l(e.param.columnInfoList,(function(a,r){return t("tr",{key:r},[t("td",[t("label",[e._v(e._s(r+1))])]),t("td",[t("el-input",{attrs:{size:"mini",placeholder:"请输入",maxlength:"200","show-word-limit":""},model:{value:a.columnName,callback:function(t){e.$set(a,"columnName","string"==typeof t?t.trim():t)},expression:"i.columnName"}})],1),t("td",[t("el-input",{attrs:{size:"mini",placeholder:"请输入",maxlength:"200","show-word-limit":""},model:{value:a.columnComment,callback:function(t){e.$set(a,"columnComment","string"==typeof t?t.trim():t)},expression:"i.columnComment"}})],1),t("td",[t("el-select",{attrs:{filterable:"",size:"mini"},model:{value:a.columnType,callback:function(t){e.$set(a,"columnType",t)},expression:"i.columnType"}},e._l(e.dataTypeOptions,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1),t("td",[t("el-select",{attrs:{size:"mini"},model:{value:a.nullAble,callback:function(t){e.$set(a,"nullAble",t)},expression:"i.nullAble"}},[t("el-option",{key:"1",attrs:{label:"Y",value:"1"}}),t("el-option",{key:"0",attrs:{label:"N",value:"0"}})],1)],1),t("td",[t("el-select",{attrs:{size:"mini"},model:{value:a.primaryKey,callback:function(t){e.$set(a,"primaryKey",t)},expression:"i.primaryKey"}},[t("el-option",{key:"1",attrs:{label:"是",value:"1"}}),t("el-option",{key:"0",attrs:{label:"否",value:"0"}})],1)],1),t("td",[t("el-input",{attrs:{size:"mini",placeholder:"请输入",maxlength:"200","show-word-limit":""},model:{value:a.length,callback:function(t){e.$set(a,"length","string"==typeof t?t.trim():t)},expression:"i.length"}})],1),t("td",[t("el-input",{attrs:{size:"mini",placeholder:"请输入",maxlength:"200","show-word-limit":""},model:{value:a.scale,callback:function(t){e.$set(a,"scale","string"==typeof t?t.trim():t)},expression:"i.scale"}})],1),t("td",[t("el-tooltip",{staticClass:"item",attrs:{size:"mini",effect:"dark",content:"删除",placement:"top-start"}},[t("i",{staticClass:"el-icon-remove",style:{color:"#f00"},on:{click:function(t){return e.removeRow(r)}}})])],1)])})),0)])])],1)],1)]],2),t("el-tab-pane",{attrs:{label:"导入建表",name:"second"}},[[t("i",{staticClass:"iconfont icondaochu2 audaque-rect-icon",staticStyle:{cursor:"pointer"},attrs:{title:"下载导入模板"},on:{click:function(t){return e.exportFun(e.path)}}},[e._v("下载导入模板")]),t("i",{staticClass:"iconfont icondaoru1 audaque-rect-icon import-template",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$refs.upload.click()}}},[e._v("导入模板\n                                "),t("input",{ref:"upload",staticClass:"inputFile",staticStyle:{display:"none"},attrs:{type:"file",accept:".xls,.xlsx"},on:{change:function(t){return e.handleUpload(t)}}})])]],2),t("el-tab-pane",{attrs:{label:"DDL建表",name:"third"}},[[t("el-form",{ref:"createTableByDdl",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"模块",prop:"modelName",rules:e.rules.modelName}},[t("el-input",{attrs:{disabled:"",placeholder:"请选择模块","show-word-limit":""},model:{value:e.param.modelName,callback:function(t){e.$set(e.param,"modelName","string"==typeof t?t.trim():t)},expression:"param.modelName"}})],1),t("el-form-item",{attrs:{label:"DDL语句",prop:"sql",rules:e.rules.sql}},[t("el-input",{attrs:{rows:15,placeholder:"请输入sql",type:"textarea"},model:{value:e.param.sql,callback:function(t){e.$set(e.param,"sql","string"==typeof t?t.trim():t)},expression:"param.sql"}})],1)],1)],1)],1)]],2)],1)],1)],2)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.subBtn}},[e._v("创建")])],1)])}),[],!1,null,"672fdd10",null);t.default=d.exports},e607:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".require[data-v-285f502b]{color:#f56c6c}.search[data-v-285f502b]{width:800px;margin:0 auto}.row[data-v-285f502b]{margin-bottom:20px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row[data-v-285f502b] .el-form-item{margin-bottom:0!important}.row .label[data-v-285f502b]{width:120px;vertical-align:middle;font-size:14px;color:#606266}.row .label[data-v-285f502b],.row>div[data-v-285f502b]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row[data-v-285f502b] .el-input__suffix-inner{display:none}.row[data-v-285f502b] .el-form-item__content{margin-left:0!important}.row[data-v-285f502b] .el-input.is-disabled .el-input__inner{background:#fbfbfb}",""])},e762:function(e,t,a){"use strict";a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return O}));const r="function"==typeof Buffer,s="function"==typeof TextDecoder?new TextDecoder:void 0,l="function"==typeof TextEncoder?new TextEncoder:void 0,o=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),n=(e=>{let t={};return e.forEach((e,a)=>t[e]=a),t})(o),i=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,c=String.fromCharCode.bind(String),u="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),d=e=>e.replace(/=/g,"").replace(/[+\/]/g,e=>"+"==e?"-":"_"),p=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),m=e=>{let t,a,r,s,l="";const n=e.length%3;for(let i=0;i<e.length;){if((a=e.charCodeAt(i++))>255||(r=e.charCodeAt(i++))>255||(s=e.charCodeAt(i++))>255)throw new TypeError("invalid character found");t=a<<16|r<<8|s,l+=o[t>>18&63]+o[t>>12&63]+o[t>>6&63]+o[63&t]}return n?l.slice(0,n-3)+"===".substring(n):l},f="function"==typeof btoa?e=>btoa(e):r?e=>Buffer.from(e,"binary").toString("base64"):m,b=r?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let a=0,r=e.length;a<r;a+=4096)t.push(c.apply(null,e.subarray(a,a+4096)));return f(t.join(""))},h=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?c(192|t>>>6)+c(128|63&t):c(224|t>>>12&15)+c(128|t>>>6&63)+c(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return c(240|t>>>18&7)+c(128|t>>>12&63)+c(128|t>>>6&63)+c(128|63&t)},g=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,y=e=>e.replace(g,h),w=r?e=>Buffer.from(e,"utf8").toString("base64"):l?e=>b(l.encode(e)):e=>f(y(e)),v=(e,t=!1)=>t?d(w(e)):w(e),S=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,T=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return c(55296+(t>>>10))+c(56320+(1023&t));case 3:return c((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return c((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},C=e=>e.replace(S,T),_=e=>{if(e=e.replace(/\s+/g,""),!i.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,a,r,s="";for(let l=0;l<e.length;)t=n[e.charAt(l++)]<<18|n[e.charAt(l++)]<<12|(a=n[e.charAt(l++)])<<6|(r=n[e.charAt(l++)]),s+=64===a?c(t>>16&255):64===r?c(t>>16&255,t>>8&255):c(t>>16&255,t>>8&255,255&t);return s},x="function"==typeof atob?e=>atob(p(e)):r?e=>Buffer.from(e,"base64").toString("binary"):_,k=r?e=>u(Buffer.from(e,"base64")):e=>u(x(e).split("").map(e=>e.charCodeAt(0))),D=r?e=>Buffer.from(e,"base64").toString("utf8"):s?e=>s.decode(k(e)):e=>C(x(e)),A=e=>p(e.replace(/[-_]/g,e=>"-"==e?"+":"/")),O=e=>D(A(e))},eb30:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".get-edit-item[data-v-672fdd10]{padding-top:20px;margin:0 50px}.get-edit-item li[data-v-672fdd10]{margin-top:20px;display:-webkit-box;display:-ms-flexbox;display:flex}.get-edit-item li .get-edit-type[data-v-672fdd10]{height:40px;line-height:40px}.get-edit-item li .get-edit-title[data-v-672fdd10]{width:80px;color:#3a405b;height:40px;line-height:40px}.get-edit-item li .el-tree[data-v-672fdd10]{width:100%;border:1px solid #dcdfe6;padding:24px}.custom_table1 tbody td[data-v-672fdd10],.custom_table1 thead th[data-v-672fdd10]{width:11%}.custom_table[data-v-672fdd10]{border-collapse:collapse;width:100%;text-align:left}.custom_table thead tr[data-v-672fdd10]{background:#f9fafb}.custom_table thead th[data-v-672fdd10]{color:#666;font-size:13px}.custom_table tbody tr[data-v-672fdd10]{border:1px solid #ebeef5;padding:5px 0}.custom_table tbody i[data-v-672fdd10]{color:red;font-size:30px;cursor:pointer}",""])},f7c0:function(e,t,a){var r=a("e607");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("cbf47fb4",r,!0,{sourceMap:!1,shadowMode:!1})}}]);