(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-931dad7a","chunk-7a1ef581"],{1617:function(e,t,r){"use strict";r("5632")},"4ee4":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".source-manage-form[data-v-61a5c10a] .source-list-full{width:100%;float:left}.source-manage-form[data-v-61a5c10a] .source-list{width:50%;float:left;position:relative}.source-manage-form[data-v-61a5c10a] .source-list .all{width:40px}.source-manage-form[data-v-61a5c10a] .source-list /deep/ .el-switch{margin:6px 20px 0 0}.source-manage-form[data-v-61a5c10a] .search-tree{position:relative;top:-2px}.source-manage-form[data-v-61a5c10a] .search-tree .el-input__validateIcon{display:none}.source-manage-form[data-v-61a5c10a] .source-sq-list{width:100%;float:left}.source-manage-form[data-v-61a5c10a] .source-sq-list .all{width:40px}.source-manage-form[data-v-61a5c10a] .source-sq-list /deep/ .el-switch{margin:6px 20px 0 0}.source-manage-form[data-v-61a5c10a] .source-sq-list.tree-box .el-tree{border:1px solid #dcdfe6;min-height:200px;max-height:300px;overflow:auto}.source-manage-form[data-v-61a5c10a] .change-form{float:left;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;border-top:1px solid #f2f2f2;margin:34px 0 0;padding-top:12px}.source-manage-form[data-v-61a5c10a] .sq-cls .el-select{width:calc(100% - 120px)}",""])},5632:function(e,t,r){var a=r("b219");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,r("499e").default)("1b5e0773",a,!0,{sourceMap:!1,shadowMode:!1})},"9eae":function(e,t,r){var a=r("4ee4");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,r("499e").default)("f334d104",a,!0,{sourceMap:!1,shadowMode:!1})},aad9:function(e,t,r){"use strict";r.r(t),r("8e6e"),r("456d"),r("7f7f"),r("ac6a");var a=r("ade3"),l=r("2f62");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var n={name:"adqTree",data:function(){return{filterText:"",isAllCheck:null,allIds:[],treeData:[],loading:!1,isSearch:!1}},watch:{treeData:{handler:function(e){},deep:!0},filterText:function(e){0===e.length&&(this.isSearch=!1,this.$refs.adqTree.filter(e))}},props:{defaultCheckedKeys:{type:Array,default:function(){return[]}},defaultExpandedKeys:{type:Array,default:function(){return[]}},checkStrictly:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!0},isCheckBtn:{type:Boolean,default:!0},expandOnClickNode:{type:Boolean,default:!0},nodeKey:{type:String,default:"id"},defaultProps:{type:Object,default:function(){return{label:"name",children:"children",isLeaf:"isEnd"}}}},mounted:function(){this.loadInit()},methods:s(s({},Object(l.b)(["_AJAX"])),{},{loadInit:function(){var e=this;this.loading=!0,this._AJAX({url:"org.findRootDept",method:"GET",data:{}}).then((function(t){0===t.code&&e._AJAX({url:"org.findRootDeptTree",method:"GET",data:{deptId:t.result.id}}).then((function(t){e.treeData=[t.result],e.loading=!1,e.defaultExpandedKeys.push(t.result.id),e.allIds=[],e.loadIds([t.result])}))}))},loadIds:function(e){var t=this;e.forEach((function(e){t.allIds.push(e.id),e.children&&e.children.length>0&&t.loadIds(e.children)}))},treeIsAllCheck:function(e){e?this.$refs.adqTree.setCheckedKeys(this.allIds):this.$refs.adqTree.setCheckedKeys([])},clickInquireTreeData:function(){var e=this;this.isSearch=!0,this.loading=!0,setTimeout((function(){e.$refs.adqTree.filter(e.filterText),e.$nextTick().then((function(){setTimeout((function(){e.loading=!1}),500)}))}),50)},parentSearch:function(e){this.filterText=e,this.clickInquireTreeData()},filterNode:function(e,t,r){return!e||-1!==t.name.indexOf(e)},filterNodeMethod:function(e){var t=this;!function r(a){a.map((function(a){var l=a[t.defaultProps.children];a.visible=t.filterNode(e,a),l&&l.length>0&&r(l)}))}(this.treeData)},handleNodeClick:function(e,t){this.$emit("node-click",e,t),this.showChildrenNode(e,t)},showChildrenNode:function(e,t){1!=t.level&&!t.isLeaf&&this.isSearch&&(t.expanded=!0,t.childNodes.forEach((function(e){e.visible=!0})))},handleCheckChange:function(e,t){this.$emit("check-change",e,t)},handleRenderContent:function(e,t){var r=t.node,a=t.data,l=(t.store,"iconfont icondrxx95 group");return a.isPosition?l=a.leader?"iconfont iconlingdao leader":"iconfont iconyuangong people":1===r.level&&(l="iconfont icondrxx95 root"),e("span",{class:l,style:""},[" ",a.name])}})},i=(r("1617"),r("2877")),u=Object(i.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"adq-tree"},[t("el-input",{staticClass:"filter-tree-input",attrs:{placeholder:"输入关键字进行过滤",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.clickInquireTreeData.apply(null,arguments)}},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[t("el-button",{staticClass:"query-btn",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.clickInquireTreeData},slot:"append"},[e._v("搜索")])],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"adq-tree-item",attrs:{"element-loading-spinner":"el-icon-loading"}},[e.showCheckbox&&e.isCheckBtn?t("el-radio-group",{staticStyle:{"margin-left":"20px"},model:{value:e.isAllCheck,callback:function(t){e.isAllCheck=t},expression:"isAllCheck"}},[t("el-radio-button",{attrs:{label:!0},nativeOn:{click:function(t){return e.treeIsAllCheck(!0)}}},[e._v("全选")]),t("el-radio-button",{attrs:{label:!1},nativeOn:{click:function(t){return e.treeIsAllCheck(!1)}}},[e._v("全不选")])],1):e._e(),t("el-tree",{ref:"adqTree",staticClass:"tree-dashed",attrs:{props:e.defaultProps,"show-checkbox":e.showCheckbox,"expand-on-click-node":e.expandOnClickNode,"node-key":e.nodeKey,"default-checked-keys":e.defaultCheckedKeys,"default-expanded-keys":e.defaultExpandedKeys,"check-strictly":e.checkStrictly,"render-content":e.handleRenderContent,"filter-node-method":e.filterNode,indent:20,data:e.treeData},on:{"node-click":e.handleNodeClick,"check-change":e.handleCheckChange}})],1)],1)}),[],!1,null,"3c72946d",null);t.default=u.exports},b219:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".adq-tree[data-v-3c72946d]{border:1px solid #dcdfe6;width:100%;z-index:99999;max-height:300px;overflow:auto}.adq-tree .filter-tree-input .query-btn[data-v-3c72946d]{background:#409eff;color:#fff}.adq-tree .adq-tree-item[data-v-3c72946d]{height:260px}.adq-tree .adq-tree-item[data-v-3c72946d] .el-loading-spinner i{font-size:30px}",""])},c411:function(e,t,r){"use strict";r.r(t),r("28a5"),r("7f7f"),r("8e6e"),r("456d"),r("7514"),r("20d6");var a=r("53ca"),l=r("ade3"),o=(r("ac6a"),r("96cf"),r("1da1")),s=r("2f62"),n=r("aad9"),i=r("9816");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){Object(l.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d,p={created:(d=Object(o.a)(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.getPublicKey(),e.next=3,this._AJAX({url:"user.getMyDepts",method:"GET",data:{}}).then((function(e){e.result&&e.result.length>0?(r.isMyDept=!0,r.deptList=e.result):r.isMyDept=!1}));case 3:this.ALL_CATEGORY(),this.ALL_APP(),(t=this.$route.query.id)&&this._AJAX({url:"dept"===this.pageType?"datasource.mySourceDetail":"datasource.sourceDetail",method:"GET",data:{sourceId:t}}).then((function(e){var t=e.result;r.ruleForm.id=t.id||"",r.ruleForm.name=t.name||"",r.ruleForm.key=t.key||"",r.ruleForm.permissionLevel=t.permissionLevel,r.ruleForm.sceneType=t.sceneType,r.ruleForm.dataCollection=t.dataCollection,r.defaultCheckedKeys=t.deptIdList?t.deptIdList:[],r.$set(r.ruleForm,"deptId",t.deptId),r.$set(r.ruleForm,"deptName",t.deptName),r.deptDefaultCheckedKeys=[t.deptId];var a="";a=t.appKeys?t.appKeys.split(",").filter((function(e){return e&&e.trim()})):[],r.ruleForm.appKeys=[],a.forEach((function(e){r.appList.forEach((function(t){e==t.appKey&&r.ruleForm.appKeys.push(e)}))})),r.ruleForm.enabled=t.enabled,r.ruleForm.remark=t.remark||"",t.key&&r.changeForm(t.key,!0);var l={};r.addForm=t.definition.properties.map((function(e){return e.defaultValue=t[e.key]||t.customMap[e.key]||"",4==e.type&&e.key==r.parentSelect&&(l=Object.assign({},e)),3==e.type?r.$set(r.ruleForm,e.key,[]):r.$set(r.ruleForm,e.key,e.defaultValue),5==e.type&&r.$set(r.ruleForm,e.key,e.defaultValue?e.defaultValue.split(","):[]),e})),r.changeSelection(l,!0),r.getKeyToName()}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)}),watch:{"ruleForm.publicSource":function(e){this.$refs.ruleForm.validateField("appKeys"),e&&this.$set(this.ruleForm,"appKeys",[])},"ruleForm.appKeys":{handler:function(e,t){e.length>0?this.$set(this.ruleForm,"publicSource",!1):this.$set(this.ruleForm,"publicSource",!0)},deep:!0}},computed:c(c({},Object(s.d)("datasource",["appList","category"])),Object(s.d)(["upload"])),components:{adqTree:n.default},data:function(){var e=this;return{clusterPwdisShow:"",parentSelect:"",selectionObj:{},addForm:[],ruleForm:{name:"",publicSource:!1,key:"",appKeys:[],enabled:"",remark:"",deptId:null,permissionLevel:1,deptIds:null,sceneType:null,dataCollection:null},rules:{enabled:[{required:!0,message:"请选择状态",trigger:"change"}],appKeys:[{validator:function(t,r,a){e.ruleForm.publicSource||0!=e.ruleForm.appKeys.length?a():a(new Error("请输入权限"))},trigger:["blur","change"]}],name:[{required:!0,message:"请输入数据源名称",trigger:"blur"}],key:[{required:!0,message:"请输入数据源分类名称",trigger:"change"}],deptName:[{required:!0,message:"请选择所属部门",trigger:["change","blur"]}],deptId:[{required:!0,message:"请选择所属部门",trigger:["change","blur"]}],permissionLevel:[{required:!0,message:"请选择可见范围",trigger:"change"}]},defaultCheckedKeys:[],deptDefaultCheckedKeys:[],isShowDeptTree:!1,isMyDept:!0,deptList:[],pageType:this.$route.query.pageType,passwordS:{},token:sessionStorage.getItem("token"),privateKey:null,loadingTest:!1,loadingSave:!1,isCluster:window.isCluster}},methods:c(c(c(c({},Object(s.b)("datasource",["ALL_CATEGORY","ALL_APP"])),Object(s.b)(["VIEWFILE","_AJAX"])),Object(s.b)("user",["GETPUBLICKEY","GETPUBLICKEY_USER"])),{},{permitFun:function(e,t){return"system"===this.pageType?e:"dept"===this.pageType?t:void 0},getPublicKey:function(){var e=this;this.isCluster?this.GETPUBLICKEY_USER().then((function(t){e.privateKey=t.result})):this.GETPUBLICKEY().then((function(t){e.privateKey=t.result}))},beforIsShow:function(e,t){return!e.parentSelect||!e.displayValue||e.displayValue.split(",").indexOf(t)>-1||(this.$set(this.ruleForm,e.key,""),!1)},beforRenderFilter:function(e){if(2!==e.type)return!0;if(e.parentSelect){if(this.ruleForm[this.parentSelect]){var t=this.clusterPwdisShow.split(",");return!!(t&&t.indexOf(this.ruleForm[this.parentSelect])>-1)}return!1}return!0},beforeMultiple:function(e,t){if(5!==e.type)return!0;var r=0;for(var a in e.selectValue)a.split("_").indexOf(t)>-1&&r++;return r>0},ruleFun:function(e){var t=3==e.type||4==e.type?"change":"blur",r=[{required:e.required,message:"请输入"+e.name,trigger:t}];if("host"==e.key){var a=null;if("redis"===this.ruleForm.key)return;a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,r.push({validator:function(e,t,r){a.test(t)?r():r(new Error("主机名或IP地址错误！"))},trigger:t})}else if("port"==e.key){var l=/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;r.push({validator:function(e,t,r){l.test(t)?r():r(new Error("端口错误！"))},trigger:t})}return r},getKeyToName:function(){var e=this,t=[];this.addForm.forEach((function(e){3==e.type&&e.defaultValue&&""!=e.defaultValue&&t.push(e.defaultValue)}));var r=t.join(",");""!=r&&r&&this.VIEWFILE(t.join(",")).then((function(t){var r=t.result;e.addForm.forEach((function(t){3==t.type&&r.forEach((function(r){t.defaultValue.indexOf(r.key)>-1&&e.ruleForm[t.key].push({name:r.value,url:r.key})}))}))}))},handleRemove:function(e,t){var r=this;this.ruleForm[t.key].forEach((function(a,l){(a.url||a.response.result)==(e.url||e.response.result)&&r.ruleForm[t.key].splice(l,1)}))},handleError:function(e,t,r){this.$AudaqueToast.error({template:e?JSON.parse(e.message).msg:"文件上传失败",methods:{okEvent:function(){}}})},beforeAvatarUpload:function(e,t){var r=!0;return t.format&&""!=t.format&&e.name.indexOf(t.format)<0&&(this.$AudaqueToast.error({template:"上传格式必须是."+t.format,methods:{okEvent:function(){}}}),r=!1),r},handleSuccess:function(e,t){var r=this;this.ruleForm[t.key]=[],e&&e.forEach((function(e){e.url||e.response&&0===e.response.code?(r.$message({message:"上传成功",type:"success"}),r.ruleForm[t.key].push(e)):r.$AudaqueToast.error({template:e.response.msg,methods:{okEvent:function(){}}})}))},submitForm:function(e){var t=this,r=this;this.isShowDeptTree=!1,this.$refs.ruleForm.validate((function(l){if(!l||!t.isContain())return!1;e?t.loadingTest=!0:t.loadingSave=!0;var o={},s=Object.assign({},t.ruleForm);for(var n in s){var i=s[n];i&&"object"==Object(a.a)(i)?o[n]=i.map((function(e){return"object"==Object(a.a)(e)?e.url||e.response.result:e})).join(","):o[n]=s[n]}if(3==t.ruleForm.permissionLevel){var u=t.$refs.tree.$refs.adqTree.getCheckedKeys();-1==u.indexOf(t.ruleForm.deptId)?o.deptIds=t.ruleForm.deptId+","+u.join(","):o.deptIds=u.join(",")}else 1==t.ruleForm.permissionLevel&&(o.deptIds=t.ruleForm.deptId);t.$store.commit("SHOW_LOADING",!0),e?t._AJAX({url:"dept"===r.pageType?"datasource.testMySource":"datasource.testSource",method:"POST",data:o}).then((function(e){0===e.code&&(t.loadingTest=!1,t.$AudaqueToast.tip({template:"测试连接成功",methods:{okEvent:function(){}}}))})).catch((function(){t.loadingTest=!1})):t.$route.query.id?t._AJAX({url:"dept"===r.pageType?"datasource.modifyMySource":"datasource.modifySource",method:"POST",data:o}).then((function(e){0===e.code&&(t.loadingSave=!1,t.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){r.$router.go(-1)}}}))})).catch((function(){return[t.loadingSave=!1]})):t._AJAX({url:"dept"===r.pageType?"datasource.addMySource":"datasource.addSource",method:"POST",data:o}).then((function(e){0===e.code&&(t.loadingSave=!1,t.$AudaqueToast.tip({template:"添加成功",methods:{okEvent:function(){r.$router.go(-1)}}}))})).catch((function(){return[t.loadingSave=!1]}))}))},emptyVal:function(e,t){this.$set(this.ruleForm,t,"")},des_encrypt:function(e,t){if(e&&e.length>0){var r=new i.a;return r.setPublicKey(this.privateKey),r.encrypt(e),this.$set(this.ruleForm,t,r.encrypt(e)),r.encrypt(e)}},isContain:function(){return 3!=this.ruleForm.permissionLevel||-1!=this.$refs.tree.$refs.adqTree.getCheckedKeys().indexOf(this.ruleForm.deptId)||(this.$AudaqueToast.error({template:"所属部门不在自定义访问部门内!",methods:{okEvent:function(){},cancelEvent:function(){}}}),!1)},resetForm:function(){var e=this.ruleForm.key;this.$refs.ruleForm.resetFields(),this.publics.resetFun(this.ruleForm),this.ruleForm.key=e,this.getPublicKey()},changeForm:function(e){var t,r=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a?(t={},t=Object.assign({},this.ruleForm)):t=this.ruleForm={name:this.ruleForm.name,key:this.ruleForm.key,appKeys:this.ruleForm.appKeys,enabled:this.ruleForm.enabled,remark:this.ruleForm.remark},this.$refs.ruleForm.resetFields(),this.ruleForm=Object.assign({},t),this.category.forEach((function(t){t.key==e&&(r.addForm=t.properties.map((function(t){return 3!=t.type&&5!=t.type||r.$set(r.ruleForm,t.key,t.defaultValue?t.defaultValue.split(","):[]),t.parentSelect&&4==t.type&&"platformVersion"==t.key?(r.parentSelect=t.parentSelect,r.selectionObj=Object.assign({},t.selectValue)):t.parentSelect&&2==t.type&&(r.clusterPwdisShow=t.displayValue),t.fatherKey=e,t})))}))},changeSelection:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.parentSelect==e.key){var a=this.parentSelect,l=this.ruleForm[a];r||this.addForm.map((function(e){5===e.type&&(t.ruleForm[e.key]=[])}));var o={},s=this.addForm.findIndex((function(e){return e.parentSelect==a})),n=this.addForm.find((function(e){return e.parentSelect==a})),i=n.key;for(var u in this.selectionObj)u.indexOf(l)>-1&&(o[u]=this.selectionObj[u]);if(this.addForm[s].selectValue=o,Object.keys(o).length>0&&!r){var c=Object.keys(o)[0];this.$set(this.ruleForm,i,o[c])}else(0!==Object.keys(o).length||r)&&(this.ruleForm[i]||r)||this.$set(this.ruleForm,i,"")}},blankUrl:function(){var e=this.$router.resolve({path:"/guide",query:{}});window.open(e.href,"_blank")},treeMouseLeave:function(){this.$refs.ssbm.blur(),this.isShowDeptTree=!1},handleNodeClick:function(e,t){0!=e.level&&(this.$set(this.ruleForm,"deptName",e.name),this.$set(this.ruleForm,"deptId",e.id),this.isShowDeptTree=!1)}})},m=(r("fcd8"),r("2877")),f=Object(m.a)(p,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{attrs:{title:e.$route.query.id?"编辑数据源":"新增数据源","opt-type":e.$route.query.filter},on:{"submit-click":e.submitForm}},[t("el-form",{ref:"ruleForm",staticClass:"source-manage-form",attrs:{model:e.ruleForm,"status-icon":"","label-width":"160px"}},[t("el-form-item",{staticClass:"source-list",attrs:{label:"数据源名称",prop:"name",rules:e.rules.name}},[t("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"==typeof t?t.trim():t)},expression:"ruleForm.name"}})],1),t("el-form-item",{staticClass:"source-list",attrs:{label:"数据源分类名",prop:"key",rules:e.rules.key}},[t("el-select",{attrs:{disabled:!!e.$route.query.id,placeholder:"请选择数据源分类名"},on:{change:function(t){return e.changeForm(e.ruleForm.key)}},model:{value:e.ruleForm.key,callback:function(t){e.$set(e.ruleForm,"key",t)},expression:"ruleForm.key"}},e._l(e.category,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.key}})})),1)],1),"dept"===e.pageType?t("el-form-item",{staticClass:"source-list",attrs:{label:"所属部门",prop:"deptId",rules:e.rules.deptId}},[t("el-select",{attrs:{placeholder:"请选择所属部门"},model:{value:e.ruleForm.deptId,callback:function(t){e.$set(e.ruleForm,"deptId",t)},expression:"ruleForm.deptId"}},e._l(e.deptList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.deptName,value:e.deptId}})})),1)],1):e._e(),"system"===e.pageType?t("el-form-item",{staticClass:"source-list",attrs:{label:"所属部门",prop:"deptName",rules:e.rules.deptName}},[t("el-input",{ref:"ssbm",attrs:{readonly:""},on:{focus:function(t){e.isShowDeptTree=!0}},model:{value:e.ruleForm.deptName,callback:function(t){e.$set(e.ruleForm,"deptName","string"==typeof t?t.trim():t)},expression:"ruleForm.deptName"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowDeptTree,expression:"isShowDeptTree"}],staticClass:"search-tree",on:{mouseleave:e.treeMouseLeave}},[t("adq-tree",{ref:"deptTree",attrs:{defaultCheckedKeys:e.deptDefaultCheckedKeys,"show-checkbox":!1,expandOnClickNode:!1},on:{"node-click":e.handleNodeClick}})],1)],1):e._e(),t("el-form-item",{staticClass:"source-list",attrs:{label:"状态",prop:"enabled",rules:e.rules.enabled}},[t("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.ruleForm.enabled,callback:function(t){e.$set(e.ruleForm,"enabled",t)},expression:"ruleForm.enabled"}},[t("el-option",{attrs:{label:"启用",value:!0}}),t("el-option",{attrs:{label:"禁用",value:!1}})],1)],1),t("el-form-item",{staticClass:"source-sq-list sq-cls",attrs:{label:"授权",prop:"appKeys",rules:e.rules.appKeys}},[t("label",{staticClass:"all"},[e._v("全部")]),t("el-switch",{model:{value:e.ruleForm.publicSource,callback:function(t){e.$set(e.ruleForm,"publicSource",t)},expression:"ruleForm.publicSource"}}),e.ruleForm.publicSource?e._e():t("el-select",{attrs:{multiple:"",placeholder:"请选择授权"},model:{value:e.ruleForm.appKeys,callback:function(t){e.$set(e.ruleForm,"appKeys",t)},expression:"ruleForm.appKeys"}},e._l(e.appList,(function(r,a){return t("el-option",{key:a,attrs:{disabled:!!e.ruleForm.publicSource,label:r.appName,value:r.appKey}})})),1)],1),t("el-form-item",{staticClass:"source-sq-list",attrs:{label:"可见范围",prop:"permissionLevel",rules:e.rules.permissionLevel}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.permissionLevel,callback:function(t){e.$set(e.ruleForm,"permissionLevel",t)},expression:"ruleForm.permissionLevel"}},[t("el-option",{attrs:{label:"私有",value:1}})],1)],1),3===e.ruleForm.permissionLevel?t("el-form-item",{staticClass:"source-sq-list tree-box",attrs:{label:"访问部门:"}},[t("adq-tree",{ref:"tree",attrs:{defaultCheckedKeys:e.defaultCheckedKeys,"check-strictly":!0}})],1):e._e(),t("el-form-item",{staticClass:"source-sq-list",attrs:{label:"应用场景",prop:"sceneType",rules:e.rules.sceneType}},[t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.ruleForm.sceneType,callback:function(t){e.$set(e.ruleForm,"sceneType",t)},expression:"ruleForm.sceneType"}},[t("el-option",{attrs:{label:"生产环境",value:1}}),t("el-option",{attrs:{label:"前置机",value:2}}),t("el-option",{attrs:{label:"归集库",value:3}}),t("el-option",{attrs:{label:"其它",value:4}})],1)],1),t("el-form-item",{staticClass:"source-sq-list",attrs:{label:"数据采集方式",prop:"dataCollection",rules:e.rules.dataCollection}},[t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.ruleForm.dataCollection,callback:function(t){e.$set(e.ruleForm,"dataCollection",t)},expression:"ruleForm.dataCollection"}},[t("el-option",{attrs:{label:"数据采集",value:1}}),t("el-option",{attrs:{label:"共享交换",value:2}}),t("el-option",{attrs:{label:"在线报送",value:3}}),t("el-option",{attrs:{label:"业务生产",value:4}})],1)],1),t("el-form-item",{staticClass:"source-list-full",attrs:{label:"描述",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",maxlength:"256","show-word-limit":""},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark","string"==typeof t?t.trim():t)},expression:"ruleForm.remark"}})],1),e.addForm.length>0?t("div",{staticClass:"change-form"},[e._l(e.addForm,(function(r,a){return[e.beforeMultiple(r,e.ruleForm[e.parentSelect])&&e.beforIsShow(r,e.ruleForm[e.parentSelect])?t("el-form-item",{key:a,staticClass:"source-list",attrs:{label:r.name,prop:r.key,rules:e.ruleFun(r)}},[4!=r.type||r.parentSelect?4==r.type&&r.parentSelect?t("el-select",{attrs:{placeholder:r.sampleValue},on:{change:function(t){return e.changeSelection(r)}},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,t)},expression:"ruleForm[item.key]"}},[e._l(r.selectValue,(function(r,a,l){return[a.split("_").indexOf(e.ruleForm[e.parentSelect])>-1?t("el-option",{key:l,attrs:{label:r,value:a.split("_")[1],title:r+","+a+","+l}}):e._e()]}))],2):5==r.type?t("el-checkbox-group",{model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,t)},expression:"ruleForm[item.key]"}},[e._l(r.selectValue,(function(r,a){return[a.split("_").indexOf(e.ruleForm[e.parentSelect])>-1?t("el-checkbox",{key:a,attrs:{label:a.split("_")[1],name:r}},[e._v(e._s(r)+"\n                            ")]):e._e()]}))],2):2!=r.type||r.parentSelect?2==r.type&&r.parentSelect&&r.displayValue.split(",").indexOf(e.ruleForm[e.parentSelect])>-1?t("el-input",{attrs:{type:"password","auto-complete":"new-password",placeholder:r.sampleValue},on:{focus:function(t){return e.emptyVal(e.ruleForm[r.key],r.key)},blur:function(t){return e.des_encrypt(e.ruleForm[r.key],r.key)}},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,t)},expression:"ruleForm[item.key]"}}):6==r.type?t("el-input",{attrs:{type:"textarea",placeholder:r.sampleValue},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,"string"==typeof t?t.trim():t)},expression:"ruleForm[item.key]"}}):3==r.type?t("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:e.upload,headers:e.publics.ajaxHeaders(),"on-error":e.handleError,"before-upload":function(t){return e.beforeAvatarUpload(t,r)},"on-success":function(t,a,l){return e.handleSuccess(l,r)},"on-remove":function(t){return e.handleRemove(t,r)},"file-list":e.ruleForm[r.key]}},[t("el-checkbox-group",{staticStyle:{display:"none"},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,t)},expression:"ruleForm[item.key]"}},[t("el-checkbox",{attrs:{label:"复选框 A"}})],1),t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),"customJdbc"==r.fatherKey?t("span",{staticStyle:{"text-decoration":"underline",color:"#409eff"},on:{click:function(t){return t.stopPropagation(),e.blankUrl.apply(null,arguments)}}},[e._v("相关产品驱动包配置指引")]):e._e()],1):1==r.type?t("el-input",{attrs:{placeholder:r.sampleValue},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,"string"==typeof t?t.trim():t)},expression:"ruleForm[item.key]"}}):e._e():t("el-input",{attrs:{type:"password","auto-complete":"new-password",placeholder:r.sampleValue},on:{focus:function(t){return e.emptyVal(e.ruleForm[r.key],r.key)},blur:function(t){return e.des_encrypt(e.ruleForm[r.key],r.key)}},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,"string"==typeof t?t.trim():t)},expression:"ruleForm[item.key]"}}):t("el-select",{attrs:{placeholder:r.sampleValue},on:{change:function(t){return e.changeSelection(r)}},model:{value:e.ruleForm[r.key],callback:function(t){e.$set(e.ruleForm,r.key,t)},expression:"ruleForm[item.key]"}},[e._l(r.selectValue,(function(e,r,a){return[t("el-option",{key:a,attrs:{label:e,value:r,title:e+","+r+","+a}})]}))],2)],1):e._e()]}))],2):e._e()],1),t("template",{slot:"bottom"},[e.permitFun(e.permitList.testSource,e.permitList.testMySource)?t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTest,expression:"loadingTest"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm(1)}}},[e._v("测试连接")]):e._e(),e.permitFun(e.permitList.modifySource,e.permitList.modifyMySource)?t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingSave,expression:"loadingSave"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("提交")]):e._e(),t("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],2)}),[],!1,null,"61a5c10a",null);t.default=f.exports},fcd8:function(e,t,r){"use strict";r("9eae")}}]);