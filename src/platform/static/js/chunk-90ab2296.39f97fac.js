(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-90ab2296","chunk-7a1ef581"],{1617:function(e,t,r){"use strict";r("5632")},"4ef1":function(e,t,r){var o=r("5b68");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,r("499e").default)("4dc1dfd4",o,!0,{sourceMap:!1,shadowMode:!1})},5632:function(e,t,r){var o=r("b219");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,r("499e").default)("1b5e0773",o,!0,{sourceMap:!1,shadowMode:!1})},"5b68":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".process-config-edit[data-v-221b2790] .news-type-sys-introduction{min-height:90px!important;height:auto!important}.process-config-edit[data-v-221b2790] .news-type-sys-introduction /deep/ .el-textarea__inner{min-height:90px!important}",""])},6686:function(e,t,r){"use strict";r("4ef1")},"83ee":function(e,t,r){"use strict";r.r(t),r("ac6a"),r("456d"),r("7f7f"),r("8e6e"),r("c5f6"),r("28a5");var o=r("ade3"),n=(r("96cf"),r("1da1")),i=r("2f62"),a=r("aad9");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c,d={name:"processConfigPublic",props:{id:{type:String},optType:{type:String}},data:function(){return{preview:"",ruleForm:{name:null,roles:[],categoryId:null,dep:[],formIds:null,procCode:null},rules:{name:[{required:!0,message:"流程名称不能为空",trigger:"blur"}],categoryId:[{required:!0,message:"类型不能为空",trigger:"change"}]},isView:!1,typeList:[],defaultCheckedKeys:[],formList:[],isShowDialog:!1,formConf:{},key2:+new Date,formSearch:{page:1,rows:10}}},created:(c=Object(n.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._AJAX({url:"form.design.list",method:"GET",data:{page:1,rows:1e4,all:1}}).then((function(e){0==e.code&&(t.formList=e.result.rows)}));case 2:return e.next=4,this._AJAX({url:"sys.category.list",method:"GET",data:{page:1,rows:99999,exitProcess:"add"===this.optType?1:null}}).then((function(e){0==e.code&&(t.typeList=e.result.rows)}));case 4:if(!this.id){e.next=7;break}return e.next=7,this.loadData();case 7:"view"===this.optType&&(this.isView=!0);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)}),components:{adqTree:a.default},methods:l(l({},Object(i.b)(["_AJAX"])),{},{loadData:function(){var e=this;this._AJAX({url:"activiti.process.select.id",method:"GET",data:{id:this.id}}).then((function(t){if(0==t.code){var r=t.result;e.defaultCheckedKeys=r.dep?r.dep.split(",").map(Number):[],r.roles=r.roles?r.roles.split(",").map(Number):[],e.ruleForm=r,e.formList=r.forms.concat(e.formList),e.checkLinkData(),e.ruleForm.formIds=r.formIds}}))},checkLinkData:function(){var e=this,t=Object.assign({},this.ruleForm);t.formIds&&t.formIds.map((function(r){t.forms.map((function(t){r===t.id&&e.$nextTick((function(){e.$refs.multipleTable.toggleRowSelection(t)}))}))}))},handleSizeChange:function(e){this.formSearch.page=1,this.formSearch.rows=e,this.checkLinkData()},handleCurrentChange:function(e){this.formSearch.page=e,this.checkLinkData()},treeCheckChange:function(e,t){var r=this.$refs.tree.$refs.adqTree.getCheckedKeys();this.$set(this.ruleForm,"dep",r)},modifyCheckedKeys:function(e){this.defaultCheckedKeys=e},changeName:function(e){var t=this;this.typeList.forEach((function(r){r.id===e&&(t.ruleForm.procCode=r.code)}))},handleSelectionChange:function(e){this.ruleForm.formIds=e.map((function(e){return e.id}))},viewForm:function(e){e.formJson?(this.formConf=JSON.parse(e.formJson),this.isShowDialog=!0):this.$AudaqueToast.error({template:"无可预览的表单",methods:{okEvent:function(){}}})},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){var r=e;if(!t)return!1;var o=e.$refs.tree.$refs.adqTree.getCheckedKeys();if(o&&o.length>0){var n=Object.assign({},e.ruleForm);n.dep=o?o.join(","):"",n.roles=n.roles?n.roles.join(","):"",n.latest=null,e._AJAX({url:"add"===e.optType?"activiti.process.new":"activiti.process.update",method:"POST",data:n}).then((function(t){e.$AudaqueToast.tip({template:"add"===e.optType?"新增成功":"修改成功",methods:{okEvent:function(){r.$router.go(-1)}}})}))}else e.$AudaqueToast.error({template:"请选择可见范围",methods:{okEvent:function(){}}})}))}})},u=(r("6686"),r("2877")),f=Object(u.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"process-config-edit"},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"90px",disabled:e.isView}},[t("el-form-item",{attrs:{label:"流程名称",prop:"name"}},[t("el-input",{attrs:{maxlength:"24","show-word-limit":""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"==typeof t?t.trim():t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"业务名称",prop:"categoryId"}},[t("el-select",{attrs:{placeholder:"请选择",disabled:"edit"===e.optType},on:{change:e.changeName},model:{value:e.ruleForm.categoryId,callback:function(t){e.$set(e.ruleForm,"categoryId",t)},expression:"ruleForm.categoryId"}},e._l(e.typeList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"可见范围",prop:"dep"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",{staticStyle:{color:"#f56c6c"}},[e._v("*")]),e._v(" 可见范围")]),t("adq-tree",{ref:"tree",attrs:{defaultCheckedKeys:e.defaultCheckedKeys,"check-strictly":!0},on:{"check-change":e.treeCheckChange,"modify-checked-keys":e.modifyCheckedKeys}})],1),t("el-form-item",{attrs:{label:"备注",prop:"description"}},[t("el-input",{staticClass:"news-type-sys-introduction",attrs:{type:"textarea",autosize:"",placeholder:"",maxlength:"100","show-word-limit":""},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description","string"==typeof t?t.trim():t)},expression:"ruleForm.description"}})],1),t("el-form-item",{attrs:{label:"绑定表单",prop:"formIds"}},[t("el-table",{ref:"multipleTable",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.formList,border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.formSearch.page,e.formSearch.rows)}}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"formName",label:"表单名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",{staticClass:"iconfont iconchakan11 operate",attrs:{title:"预览表单"},on:{click:function(t){return e.viewForm(r.row)}}})]}}])})],1)],1)],1),t("el-dialog",{staticClass:"data-permission",attrs:{title:"预览表单",visible:e.isShowDialog,width:"500","close-on-click-modal":!1},on:{"update:visible":function(t){e.isShowDialog=t},close:function(t){return e.$refs.formParser.resetForm()}}},[Object.keys(e.formConf).length>0&&e.isShowDialog?t("form-parser",{key:e.key2,ref:"formParser",attrs:{formConf:e.formConf,isDisabled:!0}}):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.isShowDialog=!1}}},[e._v("关 闭")])],1)],1)],1)}),[],!1,null,"221b2790",null);t.default=f.exports},aad9:function(e,t,r){"use strict";r.r(t),r("8e6e"),r("456d"),r("7f7f"),r("ac6a");var o=r("ade3"),n=r("2f62");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={name:"adqTree",data:function(){return{filterText:"",isAllCheck:null,allIds:[],treeData:[],loading:!1,isSearch:!1}},watch:{treeData:{handler:function(e){},deep:!0},filterText:function(e){0===e.length&&(this.isSearch=!1,this.$refs.adqTree.filter(e))}},props:{defaultCheckedKeys:{type:Array,default:function(){return[]}},defaultExpandedKeys:{type:Array,default:function(){return[]}},checkStrictly:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!0},isCheckBtn:{type:Boolean,default:!0},expandOnClickNode:{type:Boolean,default:!0},nodeKey:{type:String,default:"id"},defaultProps:{type:Object,default:function(){return{label:"name",children:"children",isLeaf:"isEnd"}}}},mounted:function(){this.loadInit()},methods:a(a({},Object(n.b)(["_AJAX"])),{},{loadInit:function(){var e=this;this.loading=!0,this._AJAX({url:"org.findRootDept",method:"GET",data:{}}).then((function(t){0===t.code&&e._AJAX({url:"org.findRootDeptTree",method:"GET",data:{deptId:t.result.id}}).then((function(t){e.treeData=[t.result],e.loading=!1,e.defaultExpandedKeys.push(t.result.id),e.allIds=[],e.loadIds([t.result])}))}))},loadIds:function(e){var t=this;e.forEach((function(e){t.allIds.push(e.id),e.children&&e.children.length>0&&t.loadIds(e.children)}))},treeIsAllCheck:function(e){e?this.$refs.adqTree.setCheckedKeys(this.allIds):this.$refs.adqTree.setCheckedKeys([])},clickInquireTreeData:function(){var e=this;this.isSearch=!0,this.loading=!0,setTimeout((function(){e.$refs.adqTree.filter(e.filterText),e.$nextTick().then((function(){setTimeout((function(){e.loading=!1}),500)}))}),50)},parentSearch:function(e){this.filterText=e,this.clickInquireTreeData()},filterNode:function(e,t,r){return!e||-1!==t.name.indexOf(e)},filterNodeMethod:function(e){var t=this;!function r(o){o.map((function(o){var n=o[t.defaultProps.children];o.visible=t.filterNode(e,o),n&&n.length>0&&r(n)}))}(this.treeData)},handleNodeClick:function(e,t){this.$emit("node-click",e,t),this.showChildrenNode(e,t)},showChildrenNode:function(e,t){1!=t.level&&!t.isLeaf&&this.isSearch&&(t.expanded=!0,t.childNodes.forEach((function(e){e.visible=!0})))},handleCheckChange:function(e,t){this.$emit("check-change",e,t)},handleRenderContent:function(e,t){var r=t.node,o=t.data,n=(t.store,"iconfont icondrxx95 group");return o.isPosition?n=o.leader?"iconfont iconlingdao leader":"iconfont iconyuangong people":1===r.level&&(n="iconfont icondrxx95 root"),e("span",{class:n,style:""},[" ",o.name])}})},l=(r("1617"),r("2877")),c=Object(l.a)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"adq-tree"},[t("el-input",{staticClass:"filter-tree-input",attrs:{placeholder:"输入关键字进行过滤",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.clickInquireTreeData.apply(null,arguments)}},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[t("el-button",{staticClass:"query-btn",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.clickInquireTreeData},slot:"append"},[e._v("搜索")])],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"adq-tree-item",attrs:{"element-loading-spinner":"el-icon-loading"}},[e.showCheckbox&&e.isCheckBtn?t("el-radio-group",{staticStyle:{"margin-left":"20px"},model:{value:e.isAllCheck,callback:function(t){e.isAllCheck=t},expression:"isAllCheck"}},[t("el-radio-button",{attrs:{label:!0},nativeOn:{click:function(t){return e.treeIsAllCheck(!0)}}},[e._v("全选")]),t("el-radio-button",{attrs:{label:!1},nativeOn:{click:function(t){return e.treeIsAllCheck(!1)}}},[e._v("全不选")])],1):e._e(),t("el-tree",{ref:"adqTree",staticClass:"tree-dashed",attrs:{props:e.defaultProps,"show-checkbox":e.showCheckbox,"expand-on-click-node":e.expandOnClickNode,"node-key":e.nodeKey,"default-checked-keys":e.defaultCheckedKeys,"default-expanded-keys":e.defaultExpandedKeys,"check-strictly":e.checkStrictly,"render-content":e.handleRenderContent,"filter-node-method":e.filterNode,indent:20,data:e.treeData},on:{"node-click":e.handleNodeClick,"check-change":e.handleCheckChange}})],1)],1)}),[],!1,null,"3c72946d",null);t.default=c.exports},b219:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".adq-tree[data-v-3c72946d]{border:1px solid #dcdfe6;width:100%;z-index:99999;max-height:300px;overflow:auto}.adq-tree .filter-tree-input .query-btn[data-v-3c72946d]{background:#409eff;color:#fff}.adq-tree .adq-tree-item[data-v-3c72946d]{height:260px}.adq-tree .adq-tree-item[data-v-3c72946d] .el-loading-spinner i{font-size:30px}",""])}}]);