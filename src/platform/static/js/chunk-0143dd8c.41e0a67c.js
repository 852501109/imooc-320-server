(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0143dd8c"],{4052:function(e,t,r){"use strict";r("eca1")},"6a1a":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,'.row[data-v-296487fa]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row[data-v-296487fa],.table_box[data-v-296487fa]{width:90%;margin:0 auto}.table_box[data-v-296487fa]{overflow-x:auto}[data-v-296487fa] .el-date-editor.el-input,[data-v-296487fa] .el-date-editor.el-input__inner,[data-v-296487fa] .el-range-editor--medium.el-input__inner{width:100%}.el-icon-delete[data-v-296487fa]{color:#409eff;cursor:pointer}.newpro .el-progress-bar__inner[data-v-296487fa]:before{content:"";width:100%;height:100%;display:block;background-image:repeating-linear-gradient(-45deg,hsla(0,0%,100%,.15) 25%,transparent 0,transparent 50%,hsla(0,0%,100%,.15) 0,hsla(0,0%,100%,.15) 75%,transparent 0,transparent);background-size:40px 40px;-webkit-animation:mymove-296487fa 2s linear infinite;animation:mymove-296487fa 2s linear infinite}.newpro .normal[data-v-296487fa] .el-progress-bar__innerText{color:#000!important}.newpro .active[data-v-296487fa] .el-progress-bar__innerText{color:#fff!important}@-webkit-keyframes mymove-296487fa{0%{background-position:0}25%{background-position:50px}50%{background-position:100px}75%{background-position:150px}to{background-position:200px}}@keyframes mymove-296487fa{0%{background-position:0}25%{background-position:50px}50%{background-position:100px}75%{background-position:150px}to{background-position:200px}}',""])},c87a:function(e,t,r){"use strict";r.r(t),r("c5f6"),r("7f7f"),r("8e6e"),r("456d"),r("a481"),r("6b54"),r("ac6a"),r("6762"),r("2fdb"),r("7514"),r("28a5");var a=r("2909"),o=(r("96cf"),r("1da1")),i=r("ade3"),l=r("2f62");function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p,c={mixins:[r("c2b0").default],name:"",data:function(){return{isShowSelectModal:!1,menuList:[],checkData:[],progressUp:0,tableData:[],form:{recordType:2,resourceName:"",resourceId:"",userId:"",reportDepartment:"",reportTimeType:"",reportTimeIndex:"",reportTimeYear:"",reportTimes:[],reportRemark:""},dataReportParamList:[],rules:{userId:[{required:!0,message:"上报人不能为空",trigger:"change"}],reportDepartment:[{required:!0,message:"上报部门不能为空",trigger:"change"}],reportTimeType:[{required:!0,message:"期别不能为空",trigger:"change"}],reportTimeIndex:[{required:!0,message:"月度不能为空",trigger:"change"}],reportTimeYear:[{required:!0,message:"年不能为空",trigger:"change"}],reportTimes:[{required:!0,message:"日期不能为空",trigger:"change"}]},operateName:"",publicKey:"",optId:this.$route.query.id,optType:this.$route.query.optType,userMaxLength:window.accountMaxLength,dialogTableVisible:!1,currentType:"",search:"",tableDialogType:"",queryTableListTemp:[],selectValues:[],selectRow:{},hoverMenu:[{cdbh:1,cdmc:"第一个"},{cdbh:2,cdmc:"第二个"},{cdbh:3,cdmc:"第三个"}]}},watch:{},computed:s(s({},Object(l.d)("dataReporting",["dataReportingEdit","deptList","userList","userIdOrDeptId","periodList","headList"])),Object(l.d)("unDataReporting",["unDataReportingEdit"])),mounted:function(){},created:function(){var e=this;this.GETRESOURCEID({sourceId:this.optId}).then((function(){e.form.resourceName=e.unDataReportingEdit.resourceName,e.form.resourceId=e.optId})),this.GETDEPTLIST(),this.GETUSERLIST(),this.GETPERIODLIST(),this.GETUSERIDORDEPTID().then((function(){e.form.userId=e.userIdOrDeptId.userId||"",e.form.reportDepartment=e.userIdOrDeptId.deptId||""}))},methods:s(s(s(s({},Object(l.b)("dataReporting",["GETDEPTLIST","GETUSERLIST","GETUSERIDORDEPTID","GETPERIODLIST"])),Object(l.b)("unDataReporting",["GETRESOURCEID","DELETE_FILE_BY_ID","DOCUMENT_IMPORT"])),Object(l.b)(["_AJAX"])),{},{cancelSelect:function(){},handleSelectionChange:function(e){this.selectValues=e},reWriteSize:function(e){return e<1024?e+"B":e>1024&&e<1048576?(e/1024).toFixed(2)+"KB":e>1048576?(e/1048576).toFixed(2)+"M":e>1073741824?(e/1073741824).toFixed(2)+"G":void 0},importToExcel:(p=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,o,i,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target.files[0]){e.next=4;break}return e.abrupt("return");case 4:if(0!==r.size){e.next=8;break}return this.$refs.addFile.value="",this.$message.warning("上传文件不能为空"),e.abrupt("return");case 8:return(o=new FormData).append("file",r),o.append("resourceId",this.optId),i=this.tableData.some((function(e){return void 0!==e.index}))?Math.max.apply(Math,Object(a.a)(this.tableData.map((function(e){return e.index}))))+1:this.tableData.length,this.tableData.push({index:i,fileName:r.name,type:r.name.split(".")[r.name.split(".").length-1],fileSize:this.reWriteSize(r.size),percent:0,fileDesc:""}),e.next=15,this.chunksUpload(r,this.form.resourceId,i);case 15:if(l=e.sent){e.next=18;break}return e.abrupt("return");case 18:if(!this.tableData.find((function(e){return e.md5==l.md5&&e.fileName==r.name}))){e.next=23;break}return this.$message.warning("文件上传重复"),this.tableData.splice(this.tableData.length-1,1),this.$refs.addFile.value="",e.abrupt("return");case 23:this.tableData[this.tableData.length-1].id=l.id,this.tableData[this.tableData.length-1].md5=l.md5,this.$refs.multipleTable.doLayout(),this.$refs.addFile.value="";case 28:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)}),addFile:function(){this.$refs.addFile.click()},deleteFile:function(e){var t=this;if("all"!==e){this.$refs.multipleTable.doLayout();var r=t.tableData[e].index;t.tableData[e]&&t.tableData[e].id?(this.DELETE_FILE_BY_ID({ids:t.tableData[e].id}),this.tableData.splice(e,1),this.list[r].stopUpload=!0):(this.tableData.splice(e,1),this.list[r].stopUpload=!0)}else{if(0===this.selectValues.length)return void this.$message.warning("请选择后再删除");this.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){var e=t.selectValues.map((function(e){return e.id}));if(e.filter((function(e){return void 0!==e})).length>0)t.DELETE_FILE_BY_ID({ids:e.filter((function(e){return void 0!==e})).join(",")}).then((function(){var e=t.selectValues.map((function(e){return e.index}));t.tableData=t.tableData.filter((function(t){return!e.includes(t.index)})),e.forEach((function(e){t.list[e].stopUpload=!0})),t.selectValues=[]}));else{var r=t.selectValues.map((function(e){return e.index}));t.tableData=t.tableData.filter((function(e){return!r.includes(e.index)})),r.forEach((function(e){t.list[e].stopUpload=!0})),t.selectValues=[]}t.$refs.multipleTable.doLayout()}}})}},changeReportTimeType:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth();if("1"==this.form.reportTimeType){if(r>0)this.form.reportTimeYear=t.toString(),this.form.reportTimeIndex=r.toString();else{var a=t-1;this.form.reportTimeYear=a.toString(),this.form.reportTimeIndex=String(12)}this.form.reportTimes=[]}if("2"==this.form.reportTimeType){var o=Math.floor(r/3);if(o>0)this.form.reportTimeYear=t.toString(),this.form.reportTimeIndex=o.toString();else{var i=t-1;this.form.reportTimeYear=i.toString(),this.form.reportTimeIndex=String(4)}this.form.reportTimes=[]}if("3"==this.form.reportTimeType){var l=t-1;this.form.reportTimeYear=l.toString(),this.form.reportTimeIndex="",this.form.reportTimes=[]}if("4"==this.form.reportTimeType){this.form.reportTimeYear="",this.form.reportTimeIndex="";var n=new Date(e);n.setDate(n.getDate()-1);var s=new Date(e);s.setDate(s.getDate()-8),this.form.reportTimes[0]=s,this.form.reportTimes[1]=n}},selectModal:function(){this.isShowSelectModal=!0},subBtn:function(){var e=this;this.$refs.ruleform.validate((function(t){if(t){e.$store.commit("unDataReporting/CHANGELOADING",!0);var r=e.deepClone(e.form);r.fileList=e.tableData.filter((function(e){return void 0!==e.id})).map((function(e){return{id:e.id,fileDesc:e.fileDesc}})),e.DOCUMENT_IMPORT(r).then((function(){e.$message({message:"数据导入成功",type:"success",showClose:!0}),e.$router.go(-1)})).finally((function(){e.$store.commit("unDataReporting/CHANGELOADING",!1)}))}}))},deepClone:function(e){return JSON.parse(JSON.stringify(e))},addDataReportParamLis:function(){var e={};this.headList.forEach((function(t){e[t.code]=""})),this.dataReportParamList.push(e)},removeDataReportParamList:function(e){this.dataReportParamList.splice(e,1)},handleInput:function(e){e.fieldWidth=e.fieldWidth.replace(/\D/g,"")}})},m=(r("4052"),r("2877")),d=Object(m.a)(c,(function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"ruleform",staticClass:"form-item",attrs:{model:e.form,"label-width":"120px",rules:e.rules,disabled:"view"===e.optType}},[t("el-form-item",{attrs:{label:"资源名称",prop:"resourceName"}},[t("el-input",{attrs:{disabled:"",placeholder:"请输入","show-word-limit":""},model:{value:e.form.resourceName,callback:function(t){e.$set(e.form,"resourceName","string"==typeof t?t.trim():t)},expression:"form.resourceName"}})],1),t("el-form-item",{attrs:{label:"上报人",prop:"userId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}},e._l(e.userList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"上报部门",prop:"reportDepartment"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportDepartment,callback:function(t){e.$set(e.form,"reportDepartment",t)},expression:"form.reportDepartment"}},e._l(e.deptList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"期别",prop:"reportTimeType","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeReportTimeType},model:{value:e.form.reportTimeType,callback:function(t){e.$set(e.form,"reportTimeType",t)},expression:"form.reportTimeType"}},e._l(e.periodList,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),"1"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeIndex","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportTimeIndex,callback:function(t){e.$set(e.form,"reportTimeIndex",t)},expression:"form.reportTimeIndex"}},[t("el-option",{attrs:{label:"1月",value:"1"}}),t("el-option",{attrs:{label:"2月",value:"2"}}),t("el-option",{attrs:{label:"3月",value:"3"}}),t("el-option",{attrs:{label:"4月",value:"4"}}),t("el-option",{attrs:{label:"5月",value:"5"}}),t("el-option",{attrs:{label:"6月",value:"6"}}),t("el-option",{attrs:{label:"7月",value:"7"}}),t("el-option",{attrs:{label:"8月",value:"8"}}),t("el-option",{attrs:{label:"9月",value:"9"}}),t("el-option",{attrs:{label:"10月",value:"10"}}),t("el-option",{attrs:{label:"11月",value:"11"}}),t("el-option",{attrs:{label:"12月",value:"12"}})],1)],1)],1)],1)],1):e._e(),"2"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeIndex","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportTimeIndex,callback:function(t){e.$set(e.form,"reportTimeIndex",t)},expression:"form.reportTimeIndex"}},[t("el-option",{attrs:{label:"第一季度",value:"1"}}),t("el-option",{attrs:{label:"第二季度",value:"2"}}),t("el-option",{attrs:{label:"第三季度",value:"3"}}),t("el-option",{attrs:{label:"第四季度",value:"4"}})],1)],1)],1)],1)],1):e._e(),"3"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1):e._e(),"4"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimes","validate-event":!1}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.form.reportTimes,callback:function(t){e.$set(e.form,"reportTimes",t)},expression:"form.reportTimes"}})],1)],1):e._e()],1),t("el-form-item",{attrs:{label:"上报说明"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入","show-word-limit":""},model:{value:e.form.reportRemark,callback:function(t){e.$set(e.form,"reportRemark","string"==typeof t?t.trim():t)},expression:"form.reportRemark"}})],1),t("el-form-item",{attrs:{label:"","label-width":"0"}},[t("div",{staticClass:"row"},[t("div",[e._v("上传文件详情")]),t("div",[t("input",{ref:"addFile",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.importToExcel}}),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addFile}},[e._v("添加文件")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteFile("all")}}},[e._v("批量删除")])],1)]),t("div",{staticClass:"table_box"},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{type:"index",label:"序号"}}),t("el-table-column",{attrs:{prop:"fileName",label:"文档名称","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"type",label:"文件类型"}}),t("el-table-column",{attrs:{prop:"fileSize",label:"文件大小"}}),t("el-table-column",{attrs:{label:"文件上传进度"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticClass:"newpro",attrs:{width:"200"}},[t("el-progress",{class:[0===e.row.percent?"normal":"active"],attrs:{"text-inside":!0,"stroke-width":20,percentage:Number(e.row.percent.toFixed())}})],1)]}}])}),t("el-table-column",{attrs:{prop:"fileDesc",label:"上报说明","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{model:{value:r.row.fileDesc,callback:function(t){e.$set(r.row,"fileDesc",t)},expression:"scope.row.fileDesc"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.deleteFile(r.$index)}}},[t("i",{staticClass:"el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])]}}])})],1)],1)])],1)],1)}),[],!1,null,"296487fa",null);t.default=d.exports},eca1:function(e,t,r){var a=r("6a1a");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),(0,r("499e").default)("0ad1e7e7",a,!0,{sourceMap:!1,shadowMode:!1})}}]);