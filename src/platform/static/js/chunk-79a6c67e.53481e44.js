(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-79a6c67e"],{"4c02":function(e,t,r){var o=r("6dda");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,r("499e").default)("21a7817f",o,!0,{sourceMap:!1,shadowMode:!1})},"6dda":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".user-edit[data-v-4f80ed7b] .resource{border:1px solid #e1dfdc;height:5rem}.user-edit[data-v-4f80ed7b] .submit-wrap{text-align:center;margin-top:.2rem}.user-edit[data-v-4f80ed7b] .el-tree{height:3.5rem;overflow-y:scroll}.user-edit .paf-title[data-v-4f80ed7b]{cursor:pointer}.user-edit .agree[data-v-4f80ed7b]{color:red}.user-edit .div-margin[data-v-4f80ed7b]{line-height:22px}.user-edit[data-v-4f80ed7b] .form-item{width:99%;padding-right:0}.table_box[data-v-4f80ed7b]{width:100%;overflow-x:auto}.custom_table[data-v-4f80ed7b]{border-collapse:collapse;text-align:center}.custom_table thead tr[data-v-4f80ed7b]{background:#f9fafb}.custom_table thead th[data-v-4f80ed7b]{color:#666;font-size:13px}.custom_table tbody tr[data-v-4f80ed7b]{border:1px solid #ebeef5;padding:5px 0}.custom_table tbody i[data-v-4f80ed7b]{color:red;font-size:30px;cursor:pointer}.custom_table1 tbody td[data-v-4f80ed7b],.custom_table1 thead th[data-v-4f80ed7b]{width:140px}[data-v-4f80ed7b] .el-date-editor.el-input,[data-v-4f80ed7b] .el-date-editor.el-input__inner,[data-v-4f80ed7b] .el-range-editor--medium.el-input__inner{width:100%}",""])},8783:function(e,t,r){"use strict";r.r(t),r("7f7f"),r("8e6e"),r("456d"),r("a481"),r("5df3"),r("4f7f"),r("ac6a"),r("6b54");var o=r("ade3"),a=r("2f62");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var n={name:"",data:function(){return{form:{recordType:1,resourceId:"",resourceName:"",userId:"",reportDepartment:"",reportTimeType:"",reportTimeIndex:"",reportTimeYear:"",reportTimes:[],reportRemark:"",dataList:[]},rules:{userId:[{required:!0,message:"上报人不能为空",trigger:"change"}],reportDepartment:[{required:!0,message:"上报部门不能为空",trigger:"change"}],reportTimeType:[{required:!0,message:"期别不能为空",trigger:"change"}],reportTimeIndex:[{required:!0,message:"月度不能为空",trigger:"change"}],reportTimeYear:[{required:!0,message:"年不能为空",trigger:"change"}],reportTimes:[{required:!0,message:"日期不能为空",trigger:"change"}]},operateName:"",publicKey:"",optId:this.$route.query.id,optType:this.$route.query.optType,userMaxLength:window.accountMaxLength,dialogTableVisible:!1,currentType:"",search:"",tableDialogType:"",queryTableListTemp:[]}},watch:{},computed:l(l({},Object(a.d)("dataReporting",["dataReportingEdit","deptList","userList","userIdOrDeptId","periodList","headList"])),{},{percent:function(){var e=(3+this.headList.length)/this.headList.length;return document.documentElement.clientWidth/1422*e}}),created:function(){var e=this;this.GETRESOURCEID({sourceId:this.optId}).then((function(){e.form.resourceName=e.dataReportingEdit.resourceName,e.form.resourceId=e.optId})),this.GETDEPTLIST(),this.GETUSERLIST(),this.GETPERIODLIST(),this.GETUSERIDORDEPTID().then((function(){e.form.userId=e.userIdOrDeptId.userId||"",e.form.reportDepartment=e.userIdOrDeptId.deptId||""})),this.GETHEADLIST({resourecId:this.optId}).then((function(e){}))},methods:l(l({},Object(a.b)("dataReporting",["GETDEPTLIST","GETUSERLIST","GETUSERIDORDEPTID","GETPERIODLIST","GETHEADLIST","GETRESOURCEID","DATA_FILLING"])),{},{changeReportTimeType:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth();if("1"==this.form.reportTimeType){if(r>0)this.form.reportTimeYear=t.toString(),this.form.reportTimeIndex=r.toString();else{var o=t-1;this.form.reportTimeYear=o.toString(),this.form.reportTimeIndex=String(12)}this.form.reportTimes=[]}if("2"==this.form.reportTimeType){var a=Math.floor(r/3);if(a>0)this.form.reportTimeYear=t.toString(),this.form.reportTimeIndex=a.toString();else{var i=t-1;this.form.reportTimeYear=i.toString(),this.form.reportTimeIndex=String(4)}this.form.reportTimes=[]}if("3"==this.form.reportTimeType){var l=t-1;this.form.reportTimeYear=l.toString(),this.form.reportTimeIndex="",this.form.reportTimes=[]}if("4"==this.form.reportTimeType){this.form.reportTimeYear="",this.form.reportTimeIndex="";var n=new Date(e);n.setDate(n.getDate()-1);var s=new Date(e);s.setDate(s.getDate()-8),this.form.reportTimes[0]=s,this.form.reportTimes[1]=n}},subBtn:function(){var e=this;this.$refs.ruleform.validate((function(t){if(t){var r,o;if(e.$store.commit("dataReporting/CHANGELOADING",!0),e.form.dataList.forEach((function(t){e.headList.forEach((function(e){0!=e.nullAble||""!==t[e.code]&&null!==t[e.code]||r||(r=e.name||e.code)}))})),r)return void e.$message.warning("".concat(r,"字段不可为空"));if(e.headList.filter((function(e){return 1==e.primaryKey})).forEach((function(t){var r=e.form.dataList.map((function(e){return e[t.code]}));new Set(r).size===r.length||o||(o=t.name||t.code)})),o)return void e.$message.warning("".concat(o,"主键不可重复"));var a=e.deepClone(e.form);a.reportTimes.length>0&&(a.reportStartTime=a.reportTimes[0],a.reportEndTime=a.reportTimes[1]),e.DATA_FILLING(a).then((function(){e.$message({message:"数据填报成功",type:"success",showClose:!0}),e.$store.commit("dataReporting/CHANGELOADING",!1),e.$router.go(-1)})).finally((function(){e.$store.commit("dataReporting/CHANGELOADING",!1)}))}}))},deepClone:function(e){return JSON.parse(JSON.stringify(e))},addDataReportParamLis:function(){var e={};this.headList.forEach((function(t){e[t.code]=null})),this.form.dataList.push(e)},removeDataReportParamList:function(e){this.form.dataList.splice(e,1)},handleInput:function(e,t){e[t]=e[t].replace(/\D/g,"")}})},s=(r("b0dc"),r("2877")),p=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"ruleform",staticClass:"form-item",attrs:{model:e.form,"label-width":"120px",rules:e.rules,disabled:"view"===e.optType}},[t("el-form-item",{attrs:{label:"资源名称",prop:"resourceName"}},[t("el-input",{attrs:{disabled:"",placeholder:"请输入","show-word-limit":""},model:{value:e.form.resourceName,callback:function(t){e.$set(e.form,"resourceName","string"==typeof t?t.trim():t)},expression:"form.resourceName"}})],1),t("el-form-item",{attrs:{label:"上报人",prop:"userId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}},e._l(e.userList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"上报部门",prop:"reportDepartment"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportDepartment,callback:function(t){e.$set(e.form,"reportDepartment",t)},expression:"form.reportDepartment"}},e._l(e.deptList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"期别",prop:"reportTimeType","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeReportTimeType},model:{value:e.form.reportTimeType,callback:function(t){e.$set(e.form,"reportTimeType",t)},expression:"form.reportTimeType"}},e._l(e.periodList,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),"1"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{type:"year",placeholder:"选择年",format:"yyyy 年","value-format":"yyyy"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeIndex","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportTimeIndex,callback:function(t){e.$set(e.form,"reportTimeIndex",t)},expression:"form.reportTimeIndex"}},[t("el-option",{attrs:{label:"1月",value:"1"}}),t("el-option",{attrs:{label:"2月",value:"2"}}),t("el-option",{attrs:{label:"3月",value:"3"}}),t("el-option",{attrs:{label:"4月",value:"4"}}),t("el-option",{attrs:{label:"5月",value:"5"}}),t("el-option",{attrs:{label:"6月",value:"6"}}),t("el-option",{attrs:{label:"7月",value:"7"}}),t("el-option",{attrs:{label:"8月",value:"8"}}),t("el-option",{attrs:{label:"9月",value:"9"}}),t("el-option",{attrs:{label:"10月",value:"10"}}),t("el-option",{attrs:{label:"11月",value:"11"}}),t("el-option",{attrs:{label:"12月",value:"12"}})],1)],1)],1)],1)],1):e._e(),"2"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeIndex","validate-event":!1}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.reportTimeIndex,callback:function(t){e.$set(e.form,"reportTimeIndex",t)},expression:"form.reportTimeIndex"}},[t("el-option",{attrs:{label:"第一季度",value:"1"}}),t("el-option",{attrs:{label:"第二季度",value:"2"}}),t("el-option",{attrs:{label:"第三季度",value:"3"}}),t("el-option",{attrs:{label:"第四季度",value:"4"}})],1)],1)],1)],1)],1):e._e(),"3"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimeYear","validate-event":!1}},[t("el-date-picker",{attrs:{format:"yyyy 年","value-format":"yyyy",type:"year",placeholder:"选择年"},model:{value:e.form.reportTimeYear,callback:function(t){e.$set(e.form,"reportTimeYear",t)},expression:"form.reportTimeYear"}})],1)],1):e._e(),"4"==e.form.reportTimeType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"","label-width":"0",prop:"reportTimes","validate-event":!1}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.form.reportTimes,callback:function(t){e.$set(e.form,"reportTimes",t)},expression:"form.reportTimes"}})],1)],1):e._e()],1),t("el-form-item",{attrs:{label:"上报说明"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入","show-word-limit":""},model:{value:e.form.reportRemark,callback:function(t){e.$set(e.form,"reportRemark","string"==typeof t?t.trim():t)},expression:"form.reportRemark"}})],1),t("el-form-item",{attrs:{label:"上报数据"}},[t("div",{staticClass:"table_box"},[t("table",{staticClass:"custom_table custom_table1",style:{width:"".concat(130*e.headList.length*e.percent,"px")}},[t("thead",[t("tr",[t("th",[e._v("序号")]),e._l(e.headList,(function(r,o){return t("th",{key:o,style:{width:"".concat(130*e.percent,"px")}},[e._v("\n                                "+e._s(r.name||r.code)+"\n                            ")])})),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:e.addDataReportParamLis}})],1)],2)]),t("tbody",e._l(e.form.dataList,(function(r,o){return t("tr",{key:o},[t("td",[e._v("\n                                "+e._s(o+1)+"\n                            ")]),e._l(e.headList,(function(o,a){return t("td",{key:a,style:{width:"".concat(130*e.percent,"px")}},["float"===o.columnType||"double"===o.columnType||"decimal"===o.columnType||"numeric"===o.columnType?t("el-input-number",{attrs:{precision:o.scale,step:.1,max:Math.pow(10,o.length)},model:{value:r[o.code],callback:function(t){e.$set(r,o.code,"string"==typeof t?t.trim():t)},expression:"i[item.code]"}}):"char"===o.columnType||"varchar"===o.columnType||"character varying"===o.columnType?t("el-input",{attrs:{maxlength:o.length,"show-word-limit":"",placeholder:"请输入"},model:{value:r[o.code],callback:function(t){e.$set(r,o.code,"string"==typeof t?t.trim():t)},expression:"i[item.code]"}}):"int"===o.columnType||"integer"===o.columnType?t("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.handleInput(r,o.code)}},model:{value:r[o.code],callback:function(t){e.$set(r,o.code,"string"==typeof t?t.trim():t)},expression:"i[item.code]"}}):"datetime"===o.columnType||"timestamp without time zone"===o.columnType?t("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",align:"right",type:"datetime",placeholder:"选择日期"},model:{value:r[o.code],callback:function(t){e.$set(r,o.code,"string"==typeof t?t.trim():t)},expression:"i[item.code]"}}):"date"===o.columnType||"time"===o.columnType?t("el-date-picker",{attrs:{format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"选择日期"},model:{value:r[o.code],callback:function(t){e.$set(r,o.code,"string"==typeof t?t.trim():t)},expression:"i[item.code]"}}):t("el-input",{attrs:{placeholder:"请输入"},model:{value:r[o.code],callback:function(t){e.$set(r,o.code,"string"==typeof t?t.trim():t)},expression:"i[item.code]"}})],1)})),t("td",[t("i",{staticClass:"el-icon-remove",style:{color:"view"===e.optType?"#f08383":"#f00"},attrs:{disabled:"view"===e.optType},on:{click:function(t){return e.removeDataReportParamList(o)}}})])],2)})),0)])])])],1)],1)}),[],!1,null,"4f80ed7b",null);t.default=p.exports},b0dc:function(e,t,r){"use strict";r("4c02")}}]);