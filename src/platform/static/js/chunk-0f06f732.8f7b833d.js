(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0f06f732","chunk-b49d82d2","chunk-cc944656","chunk-6359d582","chunk-2d20fa89"],{"0453":function(e,t,a){var r=a("eecc");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("4e010a4b",r,!0,{sourceMap:!1,shadowMode:!1})},1913:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".ant_wrapper[data-v-39a62972]{position:relative}.ant_wrapper .disabled[data-v-39a62972]{position:absolute;width:100%;height:100%;left:0;top:0;z-index:9999;cursor:not-allowed}.container[data-v-39a62972]{height:3000px;width:1000px}#context-menu[data-v-39a62972]{position:absolute;-webkit-box-shadow:0 0 6px rgba(0,0,0,.5);box-shadow:0 0 6px rgba(0,0,0,.5);min-width:180px;height:auto;background:#fff;-webkit-transition:display .8s ease;transition:display .8s ease;z-index:999}#context-menu div.label[data-v-39a62972]{color:#c3c3c3}#context-menu>div[data-v-39a62972]{padding:11px 0;width:90%;cursor:pointer;text-align:center;color:#686868;border-bottom:1px solid #d6d6d6;margin:0 auto;font-size:14px}",""])},"21d4":function(e,t,a){"use strict";a.r(t),a("20d6"),a("6762"),a("2fdb"),a("ffc1"),a("28a5"),a("7514"),a("ac6a"),a("8615"),a("3e2f");var r=a("5728"),n={props:{isDisabled:{type:Boolean,default:!1},allField:{type:Object,default:function(){}}},data:function(){return{connectingList:[],current:{},loading:!1}},components:{},computed:{currentField:function(){var e=this,t=Object.values(this.allField).flat();if(this.current.id)return t.find((function(t){return t.id==e.current.id.split("-")[1]}))}},mounted:function(){var e=this;setTimeout((function(){document.addEventListener("click",(function(e){document.getElementById("context-menu")&&(document.getElementById("context-menu").style.display="none")})),e.initAntV()}),100)},methods:{antClear:function(){this.graph.clearCells()},initLine:function(e){var t=this;e.forEach((function(e){t.connectingList.some((function(t){return t.sourceColumnId==="1-".concat(e.sourceColumnId,"-out")&&t.target==="2-".concat(e.targetColumnId,"-in")}))||(t.graph.addEdge({source:{cell:"1-".concat(e.sourceColumnId),port:"1-".concat(e.sourceColumnId,"-out")},target:{cell:"2-".concat(e.targetColumnId),port:"2-".concat(e.targetColumnId,"-in")},attrs:{line:{stroke:"#A2B1C3",strokeWidth:2}}}),t.connectingList.push({source:"1-".concat(e.sourceColumnId,"-out"),target:"2-".concat(e.targetColumnId,"-in")}))}))},autoMap:function(e){var t=this;Object.entries(e).forEach((function(e){e[1].forEach((function(a){t.connectingList.some((function(t){return t.source==="1-".concat(e[0],"-out")&&t.target==="2-".concat(a,"-in")}))||(t.graph.addEdge({source:{cell:"1-".concat(e[0]),port:"1-".concat(e[0],"-out")},target:{cell:"2-".concat(a),port:"2-".concat(a,"-in")},attrs:{line:{stroke:"#A2B1C3",strokeWidth:2}}}),t.connectingList.push({source:"1-".concat(e[0],"-out"),target:"2-".concat(a,"-in")}))}))}))},initField:function(e,t){var a=this;"left"===e?t.forEach((function(e,t){var r=e.columnComment?"(".concat(e.columnComment,")"):"";a.addNode({x:0,y:50*(t+1)},"1-".concat(e.id),"".concat(e.columnName).concat(r),"out")})):t.forEach((function(e,t){var r=e.columnComment?"(".concat(e.columnComment,")"):"";a.addNode({x:600,y:50*(t+1)},"2-".concat(e.id),"".concat(e.columnName).concat(r),"in")}))},emptyMap:function(){var e=this;this.graph.getEdges().forEach((function(t){e.graph.removeEdge(t.id)})),this.connectingList=[]},del:function(){var e=this;"line"===this.current.type&&this.graph.removeEdge(this.current.id),"node"===this.current.type&&this.graph.getConnectedEdges(this.current.id).forEach((function(t){e.graph.removeEdge(t.id)}))},addNode:function(e,t,a,r){var n={id:t,x:e.x,y:e.y,width:250,height:40,label:a.slice(0,18)+(a.length>18?"...":""),attrs:{body:{stroke:"#fff",fill:"#5394eb",color:"#fff",rx:10,ry:10},text:{fill:"#fff",textWrap:{width:-10,height:"50%",ellipsis:!0,breakWord:!0}}},ports:{groups:{in:{position:"left",attrs:{circle:{r:7,magnet:!0,stroke:"#5ea9e2",strokeWidth:1,fill:"#fff"}}},out:{position:"right",attrs:{circle:{r:7,magnet:!0,stroke:"#5ea9e2",strokeWidth:1,fill:"#fff"}}}},items:[]}};n.ports.items="in"===r?[{id:"".concat(t,"-in"),group:"in"}]:[{id:"".concat(t,"-out"),group:"out"}],this.graph.addNode(n)},initAntV:function(){var e=this;this.graph=new r.a({panning:{enabled:!0},container:document.getElementById("container"),connecting:{allowBlank:!1,snap:!0,allowNode:!1,allowLoop:!1,allowEdge:!1,highlight:!0,createEdge:function(){return new r.f.Edge({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2}}})}},width:3e3,height:3e3}),this.graph.on("node:contextmenu",(function(t){t.e;var a=t.x,r=t.y,n=t.node;if(t.view,!e.isDisabled){e.current={type:"node",id:n.id};var o=document.getElementById("context-menu");o.style.display="block",o.style.left=a+"px",o.style.top=r+10+"px"}})),this.graph.on("edge:contextmenu",(function(t){t.e;var a=t.x,r=t.y,n=t.edge;if(t.view,!e.isDisabled){e.current={type:"line",id:n.id};var o=document.getElementById("context-menu");o.style.display="block",o.style.left=a+"px",o.style.top=r+10+"px"}})),this.graph.on("edge:connected",(function(t){t.e,t.isNew;var a=t.edge;if(t.previousCell,t.currentCell,a.getSourceCell()){var r=a.source.port,n=a.target.port;r.includes("in")||n.includes("out")||parseInt(r.split("-")[0])>parseInt(n.split("-")[0])?e.graph.removeEdge(a.id):!e.connectingList.some((function(e){return e.source===r&&e.target===n}))&&r&&n&&e.connectingList.push({source:r,target:n})}})),this.graph.on("edge:removed",(function(t){var a=e.connectingList.findIndex((function(e){return e.source===t.cell.source.cell+"-out"&&e.target===t.cell.target.cell+"-in"}));a>-1&&e.connectingList.splice(a,1)}))}}},o=(a("2781"),a("2877")),i=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"ant_wrapper"},[e.isDisabled?e._e():t("div",{staticStyle:{display:"none"},attrs:{id:"context-menu"}},["line"===e.current.type?t("div",{on:{click:e.del}},[e._v("删除映射")]):e._e(),"node"===e.current.type?t("div",{on:{click:e.del}},[e._v("删除所有映射")]):e._e(),"node"===e.current.type?t("div",[t("div",{staticClass:"label"},[e._v("字段名称")]),t("div",[e._v(e._s(e.currentField.columnName))])]):e._e(),"node"===e.current.type&&""!==e.currentField.columnComment?t("div",[t("div",{staticClass:"label"},[e._v("中文名称")]),t("div",[e._v(e._s(e.currentField.columnComment))])]):e._e()]),t("div",{attrs:{id:"container"}})])}),[],!1,null,"39a62972",null);t.default=i.exports},2781:function(e,t,a){"use strict";a("b399")},"2fc1":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".require[data-v-c3d5d4fa]{color:#f56c6c}.search[data-v-c3d5d4fa]{width:800px;margin:0 auto}.row[data-v-c3d5d4fa]{margin-bottom:20px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row[data-v-c3d5d4fa] .el-form-item{margin-bottom:0!important}.row .label[data-v-c3d5d4fa]{width:120px;vertical-align:middle;font-size:14px;color:#606266}.row .label[data-v-c3d5d4fa],.row>div[data-v-c3d5d4fa]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row[data-v-c3d5d4fa] .el-form-item__content{margin-left:0!important}.row[data-v-c3d5d4fa] .el-input.is-disabled .el-input__inner{background:#fbfbfb}.click_modal[data-v-c3d5d4fa]{position:absolute;width:100%;height:100%;z-index:999;cursor:pointer}",""])},"53c9":function(e,t,a){"use strict";a("0453")},"5e65":function(e,t,a){"use strict";a.r(t),a("8e6e"),a("456d");var r=a("2909"),n=(a("28a5"),a("6762"),a("2fdb"),a("ffc1"),a("a481"),a("7514"),a("ac6a"),a("ade3")),o=a("2f62"),i=a("b522"),s=a("ec97"),c=a("97de"),l=a("21d4");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={mixins:[i.default],data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],showTableSelectionPage:!1,currentType:{},currentSelectDatabase:{},selectParam:{id:"",mappingDesc:"",targetDatabase:"",alreadySelectTargetTable:[],alreadySelectTargetTableValue:[],sourceRows:[{sourceDatabase:"",alreadySelectSourceTable:[],alreadySelectSourceTableValue:[]}]},allField:{},value:"",rowId:this.$route.query.id,filter:"view"!=this.$route.query.filter}},computed:d(d({},Object(o.d)("metaDataMapping",["metaTableMappingDetail"])),{},{currentLayerValue:function(){return this.selectParam?this.selectParam.targetDatabase:""},targetId:function(){return this.selectParam.alreadySelectTargetTableValue[0]||""},sourceId:function(){return this.selectParam.sourceRows[0]&&this.selectParam.sourceRows[0].alreadySelectSourceTableValue[0]||""}}),components:{searchGroup:s.default,tableSelectionPage:c.default,antV6:l.default},methods:d(d(d({},Object(o.b)(["_AJAX"])),Object(o.b)("metaDataMapping",["GOEDITMETATABLEMAPPING","MODIFYMETATABLEMAPPING","ADDMETATABLEMAPPING","INSERT","UPDATE","GET_DETAIL"])),{},{emptyMap:function(){this.$refs.antV6.emptyMap()},autoMap:function(){var e=this.allField[this.sourceId],t=this.allField[this.targetId],a={};e.forEach((function(e){var r=t.find((function(t){return t.columnName===e.columnName})),n=t.find((function(t){return t.columnName!==e.columnName&&t.columnName.toLowerCase()===e.columnName.toLowerCase()})),o=t.find((function(t){return t.columnName!==e.columnName&&t.columnName.toLowerCase()!==e.columnName.toLowerCase()&&t.columnName.replace("_","").toLowerCase()===e.columnName.replace("_","").toLowerCase()}));if(a[e.id]=[],r){a[e.id].push(r.id);var i=t.find((function(e){return e.sourceColumnId===r.id}));i&&a[e.id].push(i.id)}if(n){a[e.id].push(n.id);var s=t.find((function(e){return e.sourceColumnId===n.id}));s&&a[e.id].push(s.id)}o&&(a[e.id].push(o.id),t.find((function(e){return e.sourceColumnId===o.id}))&&a[e.id].push(o.id))})),Object.entries(a).length>0&&this.$refs.antV6.autoMap(a)},subBtn:function(){var e=this,t=this.selectParam.targetDatabase,a=this.selectParam.sourceRows[0]?this.selectParam.sourceRows[0].sourceDatabase:"";if(""!==this.sourceId&&""!==this.targetId)if(0!==this.$refs.antV6.connectingList.length){var r={sourceTableLevel:this.storey.includes(a)?a:"au_pretank",targetTableLevel:t,sourceTableId:this.sourceId,targetTableId:this.targetId,mappingDesc:""};this.rowId?(r.id=this.selectParam.id,r.columnMappingDtoList=this.$refs.antV6.connectingList.map((function(t){return{tableMappingId:e.rowId,sourceColumnId:t.source.split("-")[1],targetColumnId:t.target.split("-")[1]}}))):r.columnMappingDtoList=this.$refs.antV6.connectingList.map((function(e){return{sourceColumnId:e.source.split("-")[1],targetColumnId:e.target.split("-")[1]}})),this.$route.query.id?this.UPDATE(r).then((function(){e.$message.success("编辑成功"),e.$router.go(-1)})):this.INSERT(r).then((function(){e.$message.success("添加成功"),e.$router.go(-1)}))}else this.$message.warning("至少有一条字段映射");else this.$message.warning("源表或目标表不可以为空")},clone:function(e){return JSON.parse(JSON.stringify(e))},handleSourceChange:function(e){this.$set(e,"alreadySelectSourceTable",[]),this.$set(e,"alreadySelectSourceTableValue",[])},handleTargetChange:function(){this.selectParam.alreadySelectTargetTable=[],this.selectParam.alreadySelectTargetTableValue=[],this.selectParam.sourceRows.splice(1,this.selectParam.sourceRows.length)},selectTable:function(e,t){if("source"!==e||""!==this.selectParam.sourceRows[t].sourceDatabase)if("target"!==e||""!==this.selectParam.targetDatabase){var a=[].concat(Object(r.a)(this.databaseList[0].options),Object(r.a)(this.databaseList[1].options));if(this.currentType={type:e,index:t},"source"===e){var n=this.selectParam.sourceRows[t].sourceDatabase;this.currentSelectDatabase=a.find((function(e){return e.code===n}))}if("target"===e){var o=this.selectParam.targetDatabase;this.currentSelectDatabase=a.find((function(e){return e.code===o}))}this.showTableSelectionPage=!0}else this.$AudaqueToast.warn({template:"目标层不可为空"});else this.$AudaqueToast.warn({template:"源数据层不可为空"})},initMap:function(e){var t=this,a=this.currentType.type,r=this.currentType.index;if(e.length>0&&("source"===a&&(this.selectParam.sourceRows[r].alreadySelectSourceTable=e,this.selectParam.sourceRows[r].alreadySelectSourceTableValue=e.map((function(e){return e.id}))),"target"===a)){if(this.selectParam.alreadySelectTargetTableValue[0]===e.map((function(e){return e.id}))[0])return void(this.showTableSelectionPage=!1);this.selectParam.alreadySelectTargetTable=e,this.selectParam.alreadySelectTargetTableValue=e.map((function(e){return e.id}))}this.showTableSelectionPage=!1,""!==this.sourceId&&""!==this.targetId&&this._AJAX({url:"stepOds.getOriginOrTargetColumn",method:"GET",data:{sourceTableId:this.sourceId,targetTableId:this.targetId}}).then((function(e){t.allField=e,t.$refs.antV6.antClear(),t.$refs.antV6.initField("left",e[t.sourceId]),t.$refs.antV6.initField("right",e[t.targetId])}))}}),mounted:function(){var e=this;this.rowId&&this.GET_DETAIL({tableMappingId:this.rowId}).then((function(t){e.selectParam.id=t.id,e.selectParam.mappingDesc=t.mappingDesc,e.selectParam.targetDatabase=t.targetTableLevel,e.selectParam.alreadySelectTargetTable=[{tableName:t.targetTableName,id:t.targetTableId}],e.selectParam.alreadySelectTargetTableValue=[t.targetTableId],e.selectParam.sourceRows[0].sourceDatabase=t.sourceTableLevel,e.selectParam.sourceRows[0].alreadySelectSourceTable=[{tableName:t.sourceTableName,id:t.sourceTableId}],e.selectParam.sourceRows[0].alreadySelectSourceTableValue=[t.sourceTableId],""!==e.sourceId&&""!==e.targetId&&e._AJAX({url:"stepOds.getOriginOrTargetColumn",method:"GET",data:{sourceTableId:e.sourceId,targetTableId:e.targetId}}).then((function(a){e.allField=a,e.$refs.antV6.antClear(),e.$refs.antV6.initField("left",a[e.sourceId]),e.$refs.antV6.initField("right",a[e.targetId]),e.$refs.antV6.initLine(t.columnMappingDtoList)}))}))},created:function(){}},f=(a("53c9"),a("2877")),h=Object(f.a)(p,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{attrs:{title:e.filter?e.rowId?"源表映射信息表编辑":"源表映射信息表新增":"源表映射信息表查看","opt-type":e.$route.query.filter},on:{"submit-click":e.subBtn}},[t("el-form",{attrs:{disabled:!e.filter}},[t("search-group",{attrs:{selectParam:e.selectParam,databaseList:e.databaseList},on:{select:e.selectTable,sourceChange:e.handleSourceChange,targetChange:e.handleTargetChange}}),e.showTableSelectionPage?t("table-selection-page",{attrs:{show:e.showTableSelectionPage,currentSelectDatabase:e.currentSelectDatabase,currentLayerValue:e.currentLayerValue,selectParam:e.selectParam,currentType:e.currentType},on:{submit:e.initMap,close:function(t){e.showTableSelectionPage=!1}}}):e._e(),t("div",{staticClass:"row"},[""!==e.sourceId&&""!==e.targetId?t("el-button",{on:{click:e.emptyMap}},[e._v("清空")]):e._e(),""!==e.sourceId&&""!==e.targetId?t("el-button",{on:{click:e.autoMap}},[e._v("自动映射")]):e._e()],1),t("div",{staticClass:"row"},[t("antV6",{ref:"antV6",attrs:{isDisabled:e.$route.query.filter&&"view"==e.$route.query.filter,allField:e.allField}})],1)],1)],1)}),[],!1,null,"5fdb62f8",null);t.default=h.exports},"79ed":function(e,t,a){"use strict";a("bf69")},"7a60":function(e,t,a){var r=a("ae02");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("34c7372a",r,!0,{sourceMap:!1,shadowMode:!1})},"97de":function(e,t,a){"use strict";a.r(t),a("6762"),a("2fdb"),a("a481"),a("8e6e"),a("ac6a"),a("456d"),a("c5f6"),a("7514"),a("6b54");var r=a("ade3"),n=a("2f62");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={props:{show:{type:Boolean,default:!1},currentSelectDatabase:{type:Object,default:function(){}},currentLayerValue:{type:String,default:""},selectParam:{type:Object,default:function(){}},currentType:{type:Object,default:function(){}}},data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],datas:[],templateSelection:"",tableData:[],selectedRow:null,multipleSelection:[],defaultProps:{label:"name",children:"children"},treeExpandData:[],searchText:"",param:{code:"",type:"",tagId:null,tableNameOrComment:"",page:1,rows:10,total:0}}},components:{},computed:{},mounted:function(){this.init(),this.$nextTick((function(){document.querySelector(".pane-comp")&&(document.querySelector(".pane-comp").style.width="177px")}))},methods:i(i(i({},Object(n.b)("fusionTask",["GET_TREE"])),Object(n.b)(["_AJAX"])),{},{init:function(){var e=this;this.$nextTick((function(){var t=document.querySelector(".custom-container");t&&(t.style.height=t.clientHeight+"px",e.getTree().then((function(){e.selectCurrent()})))}))},selectCurrent:function(){this.param.page=1,this.param.rows=10,this.param.code=this.currentSelectDatabase.code,this.param.type=this.currentSelectDatabase.type,this.param.tagId=null,this.param.tableNameOrComment="",this.getTable()},getTree:function(){var e=this;return new Promise((function(t,a){e.param.tableNameOrComment="",e.GET_TREE().then((function(a){e.datas=a||[],e.treeExpandData.push("1"),t(a)})).catch((function(e){a(e)}))}))},onSearch:function(){this.getTable()},getTable:function(){var e=this,t={code:this.param.code,type:this.param.type.toString(),page:this.param.page,rows:this.param.rows,tableNameOrComment:this.param.tableNameOrComment};this.param.tagId&&(t.tagId=this.param.tagId),this._AJAX({url:"task.stepHeader.getTableByDBTag",method:"get",data:t}).then((function(t){e.tableData=t.rows,e.param.total=t.total}))},flattenArray:function(e){for(var t=[],a=0;a<e.length;a++)Array.isArray(e[a])?t=t.concat(this.flattenArray(e[a])):t.push(e[a]);return t},onSubmit:function(){var e=this,t=Array.isArray(this.templateSelection)?this.templateSelection:[this.tableData.find((function(t){return t.id===e.templateSelection}))];if((t=t.filter((function(e){return void 0!==e}))).some((function(e){return 0===e.tableIscreate}))&&this.storey.includes(this.currentSelectDatabase.code))return this.$AudaqueToast.warn({template:"选中的含有未创建表，请前往：模型分层-".concat(this.currentSelectDatabase.label,"中创建"),methods:{okEvent:function(){}}}),!1;var a=this.flattenArray(this.selectParam.sourceRows.map((function(e){return e.alreadySelectSourceTableValue})));if(("au_dwd"===this.currentLayerValue||"au_dws"===this.currentLayerValue)&&t.some((function(e){return a.includes(e.id)})))return this.$AudaqueToast.warn({template:"当前选中的表与已选中的表有重复值，请重新选择",methods:{okEvent:function(){}}}),!1;this.$emit("submit",t)},isSelectable:function(e){return!0},handleClose:function(){this.$emit("close")},handleRowClick:function(e){this.selectedRow===e?this.selectedRow=null:this.selectedRow=e},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.getTable()},handleCurrentChange:function(e){this.param.page=e,this.getTable()},handleCheckboxChange:function(e){e.checked||(this.selectedRow=null)},rangrow:function(e){this.templateSelection=e.id},handleSelectionChange:function(e){this.templateSelection=e},handleNodeClick:function(e){this.param.code=this.currentSelectDatabase.code,this.param.type=this.currentSelectDatabase.type,this.param.tagId=Number(e.id),this.param.page=1,this.param.rows=10,this.getTable()}})},c=(a("f39a"),a("2877")),l=Object(c.a)(s,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"库表选择",visible:e.show,width:"80%","before-close":e.handleClose,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[t("div",{staticClass:"custom-container",staticStyle:{"min-height":"60vh"}},[t("audaque-resize-split-page",[t("template",{slot:"leftPane"},[t("div",{staticStyle:{"padding-left":"24px","white-space":"nowrap",overflow:"hidden"}},[e._v("\n                    当前库："),t("span",{staticStyle:{cursor:"pointer",color:"#409eff"},on:{click:e.selectCurrent}},[e._v(e._s(e.currentSelectDatabase.label)+"--")])]),t("el-tree",{staticClass:"tree-dashed",attrs:{data:e.datas,props:e.defaultProps,"default-expanded-keys":e.treeExpandData,"node-key":"id"},on:{"node-click":e.handleNodeClick}})],1),t("template",{slot:"rightPane"},[t("div",{staticClass:"row",staticStyle:{"margin-bottom":"10px"}},[t("div",{staticStyle:{width:"50%"}},[t("el-input",{attrs:{placeholder:"通过表名，表中文名模糊查询"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.param.tableNameOrComment,callback:function(t){e.$set(e.param,"tableNameOrComment",t)},expression:"param.tableNameOrComment"}})],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("筛选")])],1)]),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","highlight-current-row":""},on:{"row-click":e.rangrow,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{align:"center",width:"55",label:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-radio",{staticClass:"radio",attrs:{label:a.row.id},model:{value:e.templateSelection,callback:function(t){e.templateSelection=t},expression:"templateSelection"}},[e._v(" ")])]}}])}),t("el-table-column",{attrs:{width:"80",prop:"schemaName",label:"数据库名"}}),t("el-table-column",{attrs:{prop:"tableName",label:"表名"}}),t("el-table-column",{attrs:{prop:"tableComment",label:"表中文描述"}}),t("el-table-column",{attrs:{width:"80",prop:"dataNum",label:"数据量"}}),t("el-table-column",{attrs:{width:"100",prop:"tagFullName",label:"元数据标签"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.tagFullName?t("span",{domProps:{innerHTML:e._s(a.row.tagFullName.replace(/;/g,"<br>").replace(/,/g,"→").replace(/;$/,""))}}):e._e()]}}])}),e.storey.includes(e.currentSelectDatabase.code)?t("el-table-column",{attrs:{prop:"tableIscreate",label:"表是否已创建",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(1===t.row.tableIscreate?"已创建":"未创建")+"\n                        ")]}}],null,!1,1411126668)}):e._e()],1),t("adq-pagination",{attrs:{"current-page":e.param.page,total:e.param.total,"page-size":e.param.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)],1),t("div",{staticClass:"dialog-footer row",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{on:{click:e.handleClose}},[e._v("取消")])],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确认")])],1)])])}),[],!1,null,"1c1e1cc6",null);t.default=l.exports},ae02:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".row[data-v-1c1e1cc6]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row>div[data-v-1c1e1cc6]:first-child{margin-right:10px}[data-v-1c1e1cc6] .el-dialog__body{max-height:100%!important}[data-v-1c1e1cc6] .pane-comp,[data-v-1c1e1cc6] .tree-dashed{overflow:auto}",""])},b399:function(e,t,a){var r=a("1913");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("10a03d66",r,!0,{sourceMap:!1,shadowMode:!1})},b522:function(e,t,a){"use strict";a.r(t),a("8e6e"),a("456d"),a("7f7f"),a("7514"),a("6762"),a("2fdb"),a("ac6a");var r=a("ade3"),n=a("2f62");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={computed:i({},Object(n.d)("fusionTask",["databaseConf"])),data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],qzkOption:[{code:"au_pretank",label:"前置库",type:"0"}],databaseList:[{label:"前置库",options:[]},{label:"",options:[]}],nameMap:{0:"stepStart",au_ods:"stepOds",au_std:"stepStd",au_dwd:"stepDwd",au_dwm:"stepDwm",au_dws:"stepDws",au_app:"stepApp"},titleMap:{0:"开始",1:"归集层",2:"标准层",3:"基础层",4:"主题层",5:"专题层",6:"安全层",7:"前置库"},process:[{id:"",title:"开始",stepId:"",success:!1}]}},methods:i(i({},Object(n.b)("fusionTask",["GET_DATA_BASE_LIST","GET_STEP_HEADERR"])),{},{getStepHeader:function(){var e=this;return new Promise((function(t){e.GET_STEP_HEADERR({taskId:e.$route.query.taskId}).then((function(a){if(a&&a.length>0){var r=a;r.forEach((function(t,a){if(0===a)t.success=!0,t.title="开始";else{var r=t.stepDetailList[0].targetDbCode;t.success=!0,t.title=e.storey.includes(r)?e.databaseList[1].options.find((function(e){return e.code===r})).label:e.databaseList[0].options.find((function(e){return e.code===r})).label}})),e.process=r}t(a)}))}))}}),created:function(){var e=this;this.isLoading=!0,this.databaseList[1].options=[],this.GET_DATA_BASE_LIST().then((function(){e.databaseConf.frontDBList.forEach((function(t,a){e.databaseList[0].options.push({label:t.name,value:a+1,type:t.type,code:t.code})})),e.databaseConf.modelDBList.forEach((function(t,a){e.databaseList[1].options.push({label:t.name,value:a+1,type:t.type,code:t.code})})),e.getStepHeader().then((function(t){e.$route.query.stepId&&e.process.find((function(t){return t.id==e.$route.query.stepId}))?e.backTo(e.process.find((function(t){return t.id==e.$route.query.stepId}))):t.length>0&&e.backTo(e.process[e.process.length-1])}))}))}};t.default=s},bf69:function(e,t,a){var r=a("2fc1");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("21d92b5c",r,!0,{sourceMap:!1,shadowMode:!1})},ec97:function(e,t,a){"use strict";a.r(t),a("7514"),a("6762"),a("2fdb");var r={props:["selectParam","databaseList"],data:function(){return{storey:["au_ods","au_std","au_dwd","au_dwm","au_dws","au_app"],numSort:{au_ods:1,au_std:2,au_dwd:3,au_dwm:4,au_dws:5,au_app:6}}},components:{},computed:{comSourceIsDisabled:function(){return function(e){var t=this;return""!==this.selectParam.targetDatabase&&"au_ods"!==this.selectParam.targetDatabase&&!this.storey.includes(e.code)||!!(""!==this.selectParam.targetDatabase&&this.storey.includes(this.selectParam.targetDatabase)&&"1"===e.type&&e.value>=this.databaseList[1].options.find((function(e){return e.code===t.selectParam.targetDatabase})).value)||!e&&void 0}},comTargetIsDisabled:function(){return function(e){var t=this,a=this.selectParam.sourceRows.filter((function(e){return""!==e.sourceDatabase&&"0"!==e.type})),r=a.map((function(e){return t.numSort[e.sourceDatabase]}));if("1"!==e.type)return!0;if(""!==this.selectParam.sourceRows[0].sourceDatabase&&!this.storey.includes(this.selectParam.sourceRows[0].sourceDatabase)&&"au_ods"!==e.code)return!0;if(0===a.length)return!1;var n=r.reduce((function(e,t){return e>t?e:t}));return"0"!==e.type&&e.value<=n}}},mounted:function(){},methods:{sourceChange:function(e){this.$emit("sourceChange",e)},targetChange:function(){this.$emit("targetChange")},selectTable:function(e,t){this.$emit("select",e,t)}}},n=(a("79ed"),a("2877")),o=Object(n.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search"},[e._l(e.selectParam.sourceRows,(function(a,r){return t("div",{key:r,staticClass:"row"},[e._m(0,!0),t("div",[t("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:function(t){return e.sourceChange(a)}},model:{value:a.sourceDatabase,callback:function(t){e.$set(a,"sourceDatabase",t)},expression:"p.sourceDatabase"}},e._l(e.databaseList,(function(a){return t("el-option-group",{key:a.label,attrs:{label:a.label}},e._l(a.options,(function(a){return t("el-option",{key:a.code,attrs:{label:a.label,value:a.code,disabled:e.comSourceIsDisabled(a)}})})),1)})),1)],1),e._v("\n          \n        "),t("div",{staticStyle:{position:"relative"}},[t("div",{staticClass:"click_modal",on:{click:function(t){return e.selectTable("source",r)}}}),t("el-select",{attrs:{multiple:"",placeholder:"点击选择原表",disabled:""},model:{value:a.alreadySelectSourceTableValue,callback:function(t){e.$set(a,"alreadySelectSourceTableValue",t)},expression:"p.alreadySelectSourceTableValue"}},e._l(a.alreadySelectSourceTable,(function(e){return t("el-option",{key:e.id,attrs:{label:e.tableName,value:e.id}})})),1)],1)])})),t("div",{staticClass:"row"},[e._m(1),t("div",[t("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.targetChange},model:{value:e.selectParam.targetDatabase,callback:function(t){e.$set(e.selectParam,"targetDatabase",t)},expression:"selectParam.targetDatabase"}},e._l(e.databaseList,(function(a){return t("el-option-group",{key:a.label,attrs:{label:a.label}},e._l(a.options,(function(a){return t("el-option",{key:a.code,attrs:{label:a.label,value:a.code,disabled:e.comTargetIsDisabled(a)}})})),1)})),1)],1),e._v("\n          \n        "),e.selectParam.autoCreate?e._e():t("div",{staticStyle:{position:"relative"}},[t("div",{staticClass:"click_modal",on:{click:function(t){return e.selectTable("target")}}}),t("el-select",{attrs:{multiple:"",placeholder:"点击选择目标表",disabled:""},model:{value:e.selectParam.alreadySelectTargetTableValue,callback:function(t){e.$set(e.selectParam,"alreadySelectTargetTableValue",t)},expression:"selectParam.alreadySelectTargetTableValue"}},e._l(e.selectParam.alreadySelectTargetTable,(function(e){return t("el-option",{key:e.id,attrs:{label:e.tableName,value:e.id}})})),1)],1)])],2)}),[function(){var e=this._self._c;return e("div",{staticClass:"label"},[e("span",{staticClass:"require"},[this._v("*")]),this._v("源数据层")])},function(){var e=this._self._c;return e("div",{staticClass:"label"},[e("span",{staticClass:"require"},[this._v("*")]),this._v("目标数据层")])}],!1,null,"c3d5d4fa",null);t.default=o.exports},eecc:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".get-edit-item[data-v-5fdb62f8]{padding-top:20px;margin:0 50px}.get-edit-item li[data-v-5fdb62f8]{margin-top:20px;display:-webkit-box;display:-ms-flexbox;display:flex}.get-edit-item li .get-edit-type[data-v-5fdb62f8]{height:40px;line-height:40px}.get-edit-item li .get-edit-title[data-v-5fdb62f8]{width:80px;color:#3a405b;height:40px;line-height:40px}.get-edit-item li .el-tree[data-v-5fdb62f8]{width:100%;border:1px solid #dcdfe6;padding:24px}.row[data-v-5fdb62f8]{padding:0 60px!important}",""])},f39a:function(e,t,a){"use strict";a("7a60")}}]);