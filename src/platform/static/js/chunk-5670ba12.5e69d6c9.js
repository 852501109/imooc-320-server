(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5670ba12","chunk-e79f71b6"],{"23d4":function(e,t,a){"use strict";a("36f3")},"36f3":function(e,t,a){var r=a("f10a");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("47fc852c",r,!0,{sourceMap:!1,shadowMode:!1})},"558fd":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".get-edit-item[data-v-ba398ca6]{padding-top:20px;margin:0 50px}.get-edit-item li[data-v-ba398ca6]{margin-top:20px;display:-webkit-box;display:-ms-flexbox;display:flex}.get-edit-item li .get-edit-type[data-v-ba398ca6]{height:40px;line-height:40px}.get-edit-item li .get-edit-title[data-v-ba398ca6]{width:80px;color:#3a405b;height:40px;line-height:40px}.get-edit-item li .el-tree[data-v-ba398ca6]{width:100%;border:1px solid #dcdfe6;padding:24px}.row[data-v-ba398ca6]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:10px}.row>div[data-v-ba398ca6]{margin-right:10px}[data-v-ba398ca6] .el-table .cell{text-align:center}[data-v-ba398ca6] .el-radio__label{display:none}",""])},"5d6f":function(e,t,a){"use strict";a("9309")},"68ad8":function(e,t,a){"use strict";a.r(t),a("7f7f"),a("8e6e"),a("ac6a"),a("456d"),a("6b54");var r=a("ade3"),o=a("2f62"),i=a("8a4d");function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={data:function(){return{placeholder:"1.引用原子指标后，可输入$进行引用； 2.输入ctrl+d可格式化",indicatorsAsync:!1,dialogSync:!1,sqlLoad:"selet * from table",indicatorInput:"",radio:"1",value:"",rowId:this.$route.query.id,multipleSelection:[],filter:"view"!=this.$route.query.filter,statuslist:[{name:"关闭",id:"0"},{name:"开启",id:"1"}],currentRadio:"",tableData:{row:[{cn:"test1",en:"ggg"},{cn:"test2",en:"ggg"}],total:2},pages:{page:1,rows:10},startOptions:[],endOptions:[],param:{id:"",slot1:"",slot2:"",slot3:"",slot4:"",slot10:"",slot11:""},rules:{slot1:[{required:!0,message:"请输入",trigger:"blur"}],slot2:[{required:!0,validator:this.checkDimName,trigger:"change"}],slot4:[{required:!0,trigger:"change"}]}}},computed:{},methods:l(l({},Object(o.b)("moduleManage",["QUERY_STAT_PERIOD_DETAIL","UPDATE_STAT_PERIOD","INSERT_STAT_PERIOD","GET_STAT_PERIOD_DATA_SOURCE_LIST"])),{},{sqlYl:function(){this.dialogSync=!0},checkDimName:function(e,t,a){return t?/^[a-zA-Z].*$/.test(t)?void a():a(new Error("必须以英文开头")):a(new Error("英文名不可为空"))},handleSelectionChange:function(e){this.multipleSelection=e},changeTextarea:function(e){this.$set(this.param,"slot4",e)},radioCancelSelect:function(e,t){var a=this;"INPUT"!==e.target.tagName&&(this.currentRadio===t.cn?this.$nextTick((function(){a.currentRadio=""})):this.$nextTick((function(){a.currentRadio=t.cn})))},indicatorsSubmit:function(){this.indicatorsAsync=!1;var e=this.$refs.sqleditor,t=this.multipleSelection.map((function(e){return"${"+e.cn+"}"}));e.editor.setValue(t.join(""))},handleCurrentChange:function(e){this.pages.page=e},handleSizeChange:function(e){this.pages.page=1,this.pages.rows=e},indicatorsClose:function(){this.indicatorsAsync=!1},validateExpress:function(e,t,a){this.param.beginExpressFuc?this.param.beginExpress?this.param.endExpressFuc?this.param.endExpress?a():a(new Error("请选择结束时间函数表达式")):a(new Error("请选择结束时间函数表达式函数")):a(new Error("请输入开始时间函数表达式")):a(new Error("请选择开始时间函数表达式函数"))},subBtn:function(){var e=this,t=this;this.$refs.subForm.validate((function(a){if(!a)return!1;if(e.$store.commit("SHOW_LOADING",!0),e.rowId){var r=e.param;e.UPDATE_STAT_PERIOD(r).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){t.$router.go(-1)}}})}))}else{var o=e.param;e.INSERT_STAT_PERIOD(o).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"添加成功",methods:{okEvent:function(){t.$router.go(-1)}}})}))}}))},getDataSourceList:function(){var e=this;this.GET_STAT_PERIOD_DATA_SOURCE_LIST().then((function(t){e.startOptions=t.result.startExpList,e.endOptions=t.result.endExpList}))}}),mounted:function(){},components:{SqlEditor:i.default},created:function(){var e=this;this.getDataSourceList(),this.rowId&&this.QUERY_STAT_PERIOD_DETAIL({id:this.rowId}).then((function(t){e.param.id=t.id,e.param.cycleNameCn=t.cycleNameCn,e.param.cycleNameEn=t.cycleNameEn,e.param.cycleDesc=t.cycleDesc,e.param.beginParameter="1",e.param.beginExpress=t.beginExpress.toString(),e.param.beginExpressFuc=t.beginExpressFuc,e.param.endParameter="1",e.param.endExpress=t.endExpress.toString(),e.param.endExpressFuc=t.endExpressFuc,e.param.remark=t.remark}))}},c=(a("5d6f"),a("2877")),d=Object(c.a)(s,(function(){var e=this,t=e._self._c;return t("audaque-detail-form-page",{attrs:{title:e.filter?e.rowId?"衍生指标编辑":"衍生指标新增":"衍生指标查看","opt-type":e.$route.query.filter}},[[t("el-form",{ref:"subForm",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules,disabled:!e.filter}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"名称",prop:"slot1",rules:e.rules.slot1}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入","show-word-limit":""},model:{value:e.param.slot1,callback:function(t){e.$set(e.param,"slot1","string"==typeof t?t.trim():t)},expression:"param.slot1"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"英文名称",prop:"slot2",rules:e.rules.slot2}},[t("el-input",{attrs:{disabled:!e.filter,placeholder:"请输入英文名称","show-word-limit":""},model:{value:e.param.slot2,callback:function(t){e.$set(e.param,"slot2","string"==typeof t?t.trim():t)},expression:"param.slot2"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"所属部门",prop:"slot10",rules:e.rules.slot10}},[t("el-select",{staticClass:"autoSize f14",attrs:{placeholder:"请选择所属部门",maxlength:"50",clearable:""},model:{value:e.param.slot10,callback:function(t){e.$set(e.param,"slot10",t)},expression:"param.slot10"}},e._l(e.frequencyUnitList,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"来源依据",prop:"slot11",rules:e.rules.slot11}},[t("el-input",{attrs:{placeholder:"请输入来源依据","show-word-limit":""},model:{value:e.param.slot11,callback:function(t){e.$set(e.param,"slot11","string"==typeof t?t.trim():t)},expression:"param.slot11"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"描述",prop:"slot3",rules:e.rules.slot3}},[t("el-input",{attrs:{disabled:!e.filter,type:"textarea",placeholder:"请输入","show-word-limit":""},model:{value:e.param.slot3,callback:function(t){e.$set(e.param,"slot3","string"==typeof t?t.trim():t)},expression:"param.slot3"}})],1),t("el-form-item",{attrs:{label:"计算配置"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.indicatorsAsync=!0}}},[e._v("引用原子指标")])],1),t("el-form-item",{attrs:{label:"计算逻辑",prop:"slot4",rules:e.rules.slot4}},[t("SqlEditor",{ref:"sqleditor",attrs:{value:e.param.slot4,placeholder:e.placeholder},on:{changeTextarea:function(t){return e.changeTextarea(t)}}})],1)],1)],1)],1),t("el-dialog",{attrs:{title:"引用原子指标",visible:e.indicatorsAsync,width:"800px","before-close":e.indicatorsClose},on:{"update:visible":function(t){e.indicatorsAsync=t}}},[t("div",[t("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.indicatorInput,callback:function(t){e.indicatorInput=t},expression:"indicatorInput"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.row},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"cn",label:"原子指标中文名","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"en",label:"原子指标英文名","show-overflow-tooltip":""}})],1),t("adq-pagination",{attrs:{"current-page":e.pages.page,total:e.tableData.total,"page-size":e.pages.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.indicatorsAsync=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.indicatorsSubmit}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{title:"SQL预览",visible:e.dialogSync,width:"600px"},on:{"update:visible":function(t){e.dialogSync=t}}},[e.dialogSync?t("SqlEditor",{ref:"sqlLoad",attrs:{value:e.sqlLoad,readOnly:!0}}):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogSync=!1}}},[e._v("关 闭")])],1)],1)],t("template",{slot:"bottom"},[t("div",{staticClass:"footer"},[t("el-button",{on:{click:function(t){return e.$router.push("/yszbList")}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.sqlYl}},[e._v("SQL预览")]),e.filter?t("el-button",{attrs:{type:"primary"},on:{click:e.subBtn}},[e._v("提 交")]):e._e()],1)])],2)}),[],!1,null,"ba398ca6",null);t.default=d.exports},"8a4d":function(e,t,a){"use strict";a.r(t),a("b866"),a("a7be"),a("f6b6"),a("d7d5");var r=a("db05"),o=a.n(r),i=a("56b3");a("8c33"),a("31c5"),a("ffda"),a("9b74"),a("991c");var n={data:function(){return{editor:null}},props:{value:{type:String,default:""},sqlStyle:{type:String,default:"default"},readOnly:{type:[Boolean,String]},placeholder:{type:String,default:""}},watch:{newVal:function(e,t){this.editor&&this.$emit("changeTextarea",this.editor.getValue())}},computed:{newVal:function(){if(this.editor)return this.editor.getValue()},isView:function(){return"view"===this.$route.query.filter}},mounted:function(){this.initCodeMirror()},methods:{formaterSql:function(){this.editor.setValue(o.a.format(this.editor.getValue()))},initCodeMirror:function(){var e=this,t=this;this.editor=i.fromTextArea(this.$refs.mycode,{value:this.value,mode:"text/x-mariadb",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,cursorHeight:1,lineWrapping:!0,readOnly:this.readOnly,theme:"idea",autofocus:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},gutters:["myGutter","CodeMirror-linenumbers"],gutterWidth:40}),this.editor.on("inputRead",(function(){e.editor.showHint()})),this.editor.setOption("extraKeys",{"Ctrl-D":function(e){t.formaterSql()}})},setVal:function(){this.editor&&(""===this.value?this.editor.setValue(""):this.editor.setValue(this.value))}}},l=(a("23d4"),a("2877")),s=Object(l.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticStyle:{border:"1px solid #409eff"}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"mycode",staticClass:"codesql",attrs:{placeholder:e.placeholder},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}})])}),[],!1,null,"5f9c20b8",null);t.default=s.exports},9309:function(e,t,a){var r=a("558fd");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("dd8f1dd0",r,!0,{sourceMap:!1,shadowMode:!1})},b866:function(e,t,a){var r=a("d131");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),(0,a("499e").default)("3875f97e",r,!0,{sourceMap:!1,shadowMode:!1})},d131:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".cm-s-idea span.cm-meta{color:olive}.cm-s-idea span.cm-number{color:#00f}.cm-s-idea span.cm-keyword{line-height:1em;font-weight:700;color:navy}.cm-s-idea span.cm-atom{font-weight:700;color:navy}.cm-s-idea span.cm-def,.cm-s-idea span.cm-operator,.cm-s-idea span.cm-property,.cm-s-idea span.cm-type,.cm-s-idea span.cm-variable,.cm-s-idea span.cm-variable-2,.cm-s-idea span.cm-variable-3{color:#000}.cm-s-idea span.cm-comment{color:grey}.cm-s-idea span.cm-string,.cm-s-idea span.cm-string-2{color:green}.cm-s-idea span.cm-qualifier{color:#555}.cm-s-idea span.cm-error{color:red}.cm-s-idea span.cm-attribute{color:#00f}.cm-s-idea span.cm-tag{color:navy}.cm-s-idea span.cm-link{color:#00f}.cm-s-idea .CodeMirror-activeline-background{background:#fffae3}.cm-s-idea span.cm-builtin{color:#30a}.cm-s-idea span.cm-bracket{color:#cc7}.cm-s-idea{font-family:Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif}.cm-s-idea .CodeMirror-matchingbracket{outline:1px solid grey;color:#000!important}.CodeMirror-hints.idea{font-family:Menlo,Monaco,Consolas,Courier New,monospace;color:#616569;background-color:#ebf3fd!important}.CodeMirror-hints.idea .CodeMirror-hint-active{background-color:#a2b8c9!important;color:#5c6065!important}",""])},d7d5:function(e,t,a){!function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function a(e){t(e);var a=e.state.placeholder=document.createElement("pre");a.style.cssText="height: 0; overflow: visible",a.style.direction=e.getOption("direction"),a.className="CodeMirror-placeholder CodeMirror-line-like";var r=e.getOption("placeholder");"string"==typeof r&&(r=document.createTextNode(r)),a.appendChild(r),e.display.lineSpace.insertBefore(a,e.display.lineSpace.firstChild)}function r(e){i(e)&&a(e)}function o(e){var r=e.getWrapperElement(),o=i(e);r.className=r.className.replace(" CodeMirror-empty","")+(o?" CodeMirror-empty":""),o?a(e):t(e)}function i(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",(function(i,n,l){var s=l&&l!=e.Init;if(n&&!s)i.on("blur",r),i.on("change",o),i.on("swapDoc",o),e.on(i.getInputField(),"compositionupdate",i.state.placeholderCompose=function(){!function(e){setTimeout((function(){var r=!1;if(1==e.lineCount()){var o=e.getInputField();r="TEXTAREA"==o.nodeName?!e.getLine(0).length:!/[^\u200b]/.test(o.querySelector(".CodeMirror-line").textContent)}r?a(e):t(e)}),20)}(i)}),o(i);else if(!n&&s){i.off("blur",r),i.off("change",o),i.off("swapDoc",o),e.off(i.getInputField(),"compositionupdate",i.state.placeholderCompose),t(i);var c=i.getWrapperElement();c.className=c.className.replace(" CodeMirror-empty","")}n&&!i.hasFocus()&&r(i)}))}(a("56b3"))},f10a:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,"[data-v-5f9c20b8] .CodeMirror{color:#000;direction:ltr;line-height:22px;border:1px solid #e7e7e7}.CodeMirror-hints[data-v-5f9c20b8]{z-index:9999!important}[data-v-5f9c20b8] .CodeMirror pre.CodeMirror-placeholder{color:#929292;font-size:15px}",""])}}]);