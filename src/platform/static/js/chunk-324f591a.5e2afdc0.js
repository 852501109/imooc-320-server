(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-324f591a","chunk-5ea1dac2","chunk-169d1ed6","chunk-2d0d3aa7","chunk-2d0da5e1"],{"0806":function(e,t,a){"use strict";a("4582")},"1d85":function(e,t,a){"use strict";a("d307a")},4582:function(e,t,a){var o=a("e63b");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,a("499e").default)("57623f8d",o,!0,{sourceMap:!1,shadowMode:!1})},"5e78":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAYCAYAAAD+vg1LAAABhklEQVRIie3Vv0tVcRjH8ZcpKZRQ0SaCLeEtKCqywUCXbDKEyMUh+w901DEaXFoLgkKnEF2F8MfQ4OKijU5BEEkUFxtCMku+8lw42L3ndq6BSx94eM73+z3P+/vrOc9p6h5/r4668QR30YZ3mMJ8XtCJOtBrWMN9nEYLbmAOk0cBT6Mdi7gdthxjj1FqBHwZV/AF97AaNoivaMZwreC0tUfoqzLWET6tePPQWHv4EVyoEruSLm83JviX2mmJS+jFdXSijA8FJzkZ572NdSxk0y1d1EPMYLQguAsJ9Bb9/iIrGlY98NnMOykLzsRz6juXF5gHvhWpNhXtV9jCRTzFZ9xsBFyK8Z5oX0UrLsUX2Ry5Xhh8JP0HHy/4V/jd8Hvhf4Zl+/5QXvFZwRKeR/sZhqJ0ngr4cq3gauBK30cMZPpfhiXNhtXkZI+iHL7mXyFHlZhP1WZ6g7EonxOxoso55+l85rNPv7ADZctmU8Cz2y+ijagvPw4fxW88wAt8K0D8jte4U4HCPsiBR1Kg9200AAAAAElFTkSuQmCC"},"63bc":function(e,t,a){var o=a("ec51");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,a("499e").default)("5abc7208",o,!0,{sourceMap:!1,shadowMode:!1})},"6aff":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAWCAYAAADafVyIAAABTklEQVRIie3VMUtcQRQF4G9ltTAJprC0DGZJtFMCKQyC6YJa5A/YBQIBG/0HFjbpjAiBxE4FUSwlYClECysjCluYyioRjYUblYFZGB5qdvdtCsEDr7gz951z584ZbqE0XlYDVjCSpI3hSy0/ttSSlAf3Av9EsQkcG5n4DU6qQTMEXmXi4k3BQ3Qm8R8c5VVP7+Atysk3l5c8K/BfcCdc9ANfsYW/OG22QA+G8BqP0I0F/NKEFnVgHcuRuB2TOKjaN+8J5qO1n+JnXAucU1jD80YFCujFMJ4l5AGVeIoBfGi0RaHqF9jD7jX7l1gNOY0KXMRKW2/JCXuVdKK1xUuq4jyx3IMM2Rm6sI+X2MyQh9bvYLEYx2G9CMJhbH7GEkaxHTke4xOeYCYIpLO2HoSLfY9ZfI8V/0YfDnGMj3lsOhHf0TtMYzA+tGDRbyih/wr1ODuh5MjTLQAAAABJRU5ErkJggg=="},7524:function(e,t,a){"use strict";a.r(t),a("7f7f"),a("8e6e"),a("456d"),a("7514"),a("5df3"),a("4f7f"),a("a481"),a("ac6a");var o=a("ade3"),l=a("2f62");function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){Object(o.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var r={props:{title:{type:String,default:"表详情"}},data:function(){return{dis:void 0,list:[],disabledNum:0,editTable:{columnList:[]},show:!1}},computed:n({},Object(l.d)("baseLayer",["dataTypeOptions"])),created:function(){this.GETDATATYPEOPTIONS_LIST()},methods:n(n({},Object(l.b)("baseLayer",["GETDATATYPEOPTIONS_LIST","GETCOLUMNBYTABLEID","MODIFYCOLUMN"])),{},{init:function(e,t){var a=this;this.dis=t,this.disabledNum=t,this.editTable.columnList=[],this.GETCOLUMNBYTABLEID({tableId:e}).then((function(e){e&&(a.title=e[0]&&e[0].tableName?"表详情("+e[0].tableName+")":"表详情",e.forEach((function(e){a.editTable.columnList.push(e)})),e[0]&&e[0].dos.length>0&&1==e[0].dos[0].status&&(a.disabledNum=1),a.show=!0)}))},onChange:function(e,t){1==t&&(this.editTable.columnList[e].nullAble=0)},handleInput:function(e,t){e[t]=e[t].replace(/\D/g,"")},checkDuplicates:function(e,t){for(var a=new Set,o=0;o<e.length;o++){if(a.has(e[o][t]))return!0;a.add(e[o][t])}return!1},sure:function(){var e=this,t=this,a=this.editTable.columnList;a.find((function(e){return""===e.columnName}))?this.$AudaqueToast.warn({template:"列名不可为空"}):this.checkDuplicates(a,"columnName")?this.$AudaqueToast.warn({template:"列名不能重复"}):(this.$store.commit("SHOW_LOADING",!0),this.MODIFYCOLUMN(this.editTable).then((function(a){0==a.code&&e.$AudaqueToast.tip({template:"修改成功,若有未上线任务引用，请前往修改任务！",methods:{okEvent:function(){t.show=!1}}})})))}})},s=(a("0806"),a("2877")),c=Object(s.a)(r,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("el-dialog",{staticStyle:{width:"100%"},attrs:{title:e.title+(1!=e.disabledNum||e.dis?"":" 有上线任务引用，不允许修改"),visible:e.show,"append-to-body":""},on:{"update:visible":function(t){e.show=t}}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.editTable.columnList,height:"380"}},[t("el-table-column",{attrs:{type:"index",width:"47",label:"序号"}}),t("el-table-column",{attrs:{prop:"columnName",label:"列名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:1===e.disabledNum,maxlength:"255",placeholder:"请输入"},model:{value:a.row.columnName,callback:function(t){e.$set(a.row,"columnName",t)},expression:"scope.row.columnName"}})]}}])}),t("el-table-column",{attrs:{prop:"columnComment",label:"注释"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:1===e.disabledNum,maxlength:"255",placeholder:"请输入"},model:{value:a.row.columnComment,callback:function(t){e.$set(a.row,"columnComment",t)},expression:"scope.row.columnComment"}})]}}])}),t("el-table-column",{attrs:{prop:"columnType",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{placeholder:"请选择",disabled:1===e.disabledNum},model:{value:a.row.columnType,callback:function(t){e.$set(a.row,"columnType",t)},expression:"scope.row.columnType"}},e._l(e.dataTypeOptions,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)]}}])}),t("el-table-column",{attrs:{prop:"nullAble",label:"是否可为空"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{placeholder:"请选择",disabled:1===e.disabledNum||1==a.row.primaryKey},model:{value:a.row.nullAble,callback:function(t){e.$set(a.row,"nullAble",t)},expression:"scope.row.nullAble"}},[t("el-option",{attrs:{label:"可为空",value:1}}),t("el-option",{attrs:{label:"不可为空",value:0}})],1)]}}])}),t("el-table-column",{attrs:{prop:"primaryKey",label:"是否主键"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{placeholder:"请选择",disabled:1===e.disabledNum},on:{change:function(t){return e.onChange(a.$index,a.row.primaryKey)}},model:{value:a.row.primaryKey,callback:function(t){e.$set(a.row,"primaryKey",t)},expression:"scope.row.primaryKey"}},[t("el-option",{attrs:{label:"主键",value:1}}),t("el-option",{attrs:{label:"非主键",value:0}})],1)]}}])}),t("el-table-column",{attrs:{prop:"length",label:"长度"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:1===e.disabledNum,maxlength:"10","show-word-limit":"",placeholder:"请输入"},on:{input:function(t){return e.handleInput(a.row,"length")}},model:{value:a.row.length,callback:function(t){e.$set(a.row,"length",t)},expression:"scope.row.length"}})]}}])}),t("el-table-column",{attrs:{prop:"scale",label:"精度"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:1===e.disabledNum,maxlength:"5",placeholder:"请输入","show-word-limit":""},on:{input:function(t){return e.handleInput(a.row,"scale")}},model:{value:a.row.scale,callback:function(t){e.$set(a.row,"scale",t)},expression:"scope.row.scale"}})]}}])})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.show=!1}}},[e._v("取 消")]),1!==e.disabledNum?t("el-button",{attrs:{type:"primary"},on:{click:e.sure}},[e._v("确 定")]):e._e()],1)],1)],1)}),[],!1,null,"3b0e6f1b",null);t.default=c.exports},"952a":function(e,t,a){"use strict";a("63bc")},"9bf4":function(e,t,a){"use strict";a.r(t),a("8e6e"),a("ac6a"),a("456d"),a("96cf");var o=a("1da1"),l=(a("a481"),a("7514"),a("ade3")),i=(a("c5f6"),a("2f62"));function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s,c,u={props:{rowId:{type:Number,default:0},row:{type:Object,dafault:function(){}}},data:function(){return{value:"",filter:"view"!=this.$route.query.filter,layerSelectShow:!0,layerList:[],desLayerList:[],datas:[],defaultProps:{label:"name",children:"children",multipleSelection:[],multipleSelection1:[]},treeExpandData:[],deptlist:[],param:{tableName:"",layerCode:"",targetLevelCode:[]},rules:{targetLevelCode:[{required:!0,message:"请选择",trigger:"blur"}],tableName:[{required:!0,message:"请输入",trigger:"change"}]}}},computed:{},methods:r(r(r(r({},Object(i.b)("collectionLayer",["COLLECTIONLAYERLIST","DELETECOLLECTIONLAYERLIST","DELETECOLLECTIONLAYERLIST","MODIFYCOLLECTIONLAYERLIST","GET_ALLMODELLAYER","GET_MODELALLLEVELS","COPY_TABLE_SUBMIT","GET_TREE"])),Object(i.b)("resourcecatalog",["RESOURCECATALOGLIST","RESOURCECATALOGTREE","GETDEPTLIST","GETCOLUMNBYTABLEID","GETDATASOURLIST","DETSYSTEMDETAILBYID","MODIFYMODELSYSTEMINFO","ADDMODELSYSTEMINFO","DELETEMODELSYSTEMINFO","GETTABLEBYDATASOURCEID","IMPROTDATATABLEBYSYSTEMID","MODIFYUPDATEFREQUENCY","GETTABLEDATABYTABLEID","GETSYSTEMBYDATASOURCEID","DIRECTORYMIGRATION"])),Object(i.b)(["_AJAX"])),{},{removePrefix:function(e){var t=this.layerList.find((function(e){return"au_ods"==e.levelCode}));return 0===e.indexOf(t.tablePrefix)?e.replace(t.tablePrefix,""):""},getTree:function(){var e=this;this.GET_TREE({layerCode:this.param.layerCode}).then((function(t){e.treeExpandData=t}))},cancel:function(){this.$emit("close")},subButton:function(){var e=this;this.$refs.collectionLayer.validate((function(t){if(t){e.$store.commit("SHOW_LOADING",!0);var a={sourceTableId:Number(e.rowId),targetLevelCode:e.param.layerCode,newTableName:e.param.tablePrefix+e.param.tableName,categoryId:Number(e.param.targetLevelCode[e.param.targetLevelCode.length-1])};e.COPY_TABLE_SUBMIT(a).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"复制成功",methods:{okEvent:function(){e.$emit("close")}}})}))}}))},getdeptlist:function(){var e=this;return new Promise((function(t){e.GETDEPTLIST().then((function(a){e.deptlist=a,t(a)}))}))},handleNodeClick:(c=Object(o.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getdeptlist();case 2:a=this.deptlist.length,this.param.holdId=t.holdId,this.holdId=t.holdId,this.param.id=t.id,this.threeid=t.id,this.isedits=!0,t.id>a?this.isdataiprot=!0:this.isdataiprot=!1,this.multipleSelection=[],this.multipleSelection1=[],this.initData();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)}),initData:function(){var e=this.param;this.RESOURCECATALOGLIST(e)},getModelAllLevels:(s=Object(o.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GET_MODELALLLEVELS().then((function(e){t.layerList=e,t.desLayerList=e.filter((function(e){return"au_ods"!=e.levelCode&&"au_std"!=e.levelCode})),t.param.tableName=t.removePrefix(t.row.tableName)}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)}),handleLayerCodeChange:function(e){var t=this;if(!e)return this.treeExpandData=[],void(this.param.targetLevelCode=[]);this.getTree();var a=this.layerList.find((function(e){return e.levelCode===t.param.layerCode}));this.param.tablePrefix=a?a.tablePrefix:""}}),mounted:function(){this.getModelAllLevels()}},d=(a("952a"),a("2877")),p=Object(d.a)(u,(function(){var e=this,t=e._self._c;return t("el-form",{ref:"collectionLayer",staticClass:"form-item",attrs:{model:e.param,"label-width":"120px",rules:e.rules,disabled:!e.filter}},[t("el-form-item",{attrs:{label:"原表名："}},[t("div",[e._v(e._s(e.row.tableName))])]),t("el-form-item",{attrs:{label:"复制表到：",prop:"targetLevelCode",rules:e.rules.targetLevelCode}},[t("div",{staticClass:"row"},[t("div",[t("el-select",{attrs:{disabled:!e.layerSelectShow,placeholder:"请选择要复制到哪一层",clearable:""},on:{change:e.handleLayerCodeChange},model:{value:e.param.layerCode,callback:function(t){e.$set(e.param,"layerCode",t)},expression:"param.layerCode"}},e._l(e.desLayerList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.levelName,value:e.levelCode}})})),1)],1),t("div",[t("el-cascader",{attrs:{options:e.treeExpandData,clearable:"",placeholder:"请选择类别",props:{value:"id",label:"name"}},model:{value:e.param.targetLevelCode,callback:function(t){e.$set(e.param,"targetLevelCode",t)},expression:"param.targetLevelCode"}})],1)])]),t("el-form-item",{attrs:{label:"目标表名：",prop:"tableName",rules:e.rules.tableName}},[t("el-input",{attrs:{placeholder:"请输入表名",maxlength:"200","show-word-limit":""},model:{value:e.param.tableName,callback:function(t){e.$set(e.param,"tableName","string"==typeof t?t.trim():t)},expression:"param.tableName"}},[t("template",{slot:"prepend"},[e._v(e._s(e.param.tablePrefix))])],2)],1),t("div",{staticStyle:{width:"100%",display:"flex","justify-content":"flex-end"}},[t("el-button",{on:{click:e.cancel}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.subButton}},[e._v("确认")])],1)],1)}),[],!1,null,"6e7e87bb",null);t.default=p.exports},ba9f:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".table-link[data-v-2cf3fbe7]{color:#0c8ec1;text-decoration:underline;cursor:pointer}.customtable[data-v-2cf3fbe7] td,.customtable[data-v-2cf3fbe7] th{text-align:center!important}",""])},d307a:function(e,t,a){var o=a("ba9f");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),(0,a("499e").default)("69d14100",o,!0,{sourceMap:!1,shadowMode:!1})},e63b:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,"[data-v-3b0e6f1b] .el-table .el-table__cell{padding:1px 0!important}",""])},ec51:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".row[data-v-6e7e87bb]{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.row>div[data-v-6e7e87bb]{width:49.5%}.row>div[data-v-6e7e87bb]:first-child{margin-right:1%}.row[data-v-6e7e87bb] .el-cascader{width:100%}",""])},f061:function(e,t,a){"use strict";a.r(t),a("7f7f"),a("8e6e"),a("ac6a"),a("456d"),a("c5f6"),a("7514"),a("96cf");var o=a("1da1"),l=a("ade3"),i=a("2f62"),n=a("7524"),r=a("9bf4");function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u,d,p={data:function(){return{datas:[],isSearch:!1,getHeight:!1,total:1,showEditComment:!1,editComment:null,defaultProps:{label:"name",children:"children"},deptList:[],showLookDialog:!1,multipleSelection:[],treeExpandData:[],holdId:"",isedits:!1,showCopyDialog:!1,threeid:"",param:{page:1,rows:10,treeId:"",holdId:"",deptId:"",tableName:"",tableComment:""},search_dataRange:"",showDialog:!1,editData:[],notEditable:!0,tableId:null,tableFieldInfo:[],tableData:null,iscreate:!1,dialogFormVisible:!1,layerList:[],copyTreeData:[],form:{layerCode:"",categoryId:"",tableName:"",ids:"",prefix:"",tablePrefix:"",targetLevelCode:[]},formLabelWidth:"120px",rules:{rename:[{required:!0,message:"请输入重命名",trigger:"blur"}],levelcode:[{required:!0,message:"请选择数仓的层级",trigger:"change"}]}}},components:{tableFields:n.default,copyEdit:r.default},computed:c({},Object(i.d)("collectionLayer",["collectionLayerList","GET_TREE"])),methods:c(c(c(c(c({},Object(i.b)("collectionLayer",["COLLECTIONLAYERLIST","DELETECOLLECTIONLAYER","GET_TABLE_COLUMN_DATA_BY_TABLEID","MODIFY_TABLE_COMMENT","MODIFY_META_DATA_COLUMN_INFO","GET_TABLE_DATA_BY_TABLE_ID","CREATE_TABLE","DROP_TABLE_BY_TABLE_ID","DROP_TABLE_BY_TABLE_ID_LIST","GET_MODELALLLEVELS"])),Object(i.b)("datasourceInfo",["GETSELECTLISTS"])),Object(i.b)("resourcecatalog",["RESOURCECATALOGLIST","RESOURCECATALOGTREE","GETDEPTLIST","GETCOLUMNBYTABLEID","GETDATASOURLIST","DETSYSTEMDETAILBYID","MODIFYMODELSYSTEMINFO","ADDMODELSYSTEMINFO","DELETEMODELSYSTEMINFO","GETTABLEBYDATASOURCEID","IMPROTDATATABLEBYSYSTEMID","MODIFYUPDATEFREQUENCY","GETTABLEDATABYTABLEID","GETSYSTEMBYDATASOURCEID","DIRECTORYMIGRATION"])),Object(i.b)(["_AJAX"])),{},{handleSelectionChange:function(e){this.multipleSelection=e},rowChange:function(e){this.$refs.mainTableRef.toggleRowSelection(e)},renderTreeItem:function(e,t){t.node;var a=t.data,o=(t.store,"iconfont iconjiankong group");return 0==a.holdId&&(o="iconfont icondrxx95 root"),e("span",{class:o,style:""},[" ",a.name])},getTree:function(){var e=this;this.RESOURCECATALOGTREE().then((function(t){e.datas=t,e.treeExpandData.push("1")}))},createForm:function(){var e=this;if(0!==this.multipleSelection.length)if(this.multipleSelection.map((function(t){1==t.tableIscreate&&(e.iscreate=!0)})),this.iscreate)this.$message.error("选择的列表中有已创建的表，请重新选择"),this.iscreate=!1;else{var t=this;this.$AudaqueToast.warn({template:"确认是否创建表？",methods:{okEvent:function(){t.$store.commit("SHOW_LOADING",!0),t.CREATE_TABLE({ids:t.multipleSelection.map((function(e){return e.id}))}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"创建成功",methods:{okEvent:function(){t.initData()}}})})).catch((function(e){t.initData()}))}}})}else this.$AudaqueToast.warn({template:"请选择数据"})},treeOperaSystem:(d=Object(o.a)(regeneratorRuntime.mark((function e(t){var a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("add"!=t){e.next=8;break}this.titletype="add",this.getdeptlist(),this.getdatasourlist(),this.form={},this.dialogFormVisible=!0,e.next=13;break;case 8:return this.titletype="edit",e.next=11,this.getdeptlist();case 11:a=this.deptlist.length,this.threeid>a?(this.getdatasourlist(),this.DETSYSTEMDETAILBYID({id:this.holdId}).then((function(e){o.form=e})),this.dialogFormVisible=!0):this.$message.error("请选中要修改的系统，而不是部门");case 13:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)}),getdeptlist:function(){var e=this;return new Promise((function(t){e.GETDEPTLIST().then((function(a){e.deptlist=a,t(a)}))}))},getdatasourlist:function(){var e=this;this.GETDATASOURLIST().then((function(t){e.datasourlist=t}))},getModelAllLevels:function(){var e=this;this.GET_MODELALLLEVELS().then((function(t){e.layerList=t}))},getCopyTree:function(){var e=this;this.GET_TREE({layerCode:this.form.layerCode}).then((function(t){e.copyTreeData=t}))},handleLayerCodeChange:function(e){var t=this;if(!e)return this.copyTreeData=[],void(this.form.targetLevelCode=[]);this.getCopyTree();var a=this.layerList.find((function(e){return e.levelCode===t.form.layerCode}));this.form.tablePrefix=a?a.tablePrefix:""},copy:function(){0!==this.multipleSelection.length?this.multipleSelection.length>1?this.$message.warning("只能选一张表进行复制"):this.showCopyDialog=!0:this.$message.warning("请选择要复制的元数据")},sub:function(){var e=this;this.$refs.collectionLayer.validate((function(t){if(t){var a={sourceTableId:Number(e.rowId),targetLevelCode:e.param.layerCode,newTableName:e.param.tablePrefix+e.param.tableName,categoryId:Number(e.param.targetLevelCode[e.param.targetLevelCode.length-1])};e.COPY_TABLE_SUBMIT(a).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){e.$router.go(-1)}}})}))}}))},initData:function(){var e=this.param;this.COLLECTIONLAYERLIST(e)},handleSizeChange:function(e){this.param.page=1,this.param.rows=e,this.initData()},handleCurrentChange:function(e){this.param.page=e,this.initData()},QUERYLIST_PARAMS:function(e){this.param.page=1,e>0&&(this.param.deptId="",this.param.tableName="",this.param.tableComment=""),this.initData()},batchDelete:function(){if(0!==this.multipleSelection.length){var e=this;this.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){e.$store.commit("SHOW_LOADING",!0);var t=e.multipleSelection.map((function(e){return e.id}));e.DROP_TABLE_BY_TABLE_ID_LIST({ids:t}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){e.initData()}}})}))}}})}else this.$AudaqueToast.warn({template:"请选择数据"})},delRow:function(e){var t=this;this.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){t.$store.commit("SHOW_LOADING",!0),t.DROP_TABLE_BY_TABLE_ID({tableId:e}).then((function(e){0==e.code&&t.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){t.initData()}}})}))}}})},goLook:function(e){var t=this;this.GET_TABLE_DATA_BY_TABLE_ID({tableId:e}).then((function(e){t.tableFieldInfo=e.header,t.tableData=e.data,t.showLookDialog=!0}))},handleNodeClick:(u=Object(o.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.param.treeId=t.id,this.param.holdId=t.holdId,this.param.tableName="",this.param.deptId="",this.param.tableComment="",this.multipleSelection=[],this.initData();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)}),showTable:function(e){this.$refs.tableFields.init(e.id,e.tableIscreate)},showEditCommentDialog:function(e){this.showEditComment=!0,this.editComment=e.tableComment,this.tableId=e.id},saveComment:function(){var e=this;this.MODIFY_TABLE_COMMENT({tableId:this.tableId,comment:this.editComment}).then((function(t){e.showEditComment=!1,e.initData()})).catch((function(t){e.showEditComment=!1}))}}),mounted:function(){this.$nextTick((function(){document.querySelector(".pane-comp")&&(document.querySelector(".pane-comp").style.width="177px")}))},created:function(){var e=this;this.getTree(),this.initData(),this.GETSELECTLISTS().then((function(t){e.deptList=t.deptList}))}},m=(a("1d85"),a("2877")),h=Object(m.a)(p,(function(){var e=this,t=e._self._c;return t("audaque-resize-split-page",[t("template",{slot:"title"},[t("audaque-table-title",{attrs:{title:"归集层"}},[t("div",{staticClass:"rewrite_icon"},[t("el-button",{attrs:{type:"primary",icon:"iconxinzeng",size:"mini"},on:{click:function(t){return e.createForm()}}},[e._v("创建表")]),t("el-button",{attrs:{type:"primary",icon:"iconxinzeng2",size:"mini"},on:{click:function(t){return e.copy()}}},[e._v("复制")]),t("el-button",{attrs:{type:"primary",icon:"iconShape1",size:"mini"},on:{click:function(t){return e.batchDelete()}}},[e._v("删除")]),t("el-button",{staticClass:"color2f9aae",attrs:{type:"primary",icon:"iconshaixuan",size:"mini"},on:{click:function(t){e.isSearch=!e.isSearch}}},[e._v("筛选")])],1)])],1),t("template",{slot:"search"},[t("audaque-table-search",{directives:[{name:"show",rawName:"v-show",value:e.isSearch,expression:"isSearch"}],on:{close:function(t){e.isSearch=!1},search:function(t){return e.QUERYLIST_PARAMS(0)},reset:function(t){return e.QUERYLIST_PARAMS(1)}}},[t("audaque-table-search-item",{attrs:{title:"所属部门"}},[t("el-select",{attrs:{placeholder:"请选择所属部门",clearable:""},model:{value:e.param.deptId,callback:function(t){e.$set(e.param,"deptId",t)},expression:"param.deptId"}},e._l(e.deptList,(function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1),t("audaque-table-search-item",{attrs:{title:"表英文名"}},[t("el-input",{staticClass:"autoSize f14",attrs:{placeholder:"请输入表英文名",maxlength:"50",clearable:""},model:{value:e.param.tableName,callback:function(t){e.$set(e.param,"tableName","string"==typeof t?t.trim():t)},expression:"param.tableName"}})],1),t("audaque-table-search-item",{attrs:{title:"表中文名"}},[t("el-input",{staticClass:"autoSize f14",attrs:{placeholder:"请输入表中文名",maxlength:"50",clearable:""},model:{value:e.param.tableComment,callback:function(t){e.$set(e.param,"tableComment","string"==typeof t?t.trim():t)},expression:"param.tableComment"}})],1)],1)],1),t("template",{slot:"leftPane"},[t("el-tree",{staticClass:"tree-dashed",attrs:{data:e.datas,props:e.defaultProps,"default-expanded-keys":e.treeExpandData,"render-content":e.renderTreeItem,"node-key":"id"},on:{"node-click":e.handleNodeClick}})],1),t("template",{slot:"rightPane"},[t("el-table",{ref:"mainTableRef",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:e.collectionLayerList.rows,border:""},on:{"row-click":e.rowChange,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(t){return e.$utils._indexMethod(t,e.param.page,e.param.rows)},align:"center",width:"50"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"deptName",label:"所属部门",width:"90"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"systemName",label:"所属系统",width:"90"}}),t("el-table-column",{attrs:{"min-width":"150","show-overflow-tooltip":"",align:"center",prop:"tableName",label:"表英文名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"latest",attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.showTable(a.row)}}},[e._v(e._s(a.row.tableName)+"\n                    ")])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"tableComment","min-width":"150",label:"表中文名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"latest",attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.showEditCommentDialog(a.row)}}},[a.row.tableComment?t("span",[e._v(e._s(a.row.tableComment))]):t("span",[e._v("点击添加")])])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"tableIscreateName",width:"70",label:"表状态"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"recordTime",label:"创建时间",width:"150"}}),t("el-table-column",{attrs:{label:"表操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",{staticClass:"newoperate"},[e.permitList.collectionLayerList?t("div",{on:{click:function(t){return t.stopPropagation(),e.goLook(o.row.id)}}},[t("img",{attrs:{src:a("6aff")}}),t("span",[e._v("预览数据")])]):e._e(),e.permitList.deleteCollectionLayer?t("div",{on:{click:function(t){return t.stopPropagation(),e.delRow(o.row.id)}}},[t("img",{attrs:{src:a("5e78")}}),t("span",[e._v("删除")])]):e._e()])]}}])}),t("template",{slot:"empty"},[t("audaque-table-empty",{attrs:{tableFetchStatus:e.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(t){return e.LOGLIST(e.param)}}})],1)],2),t("tableFields",{ref:"tableFields",attrs:{title:"表字段"}}),t("el-dialog",{attrs:{visible:e.showLookDialog,title:"预览数据（仅预览前10条数据）"},on:{close:function(t){e.showLookDialog=!1}}},[t("el-table",{ref:"lookTable",staticClass:"customtable",attrs:{border:"",data:e.tableData}},[t("el-table-column",{attrs:{type:"index",label:"序号"}}),e._l(e.tableFieldInfo,(function(e,a){return t("el-table-column",{key:a,attrs:{prop:e.name,align:"center",label:e.remark||e.name}})}))],2)],1),t("el-dialog",{attrs:{title:"修改表中文名",visible:e.showEditComment,width:"25%"},on:{close:function(t){e.showEditComment=!1}}},[t("el-input",{attrs:{autocomplete:"off",maxlength:"100","show-word-limit":""},model:{value:e.editComment,callback:function(t){e.editComment=t},expression:"editComment"}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveComment}},[e._v("确 定")])],1)],1),t("adq-pagination",{attrs:{"current-page":e.param.page,total:e.collectionLayerList.total,"page-size":e.param.rows},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{visible:e.showCopyDialog,title:"复制表"},on:{close:function(t){e.showCopyDialog=!1}}},[e.multipleSelection[0]&&e.showCopyDialog?t("copyEdit",{attrs:{rowId:e.multipleSelection[0].id,row:e.multipleSelection[0]},on:{close:function(t){e.showCopyDialog=!1}}}):e._e()],1)],2)}),[],!1,null,"2cf3fbe7",null);t.default=h.exports}}]);