(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-76f46242"],{"9be4":function(t,e,a){"use strict";a("ebbe")},d6ca:function(t,e,a){"use strict";a.r(e),a("7f7f"),a("8e6e"),a("456d"),a("ac6a");var i=a("ade3"),o=a("2f62");function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var l={data:function(){return{isSearch:!1,dialogRuleVisible:!1,getHeight:!1,dialogVisible:!1,total:1,delFlag:!0,paramHis:{taskId:null,includeRole:!0,page:1,rows:10,id:""},selectList:[],paramRule:{includeRole:!0,page:1,rows:10,id:""},param:{includeRole:!0,page:1,rows:10,id:"",taskCode:"",taskName:"",taskResult:"",taskCreateTime:"",taskLatestStartTime:"",taskCat:"",taskType:"",cron:"",status:"",excuteType:"",remark:"",createUser:"",createTime:"",updateUser:"",updateTime:""},search_dataRange:""}},computed:s(s(s({},Object(o.d)("generateRule",["generateRuleList"])),Object(o.d)("apiCollectTask",["apiCollectTaskList","taskTypeOptions","excuteTypeOptions","apiInnerFunc","paramPosition","paramDataType","paramType","requestType","apiType"])),Object(o.d)("taskHis",["taskHisList"])),methods:s(s(s(s(s({},Object(o.b)("apiCollectTask",["APICOLLECTTASKLIST","DELETEAPICOLLECTTASK","BATCHMODIFYAPICOLLECTTASK","GETTASKEXCUTEOPTIONS_LIST","GETTASKTYPEOPTIONS_LIST","COPYTASK","GETAPIINNERFUNC","GETPARAMPOSITION","GETPARAMDATATYPE","GETPARAMTYPE","GETREQUESTTYPE","GETAPITYPE","MODIFYAPICOLLECTTASKSTATUS"])),Object(o.b)("generateRule",["GENERATERULELIST"])),Object(o.b)("taskHis",["TASKHISLIST","ADDTASKHIS","DELETETASKHIS"])),Object(o.b)(["_AJAX"])),{},{initData:function(){var t=this.param;this.APICOLLECTTASKLIST(t)},handleRuleSizeChange:function(t){this.paramRule.page=1,this.paramRule.rows=t,this.initRuleData()},handleRuleCurrentChange:function(t){this.paramRule.page=t,this.initRuleData()},handleSizeChange:function(t){this.param.page=1,this.param.rows=t,this.initData()},handleCurrentChange:function(t){this.param.page=t,this.initData()},initHisData:function(){var t=this.paramHis;this.TASKHISLIST(t)},handleHisSizeChange:function(t){this.paramHis.page=1,this.paramHis.rows=t,this.initHisData()},goViewHis:function(t){this.$router.push("/taskHis/taskHisEdit?filter=view&id="+t)},delHisRow:function(t){var e=this;this.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){e.$store.commit("SHOW_LOADING",!0),e.DELETETASKHIS({id:t}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){e.initHisData({taskId:this.taskId}),e.initData()}}})}))}}})},handleHisCurrentChange:function(t){this.paramHis.page=t,this.initHisData()},QUERYLIST_PARAMS:function(t){var e=this;this.param.page=1,t>0&&this.publics.resetFun(this.param,(function(){e.param.rows=10,e.search_dataRange=null})),this.initData()},getChangeType:function(t){return 10==t?"暂存":11==t?"未执行":12==t?"执行中":13==t?"执行失败":14==t?"执行完成":""},rowChange:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleSelectionChange:function(t){var e=0;this.selectList=t,this.selectList.forEach((function(t){1==t.status&&e++})),this.delFlag=!(e>0)},getTaskChangeType:function(t){return 1==t?"实时任务":2==t?"定时任务":3==t?"手动执行":""},getResultType:function(t){return 1==t?"成功":0==t?"执行中":"失败"},getExcuteChangeType:function(t){return 10==t?"暂存":11==t?"未执行":12==t?"执行中":13==t?"执行失败":14==t?"执行完成":""},getStatusChangeType:function(t){return 1==t?"上线":"下线"},subCommand:function(t){var e=this,a=this;a.BATCHMODIFYAPICOLLECTTASK({taskList:a.selectList,command:t}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"操作成功",methods:{okEvent:function(){a.initData()}}})}))},handleCommand:function(t){if(this.selectList.length<1)return this.$AudaqueToast.warn({template:"请先选择数据!"});var e=this;if("2"==t){if(0==this.delFlag)return this.$message({type:"warning",message:"存在已上线任务，无法删除！",duration:1e3});e.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){e.subCommand(t)}}})}else e.subCommand(t)},updateTask:function(t,e){var a=this;a.MODIFYAPICOLLECTTASKSTATUS({id:t,status:e}).then((function(t){0==t.code&&a.$AudaqueToast.tip({template:"修改成功",methods:{okEvent:function(){a.initData()}}})}))},copyTask:function(t){var e=this;this.COPYTASK({id:t}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"复制成功",methods:{okEvent:function(){e.initData()}}})}))},getHisList:function(t){this.paramHis.taskId=t,this.TASKHISLIST({taskId:t}),this.dialogVisible=!0},taskStart:function(t){var e=this,a=this;this.ADDTASKHIS({taskId:t}).then((function(){e.$AudaqueToast.tip({template:"任务执行中",methods:{okEvent:function(){a.initData()}}})}))},delRow:function(t){var e=this;e.$AudaqueToast.warn({template:"确认删除？",methods:{okEvent:function(){e.$store.commit("SHOW_LOADING",!0),e.DELETEAPICOLLECTTASK({id:t}).then((function(t){0==t.code&&e.$AudaqueToast.tip({template:"删除成功",methods:{okEvent:function(){e.initData()}}})}))}}})},goStep:function(t){2==t.taskType||3==t.taskType?this.$router.push("/fusionTask/stepconf?taskId="+t.id):this.$router.push("/apiCollectTask/realTimeTaskConfig?taskId="+t.id)},getRuleList:function(t){this.GENERATERULELIST({taskId:t}),this.dialogRuleVisible=!0},goOfStep:function(t,e){2==e.taskType||3==e.taskType?this.$router.push("/fusionTask/stepconf?taskId="+e.id+"&stepId="+t.stepId):this.$router.push("/apiCollectTask/realTimeTaskConfig?taskId="+e.id+"&stepId="+t.stepId)},goEdit:function(t){this.$router.push("/apiCollectTask/apiCollectTaskEdit?filter=edit&id="+t)},goShow:function(t){this.$router.push("/apiCollectTask/apiCollectTaskEdit?filter=view&id="+t)}}),created:function(){this.GETTASKEXCUTEOPTIONS_LIST(),this.GETTASKTYPEOPTIONS_LIST(),this.initData()}},r=(a("9be4"),a("2877")),c=Object(r.a)(l,(function(){var t=this,e=t._self._c;return e("audaque-table-list-page",[e("template",{slot:"title"},[e("audaque-table-title",{attrs:{title:"api采集任务"}},[t.permitList.addApiCollectTask?e("i",{staticClass:"iconfont iconxinzeng2 audaque-rect-icon",on:{click:function(e){return t.$router.push("/apiCollectTask/apiCollectTaskEdit")}}},[t._v("添加")]):t._e(),e("em",{staticClass:"iconfont iconshaixuan audaque-rect-icon",on:{click:function(e){t.isSearch=!t.isSearch}}},[t._v("筛选 ")]),e("el-dropdown",{on:{command:t.handleCommand}},[e("el-button",{staticClass:"color5a41a9",staticStyle:{"margin-left":"10px"},attrs:{size:"mini",round:""}},[t._v("\n                    批量操作"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"1"}},[t._v("上线")]),e("el-dropdown-item",{attrs:{command:"0"}},[t._v("下线")]),e("el-dropdown-item",{attrs:{command:"2"}},[t._v("删除")])],1)],1)],1)],1),e("template",{slot:"search"},[e("audaque-table-search",{directives:[{name:"show",rawName:"v-show",value:t.isSearch,expression:"isSearch"}],on:{close:function(e){t.isSearch=!1},search:function(e){return t.QUERYLIST_PARAMS(0)},reset:function(e){return t.QUERYLIST_PARAMS(1)}}},[e("audaque-table-search-item",{attrs:{title:"任务名称"}},[e("el-input",{staticClass:"autoSize f14",attrs:{placeholder:"请输入任务名称",maxlength:"50",clearable:""},model:{value:t.param.taskName,callback:function(e){t.$set(t.param,"taskName","string"==typeof e?e.trim():e)},expression:"param.taskName"}})],1),e("audaque-table-search-item",{attrs:{title:"任务类型"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.param.taskType,callback:function(e){t.$set(t.param,"taskType",e)},expression:"param.taskType"}},t._l(t.taskTypeOptions,(function(t){return e("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})),1)],1),e("audaque-table-search-item",{attrs:{title:"执行状态"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.param.excuteType,callback:function(e){t.$set(t.param,"excuteType",e)},expression:"param.excuteType"}},t._l(t.excuteTypeOptions,(function(t){return e("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})),1)],1)],1)],1),[e("el-table",{ref:"multipleTable",staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:t.apiCollectTaskList.rows,border:""},on:{"row-click":t.rowChange,"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.param.page,t.param.rows)},align:"center",width:"50"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskName",label:"任务名称"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskType",label:"任务类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.getTaskChangeType(e.row.taskType)))]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskCat",label:"采集方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(7==e.row.taskCat?"系统内置":"jar包拓展"))]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"jarName",label:"jar包名称"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"remark",label:"任务描述"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"cron",label:"调度类型"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"createTime",label:"任务创建时间"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskLatestStartTime",label:"任务最新执行时间"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"excuteType",label:"最新执行状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.getExcuteChangeType(e.row.excuteType)))]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"status",label:"任务状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.getStatusChangeType(e.row.status)))]}}])}),e("el-table-column",{attrs:{label:"操作","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"operate"},[t.permitList.updateApiCollectTask&&1!=a.row.status?e("span",[e("a",{attrs:{title:"修改任务"},on:{click:function(e){return e.stopPropagation(),t.goEdit(a.row.id)}}},[e("i",{staticClass:"el-icon-edit"})])]):t._e(),e("span",[t.permitList.updateApiCollectTask&&1==a.row.status?e("a",{attrs:{title:"查看"},on:{click:function(e){return t.goShow(a.row.id)}}},[e("i",{staticClass:"el-icon-search"})]):t._e()]),t.permitList.deleteApiCollectTask&&1!=a.row.status?e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"删除任务"},on:{click:function(e){return e.stopPropagation(),t.delRow(a.row.id)}}},[e("i",{staticClass:"el-icon-delete"})])]):t._e(),1==a.row.taskType||3==a.row.taskType?e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"重新执行"}},[e("i",{staticClass:"el-icon-refresh-right"})])]):t._e(),1==a.row.taskType&&11==a.row.excuteType?e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"执行"},on:{click:function(e){return e.stopPropagation(),t.taskStart(a.row.id)}}},[e("i",{staticClass:"el-icon-video-play"})])]):t._e(),1==a.row.taskType&&12==a.row.excuteType?e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"停止"}},[e("i",{staticClass:"el-icon-video-pause"})])]):t._e(),1==a.row.status?e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"下线"},on:{click:function(e){return e.stopPropagation(),t.updateTask(a.row.id,0)}}},[e("i",{staticClass:"el-icon-circle-close"})])]):t._e(),1!=a.row.status?e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"上线"},on:{click:function(e){return e.stopPropagation(),t.updateTask(a.row.id,1)}}},[e("i",{staticClass:"el-icon-circle-check"})])]):t._e(),e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"复制任务"},on:{click:function(e){return e.stopPropagation(),t.copyTask(a.row.id)}}},[e("i",{staticClass:"el-icon-document-copy"})])]),e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"执行日志"},on:{click:function(e){return e.stopPropagation(),t.getHisList(a.row.id)}}},[e("i",{staticClass:"el-icon-view"})])]),e("span",[t._v("\n                             \n                            "),e("a",{attrs:{title:"任务历史"},on:{click:function(e){return e.stopPropagation(),t.getHisList(a.row.id)}}},[e("i",{staticClass:"el-icon-tickets"})])])])]}}])}),e("template",{slot:"empty"},[e("audaque-table-empty",{attrs:{tableFetchStatus:t.$store.state.tableFetchStatus,"is-new":!1},on:{fetch:function(e){return t.LOGLIST(t.param)}}})],1)],2),e("adq-pagination",{attrs:{"current-page":t.param.page,total:t.apiCollectTaskList.total,"page-size":t.param.rows},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],e("el-dialog",{attrs:{title:"任务历史报告",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[[e("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:t.taskHisList.rows,border:""}},[e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.paramHis.page,t.paramHis.rows)},align:"center",width:"50"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskStartTime",label:"执行开始时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.publics.formatTime(e.row.taskStartTime,"Y-M-D h:m:s"))+"\n                    ")]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskEndTime",label:"执行结束时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.publics.formatTime(e.row.taskEndTime,"Y-M-D h:m:s"))+"\n                    ")]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"taskResult",label:"执行状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{staticStyle:{color:"#7099f9"}},[t._v(t._s(null!=a.row.taskResult?0==a.row.taskResult?"执行中":1==a.row.taskResult?"成功":"失败":null)+"\n                        ")])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"operate"},[e("span",[e("a",{attrs:{title:"查看报告"},on:{click:function(e){return t.goViewHis(a.row.id)}}},[t._v("查看报告 ")])]),t._v("\n                             \n                            "),e("span",[e("a",{attrs:{title:"删除"},on:{click:function(e){return t.delHisRow(a.row.id)}}},[t._v("删除 ")])]),e("span",[e("a",{attrs:{title:"查看日志"},on:{click:function(e){return t.goViewHis(a.row.id)}}},[t._v("查看日志 ")])])])]}}])})],1),e("adq-pagination",{attrs:{"current-page":t.paramHis.page,total:t.taskHisList.total,"page-size":t.paramHis.rows},on:{"size-change":t.handleHisSizeChange,"current-change":t.handleHisCurrentChange}})],e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1)],2),e("el-dialog",{attrs:{title:"任务引用规则列表",visible:t.dialogRuleVisible,width:"50%"},on:{"update:visible":function(e){t.dialogRuleVisible=e}}},[[e("el-table",{staticClass:"el-table-common__list",attrs:{"tooltip-effect":"light","highlight-current-row":"",stripe:"",data:t.generateRuleList.rows,border:""}},[e("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"index",label:"序号",index:function(e){return t.$utils._indexMethod(e,t.paramRule.page,t.paramRule.rows)},align:"center",width:"50"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleName",label:"规则名称"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleType",label:"规则类型"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleCategory",label:"规则分类"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"expression",label:"规则表达式"}}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"ruleDesc",label:"规则描述"}})],1),e("adq-pagination",{attrs:{"current-page":t.paramRule.page,total:t.generateRuleList.total,"page-size":t.paramRule.rows},on:{"size-change":t.handleRuleSizeChange,"current-change":t.handleRuleCurrentChange}})],e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogRuleVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogRuleVisible=!1}}},[t._v("确 定")])],1)],2)],2)}),[],!1,null,"20ab7170",null);e.default=c.exports},ebbe:function(t,e,a){var i=a("eeab");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,a("499e").default)("1d22df72",i,!0,{sourceMap:!1,shadowMode:!1})},eeab:function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,".search-date[data-v-20ab7170]{width:100%!important}.el-dropdown-link[data-v-20ab7170]{cursor:pointer;color:#717783}.el-icon-arrow-down[data-v-20ab7170]{font-size:12px}.demonstration[data-v-20ab7170]{display:block;color:#8492a6;font-size:14px;margin-bottom:20px}",""])}}]);